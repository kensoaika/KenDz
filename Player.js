typeof navigator==="object"&&(function(){'use strict';var commonjsGlobal=typeof window!=='undefined'?window:typeof global!=='undefined'?global:typeof self!=='undefined'?self:{};function createCommonjsModule(fn,module){return module={exports:{}},fn(module,module.exports),module.exports}
function _typeof(obj){if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){_typeof=function(obj){return typeof obj}}else{_typeof=function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj}}
return _typeof(obj)}
function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}
function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;if("value" in descriptor)descriptor.writable=!0;Object.defineProperty(target,descriptor.key,descriptor)}}
function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}
function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0})}else{obj[key]=value}
return obj}
function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_nonIterableRest()}
function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_nonIterableSpread()}
function _arrayWithoutHoles(arr){if(Array.isArray(arr)){for(var i=0,arr2=new Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}}
function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}
function _iterableToArray(iter){if(Symbol.iterator in Object(iter)||Object.prototype.toString.call(iter)==="[object Arguments]")return Array.from(iter)}
function _iterableToArrayLimit(arr,i){var _arr=[];var _n=!0;var _d=!1;var _e=undefined;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done);_n=!0){_arr.push(_s.value);if(i&&_arr.length===i)break}}catch(err){_d=!0;_e=err}finally{try{if(!_n&&_i["return"]!=null)_i["return"]()}finally{if(_d)throw _e}}
return _arr}
function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}
function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}
var stringify_1=createCommonjsModule(function(module,exports){exports=module.exports=stringify;exports.getSerialize=serializer;function indexOf(haystack,needle){for(var i=0;i<haystack.length;++i){if(haystack[i]===needle)return i}
return-1}
function stringify(obj,replacer,spaces,cycleReplacer){return JSON.stringify(obj,serializer(replacer,cycleReplacer),spaces)}
function stringifyError(value){var err={stack:value.stack,message:value.message,name:value.name};for(var i in value){if(Object.prototype.hasOwnProperty.call(value,i)){err[i]=value[i]}}
return err}
function serializer(replacer,cycleReplacer){var stack=[];var keys=[];if(cycleReplacer==null){cycleReplacer=function cycleReplacer(key,value){if(stack[0]===value){return'[Circular ~]'}
return'[Circular ~.'+keys.slice(0,indexOf(stack,value)).join('.')+']'}}
return function(key,value){if(stack.length>0){var thisPos=indexOf(stack,this);~thisPos?stack.splice(thisPos+1):stack.push(this);~thisPos?keys.splice(thisPos,Infinity,key):keys.push(key);if(~indexOf(stack,value)){value=cycleReplacer.call(this,key,value)}}else{stack.push(value)}
return replacer==null?value instanceof Error?stringifyError(value):value:replacer.call(this,key,value)}}});var stringify_2=stringify_1.getSerialize;var _window=typeof window!=='undefined'?window:typeof commonjsGlobal!=='undefined'?commonjsGlobal:typeof self!=='undefined'?self:{};function isObject(what){return _typeof(what)==='object'&&what!==null}
function isError(value){switch(Object.prototype.toString.call(value)){case '[object Error]':return!0;case '[object Exception]':return!0;case '[object DOMException]':return!0;default:return value instanceof Error}}
function isErrorEvent(value){return Object.prototype.toString.call(value)==='[object ErrorEvent]'}
function isDOMError(value){return Object.prototype.toString.call(value)==='[object DOMError]'}
function isDOMException(value){return Object.prototype.toString.call(value)==='[object DOMException]'}
function isUndefined(what){return what===void 0}
function isFunction(what){return typeof what==='function'}
function isPlainObject(what){return Object.prototype.toString.call(what)==='[object Object]'}
function isString(what){return Object.prototype.toString.call(what)==='[object String]'}
function isArray(what){return Object.prototype.toString.call(what)==='[object Array]'}
function isEmptyObject(what){if(!isPlainObject(what))return!1;for(var _ in what){if(what.hasOwnProperty(_)){return!1}}
return!0}
function supportsErrorEvent(){try{new ErrorEvent('');return!0}catch(e){return!1}}
function supportsDOMError(){try{new DOMError('');return!0}catch(e){return!1}}
function supportsDOMException(){try{new DOMException('');return!0}catch(e){return!1}}
function supportsFetch(){if(!('fetch' in _window))return!1;try{new Headers();new Request('');new Response();return!0}catch(e){return!1}}
function supportsReferrerPolicy(){if(!supportsFetch())return!1;try{new Request('pickleRick',{referrerPolicy:'origin'});return!0}catch(e){return!1}}
function supportsPromiseRejectionEvent(){return typeof PromiseRejectionEvent==='function'}
function wrappedCallback(callback){function dataCallback(data,original){var normalizedData=callback(data)||data;if(original){return original(normalizedData)||normalizedData}
return normalizedData}
return dataCallback}
function each(obj,callback){var i,j;if(isUndefined(obj.length)){for(i in obj){if(hasKey(obj,i)){callback.call(null,i,obj[i])}}}else{j=obj.length;if(j){for(i=0;i<j;i++){callback.call(null,i,obj[i])}}}}
function objectMerge(obj1,obj2){if(!obj2){return obj1}
each(obj2,function(key,value){obj1[key]=value});return obj1}
function objectFrozen(obj){if(!Object.isFrozen){return!1}
return Object.isFrozen(obj)}
function truncate(str,max){if(typeof max!=='number'){throw new Error('2nd argument to `truncate` function should be a number')}
if(typeof str!=='string'||max===0){return str}
return str.length<=max?str:str.substr(0,max)+"\u2026"}
function hasKey(object,key){return Object.prototype.hasOwnProperty.call(object,key)}
function joinRegExp(patterns){var sources=[],i=0,len=patterns.length,pattern;for(;i<len;i++){pattern=patterns[i];if(isString(pattern)){sources.push(pattern.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,'\\$1'))}else if(pattern&&pattern.source){sources.push(pattern.source)}}
return new RegExp(sources.join('|'),'i')}
function urlencode(o){var pairs=[];each(o,function(key,value){pairs.push(encodeURIComponent(key)+'='+encodeURIComponent(value))});return pairs.join('&')}
function parseUrl(url){if(typeof url!=='string')return{};var match=url.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);var query=match[6]||'';var fragment=match[8]||'';return{protocol:match[2],host:match[4],path:match[5],relative:match[5]+query+fragment}}
function uuid4(){var crypto=_window.crypto||_window.msCrypto;if(!isUndefined(crypto)&&crypto.getRandomValues){var arr=new Uint16Array(8);crypto.getRandomValues(arr);arr[3]=arr[3]&0xfff|0x4000;arr[4]=arr[4]&0x3fff|0x8000;var pad=function pad(num){var v=num.toString(16);while(v.length<4){v='0'+v}
return v};return pad(arr[0])+pad(arr[1])+pad(arr[2])+pad(arr[3])+pad(arr[4])+pad(arr[5])+pad(arr[6])+pad(arr[7])}else{return'xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx'.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c==='x'?r:r&0x3|0x8;return v.toString(16)})}}
function htmlTreeAsString(elem){var MAX_TRAVERSE_HEIGHT=5,MAX_OUTPUT_LEN=80,out=[],height=0,len=0,separator=' > ',sepLength=separator.length,nextStr;while(elem&&height++<MAX_TRAVERSE_HEIGHT){nextStr=htmlElementAsString(elem);if(nextStr==='html'||height>1&&len+out.length*sepLength+nextStr.length>=MAX_OUTPUT_LEN){break}
out.push(nextStr);len+=nextStr.length;elem=elem.parentNode}
return out.reverse().join(separator)}
function htmlElementAsString(elem){var out=[],className,classes,key,attr,i;if(!elem||!elem.tagName){return''}
out.push(elem.tagName.toLowerCase());if(elem.id){out.push('#'+elem.id)}
className=elem.className;if(className&&isString(className)){classes=className.split(/\s+/);for(i=0;i<classes.length;i++){out.push('.'+classes[i])}}
var attrWhitelist=['type','name','title','alt'];for(i=0;i<attrWhitelist.length;i++){key=attrWhitelist[i];attr=elem.getAttribute(key);if(attr){out.push('['+key+'="'+attr+'"]')}}
return out.join('')}
function isOnlyOneTruthy(a,b){return!!(!!a^!!b)}
function isBothUndefined(a,b){return isUndefined(a)&&isUndefined(b)}
function isSameException(ex1,ex2){if(isOnlyOneTruthy(ex1,ex2))return!1;ex1=ex1.values[0];ex2=ex2.values[0];if(ex1.type!==ex2.type||ex1.value!==ex2.value)return!1;if(isBothUndefined(ex1.stacktrace,ex2.stacktrace))return!1;return isSameStacktrace(ex1.stacktrace,ex2.stacktrace)}
function isSameStacktrace(stack1,stack2){if(isOnlyOneTruthy(stack1,stack2))return!1;var frames1=stack1.frames;var frames2=stack2.frames;if(frames1===undefined||frames2===undefined)return!1;if(frames1.length!==frames2.length)return!1;var a,b;for(var i=0;i<frames1.length;i++){a=frames1[i];b=frames2[i];if(a.filename!==b.filename||a.lineno!==b.lineno||a.colno!==b.colno||a['function']!==b['function'])return!1}
return!0}
function fill(obj,name,replacement,track){if(obj==null)return;var orig=obj[name];obj[name]=replacement(orig);obj[name].__raven__=!0;obj[name].__orig__=orig;if(track){track.push([obj,name,orig])}}
function safeJoin(input,delimiter){if(!isArray(input))return'';var output=[];for(var i=0;i<input.length;i++){try{output.push(String(input[i]))}catch(e){output.push('[value cannot be serialized]')}}
return output.join(delimiter)}
var MAX_SERIALIZE_EXCEPTION_DEPTH=3;var MAX_SERIALIZE_EXCEPTION_SIZE=50*1024;var MAX_SERIALIZE_KEYS_LENGTH=40;function utf8Length(value){return~-encodeURI(value).split(/%..|./).length}
function jsonSize(value){return utf8Length(JSON.stringify(value))}
function serializeValue(value){if(typeof value==='string'){var maxLength=40;return truncate(value,maxLength)}else if(typeof value==='number'||typeof value==='boolean'||typeof value==='undefined'){return value}
var type=Object.prototype.toString.call(value);if(type==='[object Object]')return'[Object]';if(type==='[object Array]')return'[Array]';if(type==='[object Function]')return value.name?'[Function: '+value.name+']':'[Function]';return value}
function serializeObject(value,depth){if(depth===0)return serializeValue(value);if(isPlainObject(value)){return Object.keys(value).reduce(function(acc,key){acc[key]=serializeObject(value[key],depth-1);return acc},{})}else if(Array.isArray(value)){return value.map(function(val){return serializeObject(val,depth-1)})}
return serializeValue(value)}
function serializeException(ex,depth,maxSize){if(!isPlainObject(ex))return ex;depth=typeof depth!=='number'?MAX_SERIALIZE_EXCEPTION_DEPTH:depth;maxSize=typeof depth!=='number'?MAX_SERIALIZE_EXCEPTION_SIZE:maxSize;var serialized=serializeObject(ex,depth);if(jsonSize(stringify_1(serialized))>maxSize){return serializeException(ex,depth-1)}
return serialized}
function serializeKeysForMessage(keys,maxLength){if(typeof keys==='number'||typeof keys==='string')return keys.toString();if(!Array.isArray(keys))return'';keys=keys.filter(function(key){return typeof key==='string'});if(keys.length===0)return'[object has no keys]';maxLength=typeof maxLength!=='number'?MAX_SERIALIZE_KEYS_LENGTH:maxLength;if(keys[0].length>=maxLength)return keys[0];for(var usedKeys=keys.length;usedKeys>0;usedKeys--){var serialized=keys.slice(0,usedKeys).join(', ');if(serialized.length>maxLength)continue;if(usedKeys===keys.length)return serialized;return serialized+"\u2026"}
return''}
function sanitize(input,sanitizeKeys){if(!isArray(sanitizeKeys)||isArray(sanitizeKeys)&&sanitizeKeys.length===0)return input;var sanitizeRegExp=joinRegExp(sanitizeKeys);var sanitizeMask='********';var safeInput;try{safeInput=JSON.parse(stringify_1(input))}catch(o_O){return input}
function sanitizeWorker(workerInput){if(isArray(workerInput)){return workerInput.map(function(val){return sanitizeWorker(val)})}
if(isPlainObject(workerInput)){return Object.keys(workerInput).reduce(function(acc,k){if(sanitizeRegExp.test(k)){acc[k]=sanitizeMask}else{acc[k]=sanitizeWorker(workerInput[k])}
return acc},{})}
return workerInput}
return sanitizeWorker(safeInput)}
var utils={isObject:isObject,isError:isError,isErrorEvent:isErrorEvent,isDOMError:isDOMError,isDOMException:isDOMException,isUndefined:isUndefined,isFunction:isFunction,isPlainObject:isPlainObject,isString:isString,isArray:isArray,isEmptyObject:isEmptyObject,supportsErrorEvent:supportsErrorEvent,supportsDOMError:supportsDOMError,supportsDOMException:supportsDOMException,supportsFetch:supportsFetch,supportsReferrerPolicy:supportsReferrerPolicy,supportsPromiseRejectionEvent:supportsPromiseRejectionEvent,wrappedCallback:wrappedCallback,each:each,objectMerge:objectMerge,truncate:truncate,objectFrozen:objectFrozen,hasKey:hasKey,joinRegExp:joinRegExp,urlencode:urlencode,uuid4:uuid4,htmlTreeAsString:htmlTreeAsString,htmlElementAsString:htmlElementAsString,isSameException:isSameException,isSameStacktrace:isSameStacktrace,parseUrl:parseUrl,fill:fill,safeJoin:safeJoin,serializeException:serializeException,serializeKeysForMessage:serializeKeysForMessage,sanitize:sanitize};var TraceKit={collectWindowErrors:!0,debug:!1};var _window$1=typeof window!=='undefined'?window:typeof commonjsGlobal!=='undefined'?commonjsGlobal:typeof self!=='undefined'?self:{};var _slice=[].slice;var UNKNOWN_FUNCTION='?';var ERROR_TYPES_RE=/^(?:[Uu]ncaught (?:exception: )?)?(?:((?:Eval|Internal|Range|Reference|Syntax|Type|URI|)Error): )?(.*)$/;function getLocationHref(){if(typeof document==='undefined'||document.location==null)return'';return document.location.href}
function getLocationOrigin(){if(typeof document==='undefined'||document.location==null)return'';if(!document.location.origin){return document.location.protocol+'//'+document.location.hostname+(document.location.port?':'+document.location.port:'')}
return document.location.origin}
TraceKit.report=function reportModuleWrapper(){var handlers=[],lastArgs=null,lastException=null,lastExceptionStack=null;function subscribe(handler){installGlobalHandler();handlers.push(handler)}
function unsubscribe(handler){for(var i=handlers.length-1;i>=0;--i){if(handlers[i]===handler){handlers.splice(i,1)}}}
function unsubscribeAll(){uninstallGlobalHandler();handlers=[]}
function notifyHandlers(stack,isWindowError){var exception=null;if(isWindowError&&!TraceKit.collectWindowErrors){return}
for(var i in handlers){if(handlers.hasOwnProperty(i)){try{handlers[i].apply(null,[stack].concat(_slice.call(arguments,2)))}catch(inner){exception=inner}}}
if(exception){throw exception}}
var _oldOnerrorHandler,_onErrorHandlerInstalled;function traceKitWindowOnError(msg,url,lineNo,colNo,ex){var stack=null;var exception=utils.isErrorEvent(ex)?ex.error:ex;var message=utils.isErrorEvent(msg)?msg.message:msg;if(lastExceptionStack){TraceKit.computeStackTrace.augmentStackTraceWithInitialElement(lastExceptionStack,url,lineNo,message);processLastException()}else if(exception&&utils.isError(exception)){stack=TraceKit.computeStackTrace(exception);notifyHandlers(stack,!0)}else{var location={url:url,line:lineNo,column:colNo};var name=undefined;var groups;if({}.toString.call(message)==='[object String]'){var groups=message.match(ERROR_TYPES_RE);if(groups){name=groups[1];message=groups[2]}}
location.func=UNKNOWN_FUNCTION;stack={name:name,message:message,url:getLocationHref(),stack:[location]};notifyHandlers(stack,!0)}
if(_oldOnerrorHandler){return _oldOnerrorHandler.apply(this,arguments)}
return!1}
function installGlobalHandler(){if(_onErrorHandlerInstalled){return}
_oldOnerrorHandler=_window$1.onerror;_window$1.onerror=traceKitWindowOnError;_onErrorHandlerInstalled=!0}
function uninstallGlobalHandler(){if(!_onErrorHandlerInstalled){return}
_window$1.onerror=_oldOnerrorHandler;_onErrorHandlerInstalled=!1;_oldOnerrorHandler=undefined}
function processLastException(){var _lastExceptionStack=lastExceptionStack,_lastArgs=lastArgs;lastArgs=null;lastExceptionStack=null;lastException=null;notifyHandlers.apply(null,[_lastExceptionStack,!1].concat(_lastArgs))}
function report(ex,rethrow){var args=_slice.call(arguments,1);if(lastExceptionStack){if(lastException===ex){return}else{processLastException()}}
var stack=TraceKit.computeStackTrace(ex);lastExceptionStack=stack;lastException=ex;lastArgs=args;setTimeout(function(){if(lastException===ex){processLastException()}},stack.incomplete?2000:0);if(rethrow!==!1){throw ex}}
report.subscribe=subscribe;report.unsubscribe=unsubscribe;report.uninstall=unsubscribeAll;return report}();TraceKit.computeStackTrace=function computeStackTraceWrapper(){function computeStackTraceFromStackProp(ex){if(typeof ex.stack==='undefined'||!ex.stack)return;var chrome=/^\s*at (?:(.*?) ?\()?((?:file|https?|blob|chrome-extension|native|eval|webpack|<anonymous>|[a-z]:|\/).*?)(?::(\d+))?(?::(\d+))?\)?\s*$/i;var winjs=/^\s*at (?:((?:\[object object\])?.+) )?\(?((?:file|ms-appx(?:-web)|https?|webpack|blob):.*?):(\d+)(?::(\d+))?\)?\s*$/i;var gecko=/^\s*(.*?)(?:\((.*?)\))?(?:^|@)((?:file|https?|blob|chrome|webpack|resource|moz-extension).*?:\/.*?|\[native code\]|[^@]*bundle)(?::(\d+))?(?::(\d+))?\s*$/i;var geckoEval=/(\S+) line (\d+)(?: > eval line \d+)* > eval/i;var chromeEval=/\((\S*)(?::(\d+))(?::(\d+))\)/;var lines=ex.stack.split('\n');var stack=[];var submatch;var parts;var element;var reference=/^(.*) is undefined$/.exec(ex.message);for(var i=0,j=lines.length;i<j;++i){if(parts=chrome.exec(lines[i])){var isNative=parts[2]&&parts[2].indexOf('native')===0;var isEval=parts[2]&&parts[2].indexOf('eval')===0;if(isEval&&(submatch=chromeEval.exec(parts[2]))){parts[2]=submatch[1];parts[3]=submatch[2];parts[4]=submatch[3]}
element={url:!isNative?parts[2]:null,func:parts[1]||UNKNOWN_FUNCTION,args:isNative?[parts[2]]:[],line:parts[3]?+parts[3]:null,column:parts[4]?+parts[4]:null}}else if(parts=winjs.exec(lines[i])){element={url:parts[2],func:parts[1]||UNKNOWN_FUNCTION,args:[],line:+parts[3],column:parts[4]?+parts[4]:null}}else if(parts=gecko.exec(lines[i])){var isEval=parts[3]&&parts[3].indexOf(' > eval')>-1;if(isEval&&(submatch=geckoEval.exec(parts[3]))){parts[3]=submatch[1];parts[4]=submatch[2];parts[5]=null}else if(i===0&&!parts[5]&&typeof ex.columnNumber!=='undefined'){stack[0].column=ex.columnNumber+1}
element={url:parts[3],func:parts[1]||UNKNOWN_FUNCTION,args:parts[2]?parts[2].split(','):[],line:parts[4]?+parts[4]:null,column:parts[5]?+parts[5]:null}}else{continue}
if(!element.func&&element.line){element.func=UNKNOWN_FUNCTION}
if(element.url&&element.url.substr(0,5)==='blob:'){var xhr=new XMLHttpRequest();xhr.open('GET',element.url,!1);xhr.send(null);if(xhr.status===200){var source=xhr.responseText||'';source=source.slice(-300);var sourceMaps=source.match(/\/\/# sourceMappingURL=(.*)$/);if(sourceMaps){var sourceMapAddress=sourceMaps[1];if(sourceMapAddress.charAt(0)==='~'){sourceMapAddress=getLocationOrigin()+sourceMapAddress.slice(1)}
element.url=sourceMapAddress.slice(0,-4)}}}
stack.push(element)}
if(!stack.length){return null}
return{name:ex.name,message:ex.message,url:getLocationHref(),stack:stack}}
function augmentStackTraceWithInitialElement(stackInfo,url,lineNo,message){var initial={url:url,line:lineNo};if(initial.url&&initial.line){stackInfo.incomplete=!1;if(!initial.func){initial.func=UNKNOWN_FUNCTION}
if(stackInfo.stack.length>0){if(stackInfo.stack[0].url===initial.url){if(stackInfo.stack[0].line===initial.line){return!1}else if(!stackInfo.stack[0].line&&stackInfo.stack[0].func===initial.func){stackInfo.stack[0].line=initial.line;return!1}}}
stackInfo.stack.unshift(initial);stackInfo.partial=!0;return!0}else{stackInfo.incomplete=!0}
return!1}
function computeStackTraceByWalkingCallerChain(ex,depth){var functionName=/function\s+([_$a-zA-Z\xA0-\uFFFF][_$a-zA-Z0-9\xA0-\uFFFF]*)?\s*\(/i,stack=[],funcs={},recursion=!1,parts,item;for(var curr=computeStackTraceByWalkingCallerChain.caller;curr&&!recursion;curr=curr.caller){if(curr===computeStackTrace||curr===TraceKit.report){continue}
item={url:null,func:UNKNOWN_FUNCTION,line:null,column:null};if(curr.name){item.func=curr.name}else if(parts=functionName.exec(curr.toString())){item.func=parts[1]}
if(typeof item.func==='undefined'){try{item.func=parts.input.substring(0,parts.input.indexOf('{'))}catch(e){}}
if(funcs[''+curr]){recursion=!0}else{funcs[''+curr]=!0}
stack.push(item)}
if(depth){stack.splice(0,depth)}
var result={name:ex.name,message:ex.message,url:getLocationHref(),stack:stack};augmentStackTraceWithInitialElement(result,ex.sourceURL||ex.fileName,ex.line||ex.lineNumber,ex.message||ex.description);return result}
function computeStackTrace(ex,depth){var stack=null;depth=depth==null?0:+depth;try{stack=computeStackTraceFromStackProp(ex);if(stack){return stack}}catch(e){if(TraceKit.debug){throw e}}
try{stack=computeStackTraceByWalkingCallerChain(ex,depth+1);if(stack){return stack}}catch(e){if(TraceKit.debug){throw e}}
return{name:ex.name,message:ex.message,url:getLocationHref()}}
computeStackTrace.augmentStackTraceWithInitialElement=augmentStackTraceWithInitialElement;computeStackTrace.computeStackTraceFromStackProp=computeStackTraceFromStackProp;return computeStackTrace}();var tracekit=TraceKit;function safeAdd(x,y){var lsw=(x&0xffff)+(y&0xffff);var msw=(x>>16)+(y>>16)+(lsw>>16);return msw<<16|lsw&0xffff}
function bitRotateLeft(num,cnt){return num<<cnt|num>>>32-cnt}
function md5cmn(q,a,b,x,s,t){return safeAdd(bitRotateLeft(safeAdd(safeAdd(a,q),safeAdd(x,t)),s),b)}
function md5ff(a,b,c,d,x,s,t){return md5cmn(b&c|~b&d,a,b,x,s,t)}
function md5gg(a,b,c,d,x,s,t){return md5cmn(b&d|c&~d,a,b,x,s,t)}
function md5hh(a,b,c,d,x,s,t){return md5cmn(b^c^d,a,b,x,s,t)}
function md5ii(a,b,c,d,x,s,t){return md5cmn(c^(b|~d),a,b,x,s,t)}
function binlMD5(x,len){x[len>>5]|=0x80<<len%32;x[(len+64>>>9<<4)+14]=len;var i;var olda;var oldb;var oldc;var oldd;var a=1732584193;var b=-271733879;var c=-1732584194;var d=271733878;for(i=0;i<x.length;i+=16){olda=a;oldb=b;oldc=c;oldd=d;a=md5ff(a,b,c,d,x[i],7,-680876936);d=md5ff(d,a,b,c,x[i+1],12,-389564586);c=md5ff(c,d,a,b,x[i+2],17,606105819);b=md5ff(b,c,d,a,x[i+3],22,-1044525330);a=md5ff(a,b,c,d,x[i+4],7,-176418897);d=md5ff(d,a,b,c,x[i+5],12,1200080426);c=md5ff(c,d,a,b,x[i+6],17,-1473231341);b=md5ff(b,c,d,a,x[i+7],22,-45705983);a=md5ff(a,b,c,d,x[i+8],7,1770035416);d=md5ff(d,a,b,c,x[i+9],12,-1958414417);c=md5ff(c,d,a,b,x[i+10],17,-42063);b=md5ff(b,c,d,a,x[i+11],22,-1990404162);a=md5ff(a,b,c,d,x[i+12],7,1804603682);d=md5ff(d,a,b,c,x[i+13],12,-40341101);c=md5ff(c,d,a,b,x[i+14],17,-1502002290);b=md5ff(b,c,d,a,x[i+15],22,1236535329);a=md5gg(a,b,c,d,x[i+1],5,-165796510);d=md5gg(d,a,b,c,x[i+6],9,-1069501632);c=md5gg(c,d,a,b,x[i+11],14,643717713);b=md5gg(b,c,d,a,x[i],20,-373897302);a=md5gg(a,b,c,d,x[i+5],5,-701558691);d=md5gg(d,a,b,c,x[i+10],9,38016083);c=md5gg(c,d,a,b,x[i+15],14,-660478335);b=md5gg(b,c,d,a,x[i+4],20,-405537848);a=md5gg(a,b,c,d,x[i+9],5,568446438);d=md5gg(d,a,b,c,x[i+14],9,-1019803690);c=md5gg(c,d,a,b,x[i+3],14,-187363961);b=md5gg(b,c,d,a,x[i+8],20,1163531501);a=md5gg(a,b,c,d,x[i+13],5,-1444681467);d=md5gg(d,a,b,c,x[i+2],9,-51403784);c=md5gg(c,d,a,b,x[i+7],14,1735328473);b=md5gg(b,c,d,a,x[i+12],20,-1926607734);a=md5hh(a,b,c,d,x[i+5],4,-378558);d=md5hh(d,a,b,c,x[i+8],11,-2022574463);c=md5hh(c,d,a,b,x[i+11],16,1839030562);b=md5hh(b,c,d,a,x[i+14],23,-35309556);a=md5hh(a,b,c,d,x[i+1],4,-1530992060);d=md5hh(d,a,b,c,x[i+4],11,1272893353);c=md5hh(c,d,a,b,x[i+7],16,-155497632);b=md5hh(b,c,d,a,x[i+10],23,-1094730640);a=md5hh(a,b,c,d,x[i+13],4,681279174);d=md5hh(d,a,b,c,x[i],11,-358537222);c=md5hh(c,d,a,b,x[i+3],16,-722521979);b=md5hh(b,c,d,a,x[i+6],23,76029189);a=md5hh(a,b,c,d,x[i+9],4,-640364487);d=md5hh(d,a,b,c,x[i+12],11,-421815835);c=md5hh(c,d,a,b,x[i+15],16,530742520);b=md5hh(b,c,d,a,x[i+2],23,-995338651);a=md5ii(a,b,c,d,x[i],6,-198630844);d=md5ii(d,a,b,c,x[i+7],10,1126891415);c=md5ii(c,d,a,b,x[i+14],15,-1416354905);b=md5ii(b,c,d,a,x[i+5],21,-57434055);a=md5ii(a,b,c,d,x[i+12],6,1700485571);d=md5ii(d,a,b,c,x[i+3],10,-1894986606);c=md5ii(c,d,a,b,x[i+10],15,-1051523);b=md5ii(b,c,d,a,x[i+1],21,-2054922799);a=md5ii(a,b,c,d,x[i+8],6,1873313359);d=md5ii(d,a,b,c,x[i+15],10,-30611744);c=md5ii(c,d,a,b,x[i+6],15,-1560198380);b=md5ii(b,c,d,a,x[i+13],21,1309151649);a=md5ii(a,b,c,d,x[i+4],6,-145523070);d=md5ii(d,a,b,c,x[i+11],10,-1120210379);c=md5ii(c,d,a,b,x[i+2],15,718787259);b=md5ii(b,c,d,a,x[i+9],21,-343485551);a=safeAdd(a,olda);b=safeAdd(b,oldb);c=safeAdd(c,oldc);d=safeAdd(d,oldd)}
return[a,b,c,d]}
function binl2rstr(input){var i;var output='';var length32=input.length*32;for(i=0;i<length32;i+=8){output+=String.fromCharCode(input[i>>5]>>>i%32&0xff)}
return output}
function rstr2binl(input){var i;var output=[];output[(input.length>>2)-1]=undefined;for(i=0;i<output.length;i+=1){output[i]=0}
var length8=input.length*8;for(i=0;i<length8;i+=8){output[i>>5]|=(input.charCodeAt(i/8)&0xff)<<i%32}
return output}
function rstrMD5(s){return binl2rstr(binlMD5(rstr2binl(s),s.length*8))}
function rstrHMACMD5(key,data){var i;var bkey=rstr2binl(key);var ipad=[];var opad=[];var hash;ipad[15]=opad[15]=undefined;if(bkey.length>16){bkey=binlMD5(bkey,key.length*8)}
for(i=0;i<16;i+=1){ipad[i]=bkey[i]^0x36363636;opad[i]=bkey[i]^0x5c5c5c5c}
hash=binlMD5(ipad.concat(rstr2binl(data)),512+data.length*8);return binl2rstr(binlMD5(opad.concat(hash),512+128))}
function rstr2hex(input){var hexTab='0123456789abcdef';var output='';var x;var i;for(i=0;i<input.length;i+=1){x=input.charCodeAt(i);output+=hexTab.charAt(x>>>4&0x0f)+hexTab.charAt(x&0x0f)}
return output}
function str2rstrUTF8(input){return unescape(encodeURIComponent(input))}
function rawMD5(s){return rstrMD5(str2rstrUTF8(s))}
function hexMD5(s){return rstr2hex(rawMD5(s))}
function rawHMACMD5(k,d){return rstrHMACMD5(str2rstrUTF8(k),str2rstrUTF8(d))}
function hexHMACMD5(k,d){return rstr2hex(rawHMACMD5(k,d))}
function md5(string,key,raw){if(!key){if(!raw){return hexMD5(string)}
return rawMD5(string)}
if(!raw){return hexHMACMD5(key,string)}
return rawHMACMD5(key,string)}
var md5_1=md5;function RavenConfigError(message){this.name='RavenConfigError';this.message=message}
RavenConfigError.prototype=new Error();RavenConfigError.prototype.constructor=RavenConfigError;var configError=RavenConfigError;var wrapMethod=function wrapMethod(console,level,callback){var originalConsoleLevel=console[level];var originalConsole=console;if(!(level in console)){return}
var sentryLevel=level==='warn'?'warning':level;console[level]=function(){var args=[].slice.call(arguments);var msg=utils.safeJoin(args,' ');var data={level:sentryLevel,logger:'console',extra:{arguments:args}};if(level==='assert'){if(args[0]===!1){msg='Assertion failed: '+(utils.safeJoin(args.slice(1),' ')||'console.assert');data.extra.arguments=args.slice(1);callback&&callback(msg,data)}}else{callback&&callback(msg,data)}
if(originalConsoleLevel){Function.prototype.apply.call(originalConsoleLevel,originalConsole,args)}}};var console$1={wrapMethod:wrapMethod};var isErrorEvent$1=utils.isErrorEvent;var isDOMError$1=utils.isDOMError;var isDOMException$1=utils.isDOMException;var isError$1=utils.isError;var isObject$1=utils.isObject;var isPlainObject$1=utils.isPlainObject;var isUndefined$1=utils.isUndefined;var isFunction$1=utils.isFunction;var isString$1=utils.isString;var isArray$1=utils.isArray;var isEmptyObject$1=utils.isEmptyObject;var each$1=utils.each;var objectMerge$1=utils.objectMerge;var truncate$1=utils.truncate;var objectFrozen$1=utils.objectFrozen;var hasKey$1=utils.hasKey;var joinRegExp$1=utils.joinRegExp;var urlencode$1=utils.urlencode;var uuid4$1=utils.uuid4;var htmlTreeAsString$1=utils.htmlTreeAsString;var isSameException$1=utils.isSameException;var isSameStacktrace$1=utils.isSameStacktrace;var parseUrl$1=utils.parseUrl;var fill$1=utils.fill;var supportsFetch$1=utils.supportsFetch;var supportsReferrerPolicy$1=utils.supportsReferrerPolicy;var serializeKeysForMessage$1=utils.serializeKeysForMessage;var serializeException$1=utils.serializeException;var sanitize$1=utils.sanitize;var wrapConsoleMethod=console$1.wrapMethod;var dsnKeys='source protocol user pass host port path'.split(' '),dsnPattern=/^(?:(\w+):)?\/\/(?:(\w+)(:\w+)?@)?([\w\.-]+)(?::(\d+))?(\/.*)/;function now(){return+new Date()}
var _window$2=typeof window!=='undefined'?window:typeof commonjsGlobal!=='undefined'?commonjsGlobal:typeof self!=='undefined'?self:{};var _document=_window$2.document;var _navigator=_window$2.navigator;function keepOriginalCallback(original,callback){return isFunction$1(callback)?function(data){return callback(data,original)}:callback}
function Raven(){this._hasJSON=!!((typeof JSON==="undefined"?"undefined":_typeof(JSON))==='object'&&JSON.stringify);this._hasDocument=!isUndefined$1(_document);this._hasNavigator=!isUndefined$1(_navigator);this._lastCapturedException=null;this._lastData=null;this._lastEventId=null;this._globalServer=null;this._globalKey=null;this._globalProject=null;this._globalContext={};this._globalOptions={release:_window$2.SENTRY_RELEASE&&_window$2.SENTRY_RELEASE.id,logger:'javascript',ignoreErrors:[],ignoreUrls:[],whitelistUrls:[],includePaths:[],headers:null,collectWindowErrors:!0,captureUnhandledRejections:!0,maxMessageLength:0,maxUrlLength:250,stackTraceLimit:50,autoBreadcrumbs:!0,instrument:!0,sampleRate:1,sanitizeKeys:[]};this._fetchDefaults={method:'POST',referrerPolicy:supportsReferrerPolicy$1()?'origin':''};this._ignoreOnError=0;this._isRavenInstalled=!1;this._originalErrorStackTraceLimit=Error.stackTraceLimit;this._originalConsole=_window$2.console||{};this._originalConsoleMethods={};this._plugins=[];this._startTime=now();this._wrappedBuiltIns=[];this._breadcrumbs=[];this._lastCapturedEvent=null;this._keypressTimeout;this._location=_window$2.location;this._lastHref=this._location&&this._location.href;this._resetBackoff();for(var method in this._originalConsole){this._originalConsoleMethods[method]=this._originalConsole[method]}}
Raven.prototype={VERSION:'3.27.0',debug:!1,TraceKit:tracekit,config:function config(dsn,options){var self=this;if(self._globalServer){this._logDebug('error','Error: Raven has already been configured');return self}
if(!dsn)return self;var globalOptions=self._globalOptions;if(options){each$1(options,function(key,value){if(key==='tags'||key==='extra'||key==='user'){self._globalContext[key]=value}else{globalOptions[key]=value}})}
self.setDSN(dsn);globalOptions.ignoreErrors.push(/^Script error\.?$/);globalOptions.ignoreErrors.push(/^Javascript error: Script error\.? on line 0$/);globalOptions.ignoreErrors=joinRegExp$1(globalOptions.ignoreErrors);globalOptions.ignoreUrls=globalOptions.ignoreUrls.length?joinRegExp$1(globalOptions.ignoreUrls):!1;globalOptions.whitelistUrls=globalOptions.whitelistUrls.length?joinRegExp$1(globalOptions.whitelistUrls):!1;globalOptions.includePaths=joinRegExp$1(globalOptions.includePaths);globalOptions.maxBreadcrumbs=Math.max(0,Math.min(globalOptions.maxBreadcrumbs||100,100));var autoBreadcrumbDefaults={xhr:!0,console:!0,dom:!0,location:!0,sentry:!0};var autoBreadcrumbs=globalOptions.autoBreadcrumbs;if({}.toString.call(autoBreadcrumbs)==='[object Object]'){autoBreadcrumbs=objectMerge$1(autoBreadcrumbDefaults,autoBreadcrumbs)}else if(autoBreadcrumbs!==!1){autoBreadcrumbs=autoBreadcrumbDefaults}
globalOptions.autoBreadcrumbs=autoBreadcrumbs;var instrumentDefaults={tryCatch:!0};var instrument=globalOptions.instrument;if({}.toString.call(instrument)==='[object Object]'){instrument=objectMerge$1(instrumentDefaults,instrument)}else if(instrument!==!1){instrument=instrumentDefaults}
globalOptions.instrument=instrument;tracekit.collectWindowErrors=!!globalOptions.collectWindowErrors;return self},install:function install(){var self=this;if(self.isSetup()&&!self._isRavenInstalled){tracekit.report.subscribe(function(){self._handleOnErrorStackInfo.apply(self,arguments)});if(self._globalOptions.captureUnhandledRejections){self._attachPromiseRejectionHandler()}
self._patchFunctionToString();if(self._globalOptions.instrument&&self._globalOptions.instrument.tryCatch){self._instrumentTryCatch()}
if(self._globalOptions.autoBreadcrumbs)self._instrumentBreadcrumbs();self._drainPlugins();self._isRavenInstalled=!0}
Error.stackTraceLimit=self._globalOptions.stackTraceLimit;return this},setDSN:function setDSN(dsn){var self=this,uri=self._parseDSN(dsn),lastSlash=uri.path.lastIndexOf('/'),path=uri.path.substr(1,lastSlash);self._dsn=dsn;self._globalKey=uri.user;self._globalSecret=uri.pass&&uri.pass.substr(1);self._globalProject=uri.path.substr(lastSlash+1);self._globalServer=self._getGlobalServer(uri);self._globalEndpoint=self._globalServer+'/'+path+'api/'+self._globalProject+'/store/';this._resetBackoff()},context:function context(options,func,args){if(isFunction$1(options)){args=func||[];func=options;options={}}
return this.wrap(options,func).apply(this,args)},wrap:function wrap(options,func,_before){var self=this;if(isUndefined$1(func)&&!isFunction$1(options)){return options}
if(isFunction$1(options)){func=options;options=undefined}
if(!isFunction$1(func)){return func}
try{if(func.__raven__){return func}
if(func.__raven_wrapper__){return func.__raven_wrapper__}}catch(e){return func}
function wrapped(){var args=[],i=arguments.length,deep=!options||options&&options.deep!==!1;if(_before&&isFunction$1(_before)){_before.apply(this,arguments)}
while(i--){args[i]=deep?self.wrap(options,arguments[i]):arguments[i]}
try{return func.apply(this,args)}catch(e){self._ignoreNextOnError();self.captureException(e,options);throw e}}
for(var property in func){if(hasKey$1(func,property)){wrapped[property]=func[property]}}
wrapped.prototype=func.prototype;func.__raven_wrapper__=wrapped;wrapped.__raven__=!0;wrapped.__orig__=func;return wrapped},uninstall:function uninstall(){tracekit.report.uninstall();this._detachPromiseRejectionHandler();this._unpatchFunctionToString();this._restoreBuiltIns();this._restoreConsole();Error.stackTraceLimit=this._originalErrorStackTraceLimit;this._isRavenInstalled=!1;return this},_promiseRejectionHandler:function _promiseRejectionHandler(event){this._logDebug('debug','Raven caught unhandled promise rejection:',event);this.captureException(event.reason,{mechanism:{type:'onunhandledrejection',handled:!1}})},_attachPromiseRejectionHandler:function _attachPromiseRejectionHandler(){this._promiseRejectionHandler=this._promiseRejectionHandler.bind(this);_window$2.addEventListener&&_window$2.addEventListener('unhandledrejection',this._promiseRejectionHandler);return this},_detachPromiseRejectionHandler:function _detachPromiseRejectionHandler(){_window$2.removeEventListener&&_window$2.removeEventListener('unhandledrejection',this._promiseRejectionHandler);return this},captureException:function captureException(ex,options){options=objectMerge$1({trimHeadFrames:0},options?options:{});if(isErrorEvent$1(ex)&&ex.error){ex=ex.error}else if(isDOMError$1(ex)||isDOMException$1(ex)){var name=ex.name||(isDOMError$1(ex)?'DOMError':'DOMException');var message=ex.message?name+': '+ex.message:name;return this.captureMessage(message,objectMerge$1(options,{stacktrace:!0,trimHeadFrames:options.trimHeadFrames+1}))}else if(isError$1(ex)){ex=ex}else if(isPlainObject$1(ex)){options=this._getCaptureExceptionOptionsFromPlainObject(options,ex);ex=new Error(options.message)}else{return this.captureMessage(ex,objectMerge$1(options,{stacktrace:!0,trimHeadFrames:options.trimHeadFrames+1}))}
this._lastCapturedException=ex;try{var stack=tracekit.computeStackTrace(ex);this._handleStackInfo(stack,options)}catch(ex1){if(ex!==ex1){throw ex1}}
return this},_getCaptureExceptionOptionsFromPlainObject:function _getCaptureExceptionOptionsFromPlainObject(currentOptions,ex){var exKeys=Object.keys(ex).sort();var options=objectMerge$1(currentOptions,{message:'Non-Error exception captured with keys: '+serializeKeysForMessage$1(exKeys),fingerprint:[md5_1(exKeys)],extra:currentOptions.extra||{}});options.extra.__serialized__=serializeException$1(ex);return options},captureMessage:function captureMessage(msg,options){if(!!this._globalOptions.ignoreErrors.test&&this._globalOptions.ignoreErrors.test(msg)){return}
options=options||{};msg=msg+'';var data=objectMerge$1({message:msg},options);var ex;try{throw new Error(msg)}catch(ex1){ex=ex1}
ex.name=null;var stack=tracekit.computeStackTrace(ex);var initialCall=isArray$1(stack.stack)&&stack.stack[1];if(initialCall&&initialCall.func==='Raven.captureException'){initialCall=stack.stack[2]}
var fileurl=initialCall&&initialCall.url||'';if(!!this._globalOptions.ignoreUrls.test&&this._globalOptions.ignoreUrls.test(fileurl)){return}
if(!!this._globalOptions.whitelistUrls.test&&!this._globalOptions.whitelistUrls.test(fileurl)){return}
if(this._globalOptions.stacktrace||options.stacktrace||data.message===''){data.fingerprint=data.fingerprint==null?msg:data.fingerprint;options=objectMerge$1({trimHeadFrames:0},options);options.trimHeadFrames+=1;var frames=this._prepareFrames(stack,options);data.stacktrace={frames:frames.reverse()}}
if(data.fingerprint){data.fingerprint=isArray$1(data.fingerprint)?data.fingerprint:[data.fingerprint]}
this._send(data);return this},captureBreadcrumb:function captureBreadcrumb(obj){var crumb=objectMerge$1({timestamp:now()/1000},obj);if(isFunction$1(this._globalOptions.breadcrumbCallback)){var result=this._globalOptions.breadcrumbCallback(crumb);if(isObject$1(result)&&!isEmptyObject$1(result)){crumb=result}else if(result===!1){return this}}
this._breadcrumbs.push(crumb);if(this._breadcrumbs.length>this._globalOptions.maxBreadcrumbs){this._breadcrumbs.shift()}
return this},addPlugin:function addPlugin(plugin){var pluginArgs=[].slice.call(arguments,1);this._plugins.push([plugin,pluginArgs]);if(this._isRavenInstalled){this._drainPlugins()}
return this},setUserContext:function setUserContext(user){this._globalContext.user=user;return this},setExtraContext:function setExtraContext(extra){this._mergeContext('extra',extra);return this},setTagsContext:function setTagsContext(tags){this._mergeContext('tags',tags);return this},clearContext:function clearContext(){this._globalContext={};return this},getContext:function getContext(){return JSON.parse(stringify_1(this._globalContext))},setEnvironment:function setEnvironment(environment){this._globalOptions.environment=environment;return this},setRelease:function setRelease(release){this._globalOptions.release=release;return this},setDataCallback:function setDataCallback(callback){var original=this._globalOptions.dataCallback;this._globalOptions.dataCallback=keepOriginalCallback(original,callback);return this},setBreadcrumbCallback:function setBreadcrumbCallback(callback){var original=this._globalOptions.breadcrumbCallback;this._globalOptions.breadcrumbCallback=keepOriginalCallback(original,callback);return this},setShouldSendCallback:function setShouldSendCallback(callback){var original=this._globalOptions.shouldSendCallback;this._globalOptions.shouldSendCallback=keepOriginalCallback(original,callback);return this},setTransport:function setTransport(transport){this._globalOptions.transport=transport;return this},lastException:function lastException(){return this._lastCapturedException},lastEventId:function lastEventId(){return this._lastEventId},isSetup:function isSetup(){if(!this._hasJSON)return!1;if(!this._globalServer){if(!this.ravenNotConfiguredError){this.ravenNotConfiguredError=!0;this._logDebug('error','Error: Raven has not been configured.')}
return!1}
return!0},afterLoad:function afterLoad(){var RavenConfig=_window$2.RavenConfig;if(RavenConfig){this.config(RavenConfig.dsn,RavenConfig.config).install()}},showReportDialog:function showReportDialog(options){if(!_document)return;options=objectMerge$1({eventId:this.lastEventId(),dsn:this._dsn,user:this._globalContext.user||{}},options);if(!options.eventId){throw new configError('Missing eventId')}
if(!options.dsn){throw new configError('Missing DSN')}
var encode=encodeURIComponent;var encodedOptions=[];for(var key in options){if(key==='user'){var user=options.user;if(user.name)encodedOptions.push('name='+encode(user.name));if(user.email)encodedOptions.push('email='+encode(user.email))}else{encodedOptions.push(encode(key)+'='+encode(options[key]))}}
var globalServer=this._getGlobalServer(this._parseDSN(options.dsn));var script=_document.createElement('script');script.async=!0;script.src=globalServer+'/api/embed/error-page/?'+encodedOptions.join('&');(_document.head||_document.body).appendChild(script)},_ignoreNextOnError:function _ignoreNextOnError(){var self=this;this._ignoreOnError+=1;setTimeout(function(){self._ignoreOnError-=1})},_triggerEvent:function _triggerEvent(eventType,options){var evt,key;if(!this._hasDocument)return;options=options||{};eventType='raven'+eventType.substr(0,1).toUpperCase()+eventType.substr(1);if(_document.createEvent){evt=_document.createEvent('HTMLEvents');evt.initEvent(eventType,!0,!0)}else{evt=_document.createEventObject();evt.eventType=eventType}
for(key in options){if(hasKey$1(options,key)){evt[key]=options[key]}}
if(_document.createEvent){_document.dispatchEvent(evt)}else{try{_document.fireEvent('on'+evt.eventType.toLowerCase(),evt)}catch(e){}}},_breadcrumbEventHandler:function _breadcrumbEventHandler(evtName){var self=this;return function(evt){self._keypressTimeout=null;if(self._lastCapturedEvent===evt)return;self._lastCapturedEvent=evt;var target;try{target=htmlTreeAsString$1(evt.target)}catch(e){target='<unknown>'}
self.captureBreadcrumb({category:'ui.'+evtName,message:target})}},_keypressEventHandler:function _keypressEventHandler(){var self=this,debounceDuration=1000;return function(evt){var target;try{target=evt.target}catch(e){return}
var tagName=target&&target.tagName;if(!tagName||tagName!=='INPUT'&&tagName!=='TEXTAREA'&&!target.isContentEditable)return;var timeout=self._keypressTimeout;if(!timeout){self._breadcrumbEventHandler('input')(evt)}
clearTimeout(timeout);self._keypressTimeout=setTimeout(function(){self._keypressTimeout=null},debounceDuration)}},_captureUrlChange:function _captureUrlChange(from,to){var parsedLoc=parseUrl$1(this._location.href);var parsedTo=parseUrl$1(to);var parsedFrom=parseUrl$1(from);this._lastHref=to;if(parsedLoc.protocol===parsedTo.protocol&&parsedLoc.host===parsedTo.host)to=parsedTo.relative;if(parsedLoc.protocol===parsedFrom.protocol&&parsedLoc.host===parsedFrom.host)from=parsedFrom.relative;this.captureBreadcrumb({category:'navigation',data:{to:to,from:from}})},_patchFunctionToString:function _patchFunctionToString(){var self=this;self._originalFunctionToString=Function.prototype.toString;Function.prototype.toString=function(){if(typeof this==='function'&&this.__raven__){return self._originalFunctionToString.apply(this.__orig__,arguments)}
return self._originalFunctionToString.apply(this,arguments)}},_unpatchFunctionToString:function _unpatchFunctionToString(){if(this._originalFunctionToString){Function.prototype.toString=this._originalFunctionToString}},_instrumentTryCatch:function _instrumentTryCatch(){var self=this;var wrappedBuiltIns=self._wrappedBuiltIns;function wrapTimeFn(orig){return function(fn,t){var args=new Array(arguments.length);for(var i=0;i<args.length;++i){args[i]=arguments[i]}
var originalCallback=args[0];if(isFunction$1(originalCallback)){args[0]=self.wrap({mechanism:{type:'instrument',data:{function:orig.name||'<anonymous>'}}},originalCallback)}
if(orig.apply){return orig.apply(this,args)}else{return orig(args[0],args[1])}}}
var autoBreadcrumbs=this._globalOptions.autoBreadcrumbs;function wrapEventTarget(global){var proto=_window$2[global]&&_window$2[global].prototype;if(proto&&proto.hasOwnProperty&&proto.hasOwnProperty('addEventListener')){fill$1(proto,'addEventListener',function(orig){return function(evtName,fn,capture,secure){try{if(fn&&fn.handleEvent){fn.handleEvent=self.wrap({mechanism:{type:'instrument',data:{target:global,function:'handleEvent',handler:fn&&fn.name||'<anonymous>'}}},fn.handleEvent)}}catch(err){}
var before,clickHandler,keypressHandler;if(autoBreadcrumbs&&autoBreadcrumbs.dom&&(global==='EventTarget'||global==='Node')){clickHandler=self._breadcrumbEventHandler('click');keypressHandler=self._keypressEventHandler();before=function before(evt){if(!evt)return;var eventType;try{eventType=evt.type}catch(e){return}
if(eventType==='click')return clickHandler(evt);else if(eventType==='keypress')return keypressHandler(evt)}}
return orig.call(this,evtName,self.wrap({mechanism:{type:'instrument',data:{target:global,function:'addEventListener',handler:fn&&fn.name||'<anonymous>'}}},fn,before),capture,secure)}},wrappedBuiltIns);fill$1(proto,'removeEventListener',function(orig){return function(evt,fn,capture,secure){try{fn=fn&&(fn.__raven_wrapper__?fn.__raven_wrapper__:fn)}catch(e){}
return orig.call(this,evt,fn,capture,secure)}},wrappedBuiltIns)}}
fill$1(_window$2,'setTimeout',wrapTimeFn,wrappedBuiltIns);fill$1(_window$2,'setInterval',wrapTimeFn,wrappedBuiltIns);if(_window$2.requestAnimationFrame){fill$1(_window$2,'requestAnimationFrame',function(orig){return function(cb){return orig(self.wrap({mechanism:{type:'instrument',data:{function:'requestAnimationFrame',handler:orig&&orig.name||'<anonymous>'}}},cb))}},wrappedBuiltIns)}
var eventTargets=['EventTarget','Window','Node','ApplicationCache','AudioTrackList','ChannelMergerNode','CryptoOperation','EventSource','FileReader','HTMLUnknownElement','IDBDatabase','IDBRequest','IDBTransaction','KeyOperation','MediaController','MessagePort','ModalWindow','Notification','SVGElementInstance','Screen','TextTrack','TextTrackCue','TextTrackList','WebSocket','WebSocketWorker','Worker','XMLHttpRequest','XMLHttpRequestEventTarget','XMLHttpRequestUpload'];for(var i=0;i<eventTargets.length;i++){wrapEventTarget(eventTargets[i])}},_instrumentBreadcrumbs:function _instrumentBreadcrumbs(){var self=this;var autoBreadcrumbs=this._globalOptions.autoBreadcrumbs;var wrappedBuiltIns=self._wrappedBuiltIns;function wrapProp(prop,xhr){if(prop in xhr&&isFunction$1(xhr[prop])){fill$1(xhr,prop,function(orig){return self.wrap({mechanism:{type:'instrument',data:{function:prop,handler:orig&&orig.name||'<anonymous>'}}},orig)})}}
if(autoBreadcrumbs.xhr&&'XMLHttpRequest' in _window$2){var xhrproto=_window$2.XMLHttpRequest&&_window$2.XMLHttpRequest.prototype;fill$1(xhrproto,'open',function(origOpen){return function(method,url){if(isString$1(url)&&url.indexOf(self._globalKey)===-1){this.__raven_xhr={method:method,url:url,status_code:null}}
return origOpen.apply(this,arguments)}},wrappedBuiltIns);fill$1(xhrproto,'send',function(origSend){return function(){var xhr=this;function onreadystatechangeHandler(){if(xhr.__raven_xhr&&xhr.readyState===4){try{xhr.__raven_xhr.status_code=xhr.status}catch(e){}
self.captureBreadcrumb({type:'http',category:'xhr',data:xhr.__raven_xhr})}}
var props=['onload','onerror','onprogress'];for(var j=0;j<props.length;j++){wrapProp(props[j],xhr)}
if('onreadystatechange' in xhr&&isFunction$1(xhr.onreadystatechange)){fill$1(xhr,'onreadystatechange',function(orig){return self.wrap({mechanism:{type:'instrument',data:{function:'onreadystatechange',handler:orig&&orig.name||'<anonymous>'}}},orig,onreadystatechangeHandler)})}else{xhr.onreadystatechange=onreadystatechangeHandler}
return origSend.apply(this,arguments)}},wrappedBuiltIns)}
if(autoBreadcrumbs.xhr&&supportsFetch$1()){fill$1(_window$2,'fetch',function(origFetch){return function(){var args=new Array(arguments.length);for(var i=0;i<args.length;++i){args[i]=arguments[i]}
var fetchInput=args[0];var method='GET';var url;if(typeof fetchInput==='string'){url=fetchInput}else if('Request' in _window$2&&fetchInput instanceof _window$2.Request){url=fetchInput.url;if(fetchInput.method){method=fetchInput.method}}else{url=''+fetchInput}
if(url.indexOf(self._globalKey)!==-1){return origFetch.apply(this,args)}
if(args[1]&&args[1].method){method=args[1].method}
var fetchData={method:method,url:url,status_code:null};return origFetch.apply(this,args).then(function(response){fetchData.status_code=response.status;self.captureBreadcrumb({type:'http',category:'fetch',data:fetchData});return response})['catch'](function(err){self.captureBreadcrumb({type:'http',category:'fetch',data:fetchData,level:'error'});throw err})}},wrappedBuiltIns)}
if(autoBreadcrumbs.dom&&this._hasDocument){if(_document.addEventListener){_document.addEventListener('click',self._breadcrumbEventHandler('click'),!1);_document.addEventListener('keypress',self._keypressEventHandler(),!1)}else if(_document.attachEvent){_document.attachEvent('onclick',self._breadcrumbEventHandler('click'));_document.attachEvent('onkeypress',self._keypressEventHandler())}}
var chrome=_window$2.chrome;var isChromePackagedApp=chrome&&chrome.app&&chrome.app.runtime;var hasPushAndReplaceState=!isChromePackagedApp&&_window$2.history&&_window$2.history.pushState&&_window$2.history.replaceState;if(autoBreadcrumbs.location&&hasPushAndReplaceState){var oldOnPopState=_window$2.onpopstate;_window$2.onpopstate=function(){var currentHref=self._location.href;self._captureUrlChange(self._lastHref,currentHref);if(oldOnPopState){return oldOnPopState.apply(this,arguments)}};var historyReplacementFunction=function historyReplacementFunction(origHistFunction){return function(){var url=arguments.length>2?arguments[2]:undefined;if(url){self._captureUrlChange(self._lastHref,url+'')}
return origHistFunction.apply(this,arguments)}};fill$1(_window$2.history,'pushState',historyReplacementFunction,wrappedBuiltIns);fill$1(_window$2.history,'replaceState',historyReplacementFunction,wrappedBuiltIns)}
if(autoBreadcrumbs.console&&'console' in _window$2&&console.log){var consoleMethodCallback=function consoleMethodCallback(msg,data){self.captureBreadcrumb({message:msg,level:data.level,category:'console'})};each$1(['debug','info','warn','error','log'],function(_,level){wrapConsoleMethod(console,level,consoleMethodCallback)})}},_restoreBuiltIns:function _restoreBuiltIns(){var builtin;while(this._wrappedBuiltIns.length){builtin=this._wrappedBuiltIns.shift();var obj=builtin[0],name=builtin[1],orig=builtin[2];obj[name]=orig}},_restoreConsole:function _restoreConsole(){for(var method in this._originalConsoleMethods){this._originalConsole[method]=this._originalConsoleMethods[method]}},_drainPlugins:function _drainPlugins(){var self=this;each$1(this._plugins,function(_,plugin){var installer=plugin[0];var args=plugin[1];installer.apply(self,[self].concat(args))})},_parseDSN:function _parseDSN(str){var m=dsnPattern.exec(str),dsn={},i=7;try{while(i--){dsn[dsnKeys[i]]=m[i]||''}}catch(e){throw new configError('Invalid DSN: '+str)}
if(dsn.pass&&!this._globalOptions.allowSecretKey){throw new configError('Do not specify your secret key in the DSN. See: http://bit.ly/raven-secret-key')}
return dsn},_getGlobalServer:function _getGlobalServer(uri){var globalServer='//'+uri.host+(uri.port?':'+uri.port:'');if(uri.protocol){globalServer=uri.protocol+':'+globalServer}
return globalServer},_handleOnErrorStackInfo:function _handleOnErrorStackInfo(stackInfo,options){options=options||{};options.mechanism=options.mechanism||{type:'onerror',handled:!1};if(!this._ignoreOnError){this._handleStackInfo(stackInfo,options)}},_handleStackInfo:function _handleStackInfo(stackInfo,options){var frames=this._prepareFrames(stackInfo,options);this._triggerEvent('handle',{stackInfo:stackInfo,options:options});this._processException(stackInfo.name,stackInfo.message,stackInfo.url,stackInfo.lineno,frames,options)},_prepareFrames:function _prepareFrames(stackInfo,options){var self=this;var frames=[];if(stackInfo.stack&&stackInfo.stack.length){each$1(stackInfo.stack,function(i,stack){var frame=self._normalizeFrame(stack,stackInfo.url);if(frame){frames.push(frame)}});if(options&&options.trimHeadFrames){for(var j=0;j<options.trimHeadFrames&&j<frames.length;j++){frames[j].in_app=!1}}}
frames=frames.slice(0,this._globalOptions.stackTraceLimit);return frames},_normalizeFrame:function _normalizeFrame(frame,stackInfoUrl){var normalized={filename:frame.url,lineno:frame.line,colno:frame.column,function:frame.func||'?'};if(!frame.url){normalized.filename=stackInfoUrl}
normalized.in_app=!(!!this._globalOptions.includePaths.test&&!this._globalOptions.includePaths.test(normalized.filename)||/(Raven|TraceKit)\./.test(normalized['function'])||/raven\.(min\.)?js$/.test(normalized.filename));return normalized},_processException:function _processException(type,message,fileurl,lineno,frames,options){var prefixedMessage=(type?type+': ':'')+(message||'');if(!!this._globalOptions.ignoreErrors.test&&(this._globalOptions.ignoreErrors.test(message)||this._globalOptions.ignoreErrors.test(prefixedMessage))){return}
var stacktrace;if(frames&&frames.length){fileurl=frames[0].filename||fileurl;frames.reverse();stacktrace={frames:frames}}else if(fileurl){stacktrace={frames:[{filename:fileurl,lineno:lineno,in_app:!0}]}}
if(!!this._globalOptions.ignoreUrls.test&&this._globalOptions.ignoreUrls.test(fileurl)){return}
if(!!this._globalOptions.whitelistUrls.test&&!this._globalOptions.whitelistUrls.test(fileurl)){return}
var data=objectMerge$1({exception:{values:[{type:type,value:message,stacktrace:stacktrace}]},transaction:fileurl},options);var ex=data.exception.values[0];if(ex.type==null&&ex.value===''){ex.value='Unrecoverable error caught'}
if(!data.exception.mechanism&&data.mechanism){data.exception.mechanism=data.mechanism;delete data.mechanism}
data.exception.mechanism=objectMerge$1({type:'generic',handled:!0},data.exception.mechanism||{});this._send(data)},_trimPacket:function _trimPacket(data){var max=this._globalOptions.maxMessageLength;if(data.message){data.message=truncate$1(data.message,max)}
if(data.exception){var exception=data.exception.values[0];exception.value=truncate$1(exception.value,max)}
var request=data.request;if(request){if(request.url){request.url=truncate$1(request.url,this._globalOptions.maxUrlLength)}
if(request.Referer){request.Referer=truncate$1(request.Referer,this._globalOptions.maxUrlLength)}}
if(data.breadcrumbs&&data.breadcrumbs.values)this._trimBreadcrumbs(data.breadcrumbs);return data},_trimBreadcrumbs:function _trimBreadcrumbs(breadcrumbs){var urlProps=['to','from','url'],urlProp,crumb,data;for(var i=0;i<breadcrumbs.values.length;++i){crumb=breadcrumbs.values[i];if(!crumb.hasOwnProperty('data')||!isObject$1(crumb.data)||objectFrozen$1(crumb.data))continue;data=objectMerge$1({},crumb.data);for(var j=0;j<urlProps.length;++j){urlProp=urlProps[j];if(data.hasOwnProperty(urlProp)&&data[urlProp]){data[urlProp]=truncate$1(data[urlProp],this._globalOptions.maxUrlLength)}}
breadcrumbs.values[i].data=data}},_getHttpData:function _getHttpData(){if(!this._hasNavigator&&!this._hasDocument)return;var httpData={};if(this._hasNavigator&&_navigator.userAgent){httpData.headers={'User-Agent':_navigator.userAgent}}
if(_window$2.location&&_window$2.location.href){httpData.url=_window$2.location.href}
if(this._hasDocument&&_document.referrer){if(!httpData.headers)httpData.headers={};httpData.headers.Referer=_document.referrer}
return httpData},_resetBackoff:function _resetBackoff(){this._backoffDuration=0;this._backoffStart=null},_shouldBackoff:function _shouldBackoff(){return this._backoffDuration&&now()-this._backoffStart<this._backoffDuration},_isRepeatData:function _isRepeatData(current){var last=this._lastData;if(!last||current.message!==last.message||current.transaction!==last.transaction)return!1;if(current.stacktrace||last.stacktrace){return isSameStacktrace$1(current.stacktrace,last.stacktrace)}else if(current.exception||last.exception){return isSameException$1(current.exception,last.exception)}
return!0},_setBackoffState:function _setBackoffState(request){if(this._shouldBackoff()){return}
var status=request.status;if(!(status===400||status===401||status===429))return;var retry;try{if(supportsFetch$1()){retry=request.headers.get('Retry-After')}else{retry=request.getResponseHeader('Retry-After')}
retry=parseInt(retry,10)*1000}catch(e){}
this._backoffDuration=retry?retry:this._backoffDuration*2||1000;this._backoffStart=now()},_send:function _send(data){var globalOptions=this._globalOptions;var baseData={project:this._globalProject,logger:globalOptions.logger,platform:'javascript'},httpData=this._getHttpData();if(httpData){baseData.request=httpData}
if(data.trimHeadFrames)delete data.trimHeadFrames;data=objectMerge$1(baseData,data);data.tags=objectMerge$1(objectMerge$1({},this._globalContext.tags),data.tags);data.extra=objectMerge$1(objectMerge$1({},this._globalContext.extra),data.extra);data.extra['session:duration']=now()-this._startTime;if(this._breadcrumbs&&this._breadcrumbs.length>0){data.breadcrumbs={values:[].slice.call(this._breadcrumbs,0)}}
if(this._globalContext.user){data.user=this._globalContext.user}
if(globalOptions.environment)data.environment=globalOptions.environment;if(globalOptions.release)data.release=globalOptions.release;if(globalOptions.serverName)data.server_name=globalOptions.serverName;data=this._sanitizeData(data);Object.keys(data).forEach(function(key){if(data[key]==null||data[key]===''||isEmptyObject$1(data[key])){delete data[key]}});if(isFunction$1(globalOptions.dataCallback)){data=globalOptions.dataCallback(data)||data}
if(!data||isEmptyObject$1(data)){return}
if(isFunction$1(globalOptions.shouldSendCallback)&&!globalOptions.shouldSendCallback(data)){return}
if(this._shouldBackoff()){this._logDebug('warn','Raven dropped error due to backoff: ',data);return}
if(typeof globalOptions.sampleRate==='number'){if(Math.random()<globalOptions.sampleRate){this._sendProcessedPayload(data)}}else{this._sendProcessedPayload(data)}},_sanitizeData:function _sanitizeData(data){return sanitize$1(data,this._globalOptions.sanitizeKeys)},_getUuid:function _getUuid(){return uuid4$1()},_sendProcessedPayload:function _sendProcessedPayload(data,callback){var self=this;var globalOptions=this._globalOptions;if(!this.isSetup())return;data=this._trimPacket(data);if(!this._globalOptions.allowDuplicates&&this._isRepeatData(data)){this._logDebug('warn','Raven dropped repeat event: ',data);return}
this._lastEventId=data.event_id||(data.event_id=this._getUuid());this._lastData=data;this._logDebug('debug','Raven about to send:',data);var auth={sentry_version:'7',sentry_client:'raven-js/'+this.VERSION,sentry_key:this._globalKey};if(this._globalSecret){auth.sentry_secret=this._globalSecret}
var exception=data.exception&&data.exception.values[0];if(this._globalOptions.autoBreadcrumbs&&this._globalOptions.autoBreadcrumbs.sentry){this.captureBreadcrumb({category:'sentry',message:exception?(exception.type?exception.type+': ':'')+exception.value:data.message,event_id:data.event_id,level:data.level||'error'})}
var url=this._globalEndpoint;(globalOptions.transport||this._makeRequest).call(this,{url:url,auth:auth,data:data,options:globalOptions,onSuccess:function success(){self._resetBackoff();self._triggerEvent('success',{data:data,src:url});callback&&callback()},onError:function failure(error){self._logDebug('error','Raven transport failed to send: ',error);if(error.request){self._setBackoffState(error.request)}
self._triggerEvent('failure',{data:data,src:url});error=error||new Error('Raven send failed (no additional details provided)');callback&&callback(error)}})},_makeRequest:function _makeRequest(opts){var url=opts.url+'?'+urlencode$1(opts.auth);var evaluatedHeaders=null;var evaluatedFetchParameters={};if(opts.options.headers){evaluatedHeaders=this._evaluateHash(opts.options.headers)}
if(opts.options.fetchParameters){evaluatedFetchParameters=this._evaluateHash(opts.options.fetchParameters)}
if(supportsFetch$1()){evaluatedFetchParameters.body=stringify_1(opts.data);var defaultFetchOptions=objectMerge$1({},this._fetchDefaults);var fetchOptions=objectMerge$1(defaultFetchOptions,evaluatedFetchParameters);if(evaluatedHeaders){fetchOptions.headers=evaluatedHeaders}
return _window$2.fetch(url,fetchOptions).then(function(response){if(response.ok){opts.onSuccess&&opts.onSuccess()}else{var error=new Error('Sentry error code: '+response.status);error.request=response;opts.onError&&opts.onError(error)}})['catch'](function(){opts.onError&&opts.onError(new Error('Sentry error code: network unavailable'))})}
var request=_window$2.XMLHttpRequest&&new _window$2.XMLHttpRequest();if(!request)return;var hasCORS='withCredentials' in request||typeof XDomainRequest!=='undefined';if(!hasCORS)return;if('withCredentials' in request){request.onreadystatechange=function(){if(request.readyState!==4){return}else if(request.status===200){opts.onSuccess&&opts.onSuccess()}else if(opts.onError){var err=new Error('Sentry error code: '+request.status);err.request=request;opts.onError(err)}}}else{request=new XDomainRequest();url=url.replace(/^https?:/,'');if(opts.onSuccess){request.onload=opts.onSuccess}
if(opts.onError){request.onerror=function(){var err=new Error('Sentry error code: XDomainRequest');err.request=request;opts.onError(err)}}}
request.open('POST',url);if(evaluatedHeaders){each$1(evaluatedHeaders,function(key,value){request.setRequestHeader(key,value)})}
request.send(stringify_1(opts.data))},_evaluateHash:function _evaluateHash(hash){var evaluated={};for(var key in hash){if(hash.hasOwnProperty(key)){var value=hash[key];evaluated[key]=typeof value==='function'?value():value}}
return evaluated},_logDebug:function _logDebug(level){if(this._originalConsoleMethods[level]&&(this.debug||this._globalOptions.debug)){Function.prototype.apply.call(this._originalConsoleMethods[level],this._originalConsole,[].slice.call(arguments,1))}},_mergeContext:function _mergeContext(key,context){if(isUndefined$1(context)){delete this._globalContext[key]}else{this._globalContext[key]=objectMerge$1(this._globalContext[key]||{},context)}}};Raven.prototype.setUser=Raven.prototype.setUserContext;Raven.prototype.setReleaseContext=Raven.prototype.setRelease;var raven=Raven;var _window$3=typeof window!=='undefined'?window:typeof commonjsGlobal!=='undefined'?commonjsGlobal:typeof self!=='undefined'?self:{};var _Raven=_window$3.Raven;var Raven$1=new raven();Raven$1.noConflict=function(){_window$3.Raven=_Raven;return Raven$1};Raven$1.afterLoad();var singleton=Raven$1;var Client=raven;singleton.Client=Client;var defaults={addCSS:!0,thumbWidth:15,watch:!0};function matches(element,selector){function match(){return Array.from(document.querySelectorAll(selector)).includes(this)}
var matches=match;return matches.call(element,selector)}
function trigger(element,type){if(!element||!type){return}
var event=new Event(type);element.dispatchEvent(event)}
var getConstructor=function getConstructor(input){return input!==null&&typeof input!=='undefined'?input.constructor:null};var instanceOf=function instanceOf(input,constructor){return Boolean(input&&constructor&&input instanceof constructor)};var isNullOrUndefined=function isNullOrUndefined(input){return input===null||typeof input==='undefined'};var isObject$2=function isObject(input){return getConstructor(input)===Object};var isNumber=function isNumber(input){return getConstructor(input)===Number&&!Number.isNaN(input)};var isString$2=function isString(input){return getConstructor(input)===String};var isBoolean=function isBoolean(input){return getConstructor(input)===Boolean};var isFunction$2=function isFunction(input){return getConstructor(input)===Function};var isArray$2=function isArray(input){return Array.isArray(input)};var isNodeList=function isNodeList(input){return instanceOf(input,NodeList)};var isElement=function isElement(input){return instanceOf(input,Element)};var isEvent=function isEvent(input){return instanceOf(input,Event)};var isEmpty=function isEmpty(input){return isNullOrUndefined(input)||(isString$2(input)||isArray$2(input)||isNodeList(input))&&!input.length||isObject$2(input)&&!Object.keys(input).length};var is={nullOrUndefined:isNullOrUndefined,object:isObject$2,number:isNumber,string:isString$2,boolean:isBoolean,function:isFunction$2,array:isArray$2,nodeList:isNodeList,element:isElement,event:isEvent,empty:isEmpty};function getDecimalPlaces(value){var match="".concat(value).match(/(?:\.(\d+))?(?:[eE]([+-]?\d+))?$/);if(!match){return 0}
return Math.max(0,(match[1]?match[1].length:0)-(match[2]?+match[2]:0))}
function round(number,step){if(step<1){var places=getDecimalPlaces(step);return parseFloat(number.toFixed(places))}
return Math.round(number/step)*step}
var RangeTouch=function(){function RangeTouch(target,options){_classCallCheck(this,RangeTouch);if(is.element(target)){this.element=target}else if(is.string(target)){this.element=document.querySelector(target)}
if(!is.element(this.element)||!is.empty(this.element.rangeTouch)){return}
this.config=Object.assign({},defaults,options);this.init()}
_createClass(RangeTouch,[{key:"init",value:function init(){if(!RangeTouch.enabled){return}
if(this.config.addCSS){this.element.style.userSelect='none';this.element.style.webKitUserSelect='none';this.element.style.touchAction='manipulation'}
this.listeners(!0);this.element.rangeTouch=this}},{key:"destroy",value:function destroy(){if(!RangeTouch.enabled){return}
this.listeners(!1);this.element.rangeTouch=null}},{key:"listeners",value:function listeners(toggle){var _this=this;var method=toggle?'addEventListener':'removeEventListener';['touchstart','touchmove','touchend'].forEach(function(type){_this.element[method](type,function(event){return _this.set(event)},!1)})}},{key:"get",value:function get(event){if(!RangeTouch.enabled||!is.event(event)){return null}
var input=event.target;var touch=event.changedTouches[0];var min=parseFloat(input.getAttribute('min'))||0;var max=parseFloat(input.getAttribute('max'))||100;var step=parseFloat(input.getAttribute('step'))||1;var delta=max-min;var percent;var clientRect=input.getBoundingClientRect();var thumbWidth=100/clientRect.width*(this.config.thumbWidth/2)/100;percent=100/clientRect.width*(touch.clientX-clientRect.left);if(percent<0){percent=0}else if(percent>100){percent=100}
if(percent<50){percent-=(100-percent*2)*thumbWidth}else if(percent>50){percent+=(percent-50)*2*thumbWidth}
return min+round(delta*(percent/100),step)}},{key:"set",value:function set(event){if(!RangeTouch.enabled||!is.event(event)||event.target.disabled){return}
event.preventDefault();event.target.value=this.get(event);trigger(event.target,event.type==='touchend'?'change':'input')}}],[{key:"setup",value:function setup(target){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var targets=null;if(is.empty(target)||is.string(target)){targets=Array.from(document.querySelectorAll(is.string(target)?target:'input[type="range"]'))}else if(is.element(target)){targets=[target]}else if(is.nodeList(target)){targets=Array.from(target)}else if(is.array(target)){targets=target.filter(is.element)}
if(is.empty(targets)){return null}
var config=Object.assign({},defaults,options);if(is.string(target)&&config.watch){var observer=new MutationObserver(function(mutations){Array.from(mutations).forEach(function(mutation){Array.from(mutation.addedNodes).forEach(function(node){if(!is.element(node)||!matches(node,target)){return}
var range=new RangeTouch(node,config)})})});observer.observe(document.body,{childList:!0,subtree:!0})}
return targets.map(function(t){return new RangeTouch(t,options)})}},{key:"enabled",get:function get(){return'ontouchstart' in document.documentElement}}]);return RangeTouch}();var getConstructor$1=function getConstructor(input){return input!==null&&typeof input!=='undefined'?input.constructor:null};var instanceOf$1=function instanceOf(input,constructor){return Boolean(input&&constructor&&input instanceof constructor)};var isNullOrUndefined$1=function isNullOrUndefined(input){return input===null||typeof input==='undefined'};var isObject$3=function isObject(input){return getConstructor$1(input)===Object};var isNumber$1=function isNumber(input){return getConstructor$1(input)===Number&&!Number.isNaN(input)};var isString$3=function isString(input){return getConstructor$1(input)===String};var isBoolean$1=function isBoolean(input){return getConstructor$1(input)===Boolean};var isFunction$3=function isFunction(input){return getConstructor$1(input)===Function};var isArray$3=function isArray(input){return Array.isArray(input)};var isWeakMap=function isWeakMap(input){return instanceOf$1(input,WeakMap)};var isNodeList$1=function isNodeList(input){return instanceOf$1(input,NodeList)};var isElement$1=function isElement(input){return instanceOf$1(input,Element)};var isTextNode=function isTextNode(input){return getConstructor$1(input)===Text};var isEvent$1=function isEvent(input){return instanceOf$1(input,Event)};var isKeyboardEvent=function isKeyboardEvent(input){return instanceOf$1(input,KeyboardEvent)};var isCue=function isCue(input){return instanceOf$1(input,window.TextTrackCue)||instanceOf$1(input,window.VTTCue)};var isTrack=function isTrack(input){return instanceOf$1(input,TextTrack)||!isNullOrUndefined$1(input)&&isString$3(input.kind)};var isPromise=function isPromise(input){return instanceOf$1(input,Promise)};var isEmpty$1=function isEmpty(input){return isNullOrUndefined$1(input)||(isString$3(input)||isArray$3(input)||isNodeList$1(input))&&!input.length||isObject$3(input)&&!Object.keys(input).length};var isUrl=function isUrl(input){if(instanceOf$1(input,window.URL)){return!0}
if(!isString$3(input)){return!1}
var string=input;if(!input.startsWith('http://')||!input.startsWith('https://')){string="http://".concat(input)}
try{return!isEmpty$1(new URL(string).hostname)}catch(e){return!1}};var is$1={nullOrUndefined:isNullOrUndefined$1,object:isObject$3,number:isNumber$1,string:isString$3,boolean:isBoolean$1,function:isFunction$3,array:isArray$3,weakMap:isWeakMap,nodeList:isNodeList$1,element:isElement$1,textNode:isTextNode,event:isEvent$1,keyboardEvent:isKeyboardEvent,cue:isCue,track:isTrack,promise:isPromise,url:isUrl,empty:isEmpty$1};var supportsPassiveListeners=function(){var supported=!1;try{var options=Object.defineProperty({},'passive',{get:function get(){supported=!0;return null}});window.addEventListener('test',null,options);window.removeEventListener('test',null,options)}catch(e){}
return supported}();function toggleListener(element,event,callback){var _this=this;var toggle=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!1;var passive=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!0;var capture=arguments.length>5&&arguments[5]!==undefined?arguments[5]:!1;if(!element||!('addEventListener' in element)||is$1.empty(event)||!is$1.function(callback)){return}
var events=event.split(' ');var options=capture;if(supportsPassiveListeners){options={passive:passive,capture:capture}}
events.forEach(function(type){if(_this&&_this.eventListeners&&toggle){_this.eventListeners.push({element:element,type:type,callback:callback,options:options})}
element[toggle?'addEventListener':'removeEventListener'](type,callback,options)})}
function on(element){var events=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';var callback=arguments.length>2?arguments[2]:undefined;var passive=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;var capture=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;toggleListener.call(this,element,events,callback,!0,passive,capture)}
function off(element){var events=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';var callback=arguments.length>2?arguments[2]:undefined;var passive=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;var capture=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;toggleListener.call(this,element,events,callback,!1,passive,capture)}
function once(element){var _this2=this;var events=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';var callback=arguments.length>2?arguments[2]:undefined;var passive=arguments.length>3&&arguments[3]!==undefined?arguments[3]:!0;var capture=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!1;var onceCallback=function onceCallback(){off(element,events,onceCallback,passive,capture);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key]}
callback.apply(_this2,args)};toggleListener.call(this,element,events,onceCallback,!0,passive,capture)}
function triggerEvent(element){var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';var bubbles=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;var detail=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{};if(!is$1.element(element)||is$1.empty(type)){return}
var event=new CustomEvent(type,{bubbles:bubbles,detail:Object.assign({},detail,{plyr:this})});element.dispatchEvent(event)}
function unbindListeners(){if(this&&this.eventListeners){this.eventListeners.forEach(function(item){var element=item.element,type=item.type,callback=item.callback,options=item.options;element.removeEventListener(type,callback,options)});this.eventListeners=[]}}
function ready(){var _this3=this;return new Promise(function(resolve){return _this3.ready?setTimeout(resolve,0):on.call(_this3,_this3.elements.container,'ready',resolve)}).then(function(){})}
function wrap(elements,wrapper){var targets=elements.length?elements:[elements];Array.from(targets).reverse().forEach(function(element,index){var child=index>0?wrapper.cloneNode(!0):wrapper;var parent=element.parentNode;var sibling=element.nextSibling;child.appendChild(element);if(sibling){parent.insertBefore(child,sibling)}else{parent.appendChild(child)}})}
function setAttributes(element,attributes){if(!is$1.element(element)||is$1.empty(attributes)){return}
Object.entries(attributes).filter(function(_ref){var _ref2=_slicedToArray(_ref,2),value=_ref2[1];return!is$1.nullOrUndefined(value)}).forEach(function(_ref3){var _ref4=_slicedToArray(_ref3,2),key=_ref4[0],value=_ref4[1];return element.setAttribute(key,value)})}
function createElement(type,attributes,text){var element=document.createElement(type);if(is$1.object(attributes)){setAttributes(element,attributes)}
if(is$1.string(text)){element.innerText=text}
return element}
function insertAfter(element,target){if(!is$1.element(element)||!is$1.element(target)){return}
target.parentNode.insertBefore(element,target.nextSibling)}
function insertElement(type,parent,attributes,text){if(!is$1.element(parent)){return}
parent.appendChild(createElement(type,attributes,text))}
function removeElement(element){if(is$1.nodeList(element)||is$1.array(element)){Array.from(element).forEach(removeElement);return}
if(!is$1.element(element)||!is$1.element(element.parentNode)){return}
element.parentNode.removeChild(element)}
function emptyElement(element){if(!is$1.element(element)){return}
var length=element.childNodes.length;while(length>0){element.removeChild(element.lastChild);length-=1}}
function replaceElement(newChild,oldChild){if(!is$1.element(oldChild)||!is$1.element(oldChild.parentNode)||!is$1.element(newChild)){return null}
oldChild.parentNode.replaceChild(newChild,oldChild);return newChild}
function getAttributesFromSelector(sel,existingAttributes){if(!is$1.string(sel)||is$1.empty(sel)){return{}}
var attributes={};var existing=existingAttributes;sel.split(',').forEach(function(s){var selector=s.trim();var className=selector.replace('.','');var stripped=selector.replace(/[[\]]/g,'');var parts=stripped.split('=');var key=parts[0];var value=parts.length>1?parts[1].replace(/["']/g,''):'';var start=selector.charAt(0);switch(start){case '.':if(is$1.object(existing)&&is$1.string(existing.class)){existing.class+=" ".concat(className)}
attributes.class=className;break;case '#':attributes.id=selector.replace('#','');break;case '[':attributes[key]=value;break;default:break}});return attributes}
function toggleHidden(element,hidden){if(!is$1.element(element)){return}
var hide=hidden;if(!is$1.boolean(hide)){hide=!element.hidden}
if(hide){element.setAttribute('hidden','')}else{element.removeAttribute('hidden')}}
function toggleClass(element,className,force){if(is$1.nodeList(element)){return Array.from(element).map(function(e){return toggleClass(e,className,force)})}
if(is$1.element(element)){var method='toggle';if(typeof force!=='undefined'){method=force?'add':'remove'}
element.classList[method](className);return element.classList.contains(className)}
return!1}
function hasClass(element,className){return is$1.element(element)&&element.classList.contains(className)}
function matches$1(element,selector){function match(){return Array.from(document.querySelectorAll(selector)).includes(this)}
var matches=match;return matches.call(element,selector)}
function getElements(selector){return this.elements.container.querySelectorAll(selector)}
function getElement(selector){return this.elements.container.querySelector(selector)}
function trapFocus(){var element=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var toggle=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;if(!is$1.element(element)){return}
var focusable=getElements.call(this,'button:not(:disabled), input:not(:disabled), [tabindex]');var first=focusable[0];var last=focusable[focusable.length-1];var trap=function trap(event){if(event.key!=='Tab'||event.keyCode!==9){return}
var focused=document.activeElement;if(focused===last&&!event.shiftKey){first.focus();event.preventDefault()}else if(focused===first&&event.shiftKey){last.focus();event.preventDefault()}};toggleListener.call(this,this.elements.container,'keydown',trap,toggle,!1)}
function setFocus(){var element=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var tabFocus=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;if(!is$1.element(element)){return}
element.focus({preventScroll:!0});if(tabFocus){toggleClass(element,this.config.classNames.tabFocus)}}
var transitionEndEvent=function(){var element=document.createElement('span');var events={WebkitTransition:'webkitTransitionEnd',MozTransition:'transitionend',OTransition:'oTransitionEnd otransitionend',transition:'transitionend'};var type=Object.keys(events).find(function(event){return element.style[event]!==undefined});return is$1.string(type)?events[type]:!1}();function repaint(element){setTimeout(function(){try{toggleHidden(element,!0);element.offsetHeight;toggleHidden(element,!1)}catch(e){}},0)}
var browser={isIE:!!document.documentMode,isEdge:window.navigator.userAgent.includes('Edge'),isWebkit:'WebkitAppearance' in document.documentElement.style&&!/Edge/.test(navigator.userAgent),isIPhone:/(iPhone|iPod)/gi.test(navigator.platform),isIos:/(iPad|iPhone|iPod)/gi.test(navigator.platform)};var defaultCodecs={'audio/ogg':'vorbis','audio/wav':'1','video/webm':'vp8, vorbis','video/mp4':'avc1.42E01E, mp4a.40.2','video/ogg':'theora'};var support={audio:'canPlayType' in document.createElement('audio'),video:'canPlayType' in document.createElement('video'),check:function check(type,provider,playsinline){var canPlayInline=browser.isIPhone&&playsinline&&support.playsinline;var api=support[type]||provider!=='html5';var ui=api&&support.rangeInput&&(type!=='video'||!browser.isIPhone||canPlayInline);return{api:api,ui:ui}},playsinline:'playsInline' in document.createElement('video'),mime:function mime(input){if(is$1.empty(input)){return!1}
var _input$split=input.split('/'),_input$split2=_slicedToArray(_input$split,1),mediaType=_input$split2[0];var type=input;if(!this.isHTML5||mediaType!==this.type){return!1}
if(Object.keys(defaultCodecs).includes(type)){type+="; codecs=\"".concat(defaultCodecs[input],"\"")}
try{return Boolean(type&&this.media.canPlayType(type).replace(/no/,''))}catch(e){return!1}},textTracks:'textTracks' in document.createElement('video'),rangeInput:function(){var range=document.createElement('input');range.type='range';return range.type==='range'}(),touch:'ontouchstart' in document.documentElement,transitions:transitionEndEvent!==!1,reducedMotion:'matchMedia' in window&&window.matchMedia('(prefers-reduced-motion)').matches};var html5={getSources:function getSources(){var _this=this;if(!this.isHTML5){return[]}
var sources=Array.from(this.media.querySelectorAll('source'));return sources.filter(function(source){var type=source.getAttribute('type');if(is$1.empty(type)){return!0}
return support.mime.call(_this,type)})},getQualityOptions:function getQualityOptions(){return html5.getSources.call(this).map(function(source){return Number(source.getAttribute('size'))}).filter(Boolean)},extend:function extend(){if(!this.isHTML5){return}
var player=this;Object.defineProperty(player.media,'quality',{get:function get(){var sources=html5.getSources.call(player);var source=sources.find(function(source){return source.getAttribute('src')===player.source});return source&&Number(source.getAttribute('size'))},set:function set(input){var sources=html5.getSources.call(player);var source=sources.find(function(source){return Number(source.getAttribute('size'))===input});if(!source){return}
var _player$media=player.media,currentTime=_player$media.currentTime,paused=_player$media.paused,preload=_player$media.preload,readyState=_player$media.readyState;player.media.src=source.getAttribute('src');if(preload!=='none'||readyState){player.once('loadedmetadata',function(){player.currentTime=currentTime;if(!paused){player.play()}});player.media.load()}
triggerEvent.call(player,player.media,'qualitychange',!1,{quality:input})}})},cancelRequests:function cancelRequests(){if(!this.isHTML5){return}
removeElement(html5.getSources.call(this));this.media.setAttribute('src',this.config.blankVideo);this.media.load()}};function dedupe(array){if(!is$1.array(array)){return array}
return array.filter(function(item,index){return array.indexOf(item)===index})}
function closest(array,value){if(!is$1.array(array)||!array.length){return null}
return array.reduce(function(prev,curr){return Math.abs(curr-value)<Math.abs(prev-value)?curr:prev})}
function cloneDeep(object){return JSON.parse(JSON.stringify(object))}
function getDeep(object,path){return path.split('.').reduce(function(obj,key){return obj&&obj[key]},object)}
function extend(){var target=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};for(var _len=arguments.length,sources=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){sources[_key-1]=arguments[_key]}
if(!sources.length){return target}
var source=sources.shift();if(!is$1.object(source)){return target}
Object.keys(source).forEach(function(key){if(is$1.object(source[key])){if(!Object.keys(target).includes(key)){Object.assign(target,_defineProperty({},key,{}))}
extend(target[key],source[key])}else{Object.assign(target,_defineProperty({},key,source[key]))}});return extend.apply(void 0,[target].concat(sources))}
function generateId(prefix){return"".concat(prefix,"-").concat(Math.floor(Math.random()*10000))}
function format(input){for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}
if(is$1.empty(input)){return input}
return input.toString().replace(/{(\d+)}/g,function(match,i){return args[i].toString()})}
function getPercentage(current,max){if(current===0||max===0||Number.isNaN(current)||Number.isNaN(max)){return 0}
return(current/max*100).toFixed(2)}
function replaceAll(){var input=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var find=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'';var replace=arguments.length>2&&arguments[2]!==undefined?arguments[2]:'';return input.replace(new RegExp(find.toString().replace(/([.*+?^=!:${}()|[\]/\\])/g,'\\$1'),'g'),replace.toString())}
function toTitleCase(){var input=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';return input.toString().replace(/\w\S*/g,function(text){return text.charAt(0).toUpperCase()+text.substr(1).toLowerCase()})}
function toPascalCase(){var input=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var string=input.toString();string=replaceAll(string,'-',' ');string=replaceAll(string,'_',' ');string=toTitleCase(string);return replaceAll(string,' ','')}
function toCamelCase(){var input=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var string=input.toString();string=toPascalCase(string);return string.charAt(0).toLowerCase()+string.slice(1)}
function stripHTML(source){var fragment=document.createDocumentFragment();var element=document.createElement('div');fragment.appendChild(element);element.innerHTML=source;return fragment.firstChild.innerText}
function getHTML(element){var wrapper=document.createElement('div');wrapper.appendChild(element);return wrapper.innerHTML}
var resources={html5:'HTML5',vimeo:'Vimeo',youtube:'YouTube'};var i18n={get:function get(){var key=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var config=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(is$1.empty(key)||is$1.empty(config)){return''}
var string=getDeep(config.i18n,key);if(is$1.empty(string)){if(Object.keys(resources).includes(key)){return resources[key]}
return''}
var replace={'{seektime}':config.seekTime,'{title}':config.title};Object.entries(replace).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];string=replaceAll(string,key,value)});return string}};var Storage=function(){function Storage(player){_classCallCheck(this,Storage);this.enabled=player.config.storage.enabled;this.key=player.config.storage.key}
_createClass(Storage,[{key:"get",value:function get(key){if(!Storage.supported||!this.enabled){return null}
var store=window.localStorage.getItem(this.key);if(is$1.empty(store)){return null}
var json=JSON.parse(store);return is$1.string(key)&&key.length?json[key]:json}},{key:"set",value:function set(object){if(!Storage.supported||!this.enabled){return}
if(!is$1.object(object)){return}
var storage=this.get();if(is$1.empty(storage)){storage={}}
extend(storage,object);window.localStorage.setItem(this.key,JSON.stringify(storage))}}],[{key:"supported",get:function get(){try{if(!('localStorage' in window)){return!1}
var test='___test';window.localStorage.setItem(test,test);window.localStorage.removeItem(test);return!0}catch(e){return!1}}}]);return Storage}();function fetch(url){var responseType=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'text';return new Promise(function(resolve,reject){try{var request=new XMLHttpRequest();if(!('withCredentials' in request)){return}
request.addEventListener('load',function(){if(responseType==='text'){try{resolve(JSON.parse(request.responseText))}catch(e){resolve(request.responseText)}}else{resolve(request.response)}});request.addEventListener('error',function(){throw new Error(request.status)});request.open('GET',url,!0);request.responseType=responseType;request.send()}catch(e){reject(e)}})}
function loadSprite(url,id){if(!is$1.string(url)){return}
var prefix='cache';var hasId=is$1.string(id);var isCached=!1;var exists=function exists(){return document.getElementById(id)!==null};var update=function update(container,data){container.innerHTML=data;if(hasId&&exists()){return}
document.body.insertAdjacentElement('afterbegin',container)};if(!hasId||!exists()){var useStorage=Storage.supported;var container=document.createElement('div');container.setAttribute('hidden','');if(hasId){container.setAttribute('id',id)}
if(useStorage){var cached=window.localStorage.getItem("".concat(prefix,"-").concat(id));isCached=cached!==null;if(isCached){var data=JSON.parse(cached);update(container,data.content)}}
fetch(url).then(function(result){if(is$1.empty(result)){return}
if(useStorage){window.localStorage.setItem("".concat(prefix,"-").concat(id),JSON.stringify({content:result}))}
update(container,result)}).catch(function(){})}}
var getHours=function getHours(value){return Math.trunc(value/60/60%60,10)};var getMinutes=function getMinutes(value){return Math.trunc(value/60%60,10)};var getSeconds=function getSeconds(value){return Math.trunc(value%60,10)};function formatTime(){var time=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var displayHours=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var inverted=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;if(!is$1.number(time)){return formatTime(null,displayHours,inverted)}
var format=function format(value){return"0".concat(value).slice(-2)};var hours=getHours(time);var mins=getMinutes(time);var secs=getSeconds(time);if(displayHours||hours>0){hours="".concat(hours,":")}else{hours=''}
return"".concat(inverted&&time>0?'-':'').concat(hours).concat(format(mins),":").concat(format(secs))}
var controls={getIconUrl:function getIconUrl(){var url=new URL(this.config.iconUrl,window.location);var cors=url.host!==window.location.host||browser.isIE&&!window.svg4everybody;return{url:this.config.iconUrl,cors:cors}},findElements:function findElements(){try{this.elements.controls=getElement.call(this,this.config.selectors.controls.wrapper);this.elements.buttons={play:getElements.call(this,this.config.selectors.buttons.play),pause:getElement.call(this,this.config.selectors.buttons.pause),restart:getElement.call(this,this.config.selectors.buttons.restart),rewind:getElement.call(this,this.config.selectors.buttons.rewind),fastForward:getElement.call(this,this.config.selectors.buttons.fastForward),mute:getElement.call(this,this.config.selectors.buttons.mute),settings:getElement.call(this,this.config.selectors.buttons.settings),captions:getElement.call(this,this.config.selectors.buttons.captions),fullscreen:getElement.call(this,this.config.selectors.buttons.fullscreen)};this.elements.progress=getElement.call(this,this.config.selectors.progress);this.elements.inputs={seek:getElement.call(this,this.config.selectors.inputs.seek),volume:getElement.call(this,this.config.selectors.inputs.volume)};this.elements.display={buffer:getElement.call(this,this.config.selectors.display.buffer),currentTime:getElement.call(this,this.config.selectors.display.currentTime),duration:getElement.call(this,this.config.selectors.display.duration)};if(is$1.element(this.elements.progress)){this.elements.display.seekTooltip=this.elements.progress.querySelector(".".concat(this.config.classNames.tooltip))}
return!0}catch(error){this.debug.warn('It looks like there is a problem with your custom controls HTML',error);this.toggleNativeControls(!0);return!1}},createIcon:function createIcon(type,attributes){var namespace='http://www.w3.org/2000/svg';var iconUrl=controls.getIconUrl.call(this);var iconPath="".concat(!iconUrl.cors?iconUrl.url:'',"#").concat(this.config.iconPrefix);var icon=document.createElementNS(namespace,'svg');setAttributes(icon,extend(attributes,{role:'presentation',focusable:'false'}));var use=document.createElementNS(namespace,'use');var path="".concat(iconPath,"-").concat(type);if('href' in use){use.setAttributeNS('http://www.w3.org/1999/xlink','href',path)}
use.setAttributeNS('http://www.w3.org/1999/xlink','xlink:href',path);icon.appendChild(use);return icon},createLabel:function createLabel(key){var attr=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var text=i18n.get(key,this.config);var attributes=Object.assign({},attr,{class:[attr.class,this.config.classNames.hidden].filter(Boolean).join(' ')});return createElement('span',attributes,text)},createBadge:function createBadge(text){if(is$1.empty(text)){return null}
var badge=createElement('span',{class:this.config.classNames.menu.value});badge.appendChild(createElement('span',{class:this.config.classNames.menu.badge},text));return badge},createButton:function createButton(buttonType,attr){var attributes=Object.assign({},attr);var type=toCamelCase(buttonType);var props={element:'button',toggle:!1,label:null,icon:null,labelPressed:null,iconPressed:null};['element','icon','label'].forEach(function(key){if(Object.keys(attributes).includes(key)){props[key]=attributes[key];delete attributes[key]}});if(props.element==='button'&&!Object.keys(attributes).includes('type')){attributes.type='button'}
if(Object.keys(attributes).includes('class')){if(!attributes.class.includes(this.config.classNames.control)){attributes.class+=" ".concat(this.config.classNames.control)}}else{attributes.class=this.config.classNames.control}
switch(buttonType){case 'play':props.toggle=!0;props.label='play';props.labelPressed='pause';props.icon='play';props.iconPressed='pause';break;case 'mute':props.toggle=!0;props.label='mute';props.labelPressed='unmute';props.icon='volume';props.iconPressed='muted';break;case 'captions':props.toggle=!0;props.label='enableCaptions';props.labelPressed='disableCaptions';props.icon='captions-off';props.iconPressed='captions-on';break;case 'fullscreen':props.toggle=!0;props.label='enterFullscreen';props.labelPressed='exitFullscreen';props.icon='enter-fullscreen';props.iconPressed='exit-fullscreen';break;case 'play-large':attributes.class+=" ".concat(this.config.classNames.control,"--overlaid");type='play';props.label='play';props.icon='play';break;default:if(is$1.empty(props.label)){props.label=type}
if(is$1.empty(props.icon)){props.icon=buttonType}}
var button=createElement(props.element);if(props.toggle){button.appendChild(controls.createIcon.call(this,props.iconPressed,{class:'icon--pressed'}));button.appendChild(controls.createIcon.call(this,props.icon,{class:'icon--not-pressed'}));button.appendChild(controls.createLabel.call(this,props.labelPressed,{class:'label--pressed'}));button.appendChild(controls.createLabel.call(this,props.label,{class:'label--not-pressed'}))}else{button.appendChild(controls.createIcon.call(this,props.icon));button.appendChild(controls.createLabel.call(this,props.label))}
extend(attributes,getAttributesFromSelector(this.config.selectors.buttons[type],attributes));setAttributes(button,attributes);if(type==='play'){if(!is$1.array(this.elements.buttons[type])){this.elements.buttons[type]=[]}
this.elements.buttons[type].push(button)}else{this.elements.buttons[type]=button}
return button},createRange:function createRange(type,attributes){var input=createElement('input',extend(getAttributesFromSelector(this.config.selectors.inputs[type]),{type:'range',min:0,max:100,step:0.01,value:0,autocomplete:'off',role:'slider','aria-label':i18n.get(type,this.config),'aria-valuemin':0,'aria-valuemax':100,'aria-valuenow':0},attributes));this.elements.inputs[type]=input;controls.updateRangeFill.call(this,input);RangeTouch.setup(input);return input},createProgress:function createProgress(type,attributes){var progress=createElement('progress',extend(getAttributesFromSelector(this.config.selectors.display[type]),{min:0,max:100,value:0,role:'progressbar','aria-hidden':!0},attributes));if(type!=='volume'){progress.appendChild(createElement('span',null,'0'));var suffixKey={played:'played',buffer:'buffered'}[type];var suffix=suffixKey?i18n.get(suffixKey,this.config):'';progress.innerText="% ".concat(suffix.toLowerCase())}
this.elements.display[type]=progress;return progress},createTime:function createTime(type){var attributes=getAttributesFromSelector(this.config.selectors.display[type]);var container=createElement('div',extend(attributes,{class:"".concat(this.config.classNames.display.time," ").concat(attributes.class?attributes.class:'').trim(),'aria-label':i18n.get(type,this.config)}),'00:00');this.elements.display[type]=container;return container},bindMenuItemShortcuts:function bindMenuItemShortcuts(menuItem,type){var _this=this;on(menuItem,'keydown keyup',function(event){if(![32,38,39,40].includes(event.which)){return}
event.preventDefault();event.stopPropagation();if(event.type==='keydown'){return}
var isRadioButton=matches$1(menuItem,'[role="menuitemradio"]');if(!isRadioButton&&[32,39].includes(event.which)){controls.showMenuPanel.call(_this,type,!0)}else{var target;if(event.which!==32){if(event.which===40||isRadioButton&&event.which===39){target=menuItem.nextElementSibling;if(!is$1.element(target)){target=menuItem.parentNode.firstElementChild}}else{target=menuItem.previousElementSibling;if(!is$1.element(target)){target=menuItem.parentNode.lastElementChild}}
setFocus.call(_this,target,!0)}}},!1);on(menuItem,'keyup',function(event){if(event.which!==13){return}
controls.focusFirstMenuItem.call(_this,null,!0)})},createMenuItem:function createMenuItem(_ref){var _this2=this;var value=_ref.value,list=_ref.list,type=_ref.type,title=_ref.title,_ref$badge=_ref.badge,badge=_ref$badge===void 0?null:_ref$badge,_ref$checked=_ref.checked,checked=_ref$checked===void 0?!1:_ref$checked;var attributes=getAttributesFromSelector(this.config.selectors.inputs[type]);var menuItem=createElement('button',extend(attributes,{type:'button',role:'menuitemradio',class:"".concat(this.config.classNames.control," ").concat(attributes.class?attributes.class:'').trim(),'aria-checked':checked,value:value}));var flex=createElement('span');flex.innerHTML=title;if(is$1.element(badge)){flex.appendChild(badge)}
menuItem.appendChild(flex);Object.defineProperty(menuItem,'checked',{enumerable:!0,get:function get(){return menuItem.getAttribute('aria-checked')==='true'},set:function set(checked){if(checked){Array.from(menuItem.parentNode.children).filter(function(node){return matches$1(node,'[role="menuitemradio"]')}).forEach(function(node){return node.setAttribute('aria-checked','false')})}
menuItem.setAttribute('aria-checked',checked?'true':'false')}});this.listeners.bind(menuItem,'click keyup',function(event){if(is$1.keyboardEvent(event)&&event.which!==32){return}
event.preventDefault();event.stopPropagation();menuItem.checked=!0;switch(type){case 'language':_this2.currentTrack=Number(value);break;case 'quality':_this2.quality=value;break;case 'speed':_this2.speed=parseFloat(value);break;default:break}
controls.showMenuPanel.call(_this2,'home',is$1.keyboardEvent(event))},type,!1);controls.bindMenuItemShortcuts.call(this,menuItem,type);list.appendChild(menuItem)},formatTime:function formatTime$1(){var time=arguments.length>0&&arguments[0]!==undefined?arguments[0]:0;var inverted=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;if(!is$1.number(time)){return time}
var forceHours=getHours(this.duration)>0;return formatTime(time,forceHours,inverted)},updateTimeDisplay:function updateTimeDisplay(){var target=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;var time=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;var inverted=arguments.length>2&&arguments[2]!==undefined?arguments[2]:!1;if(!is$1.element(target)||!is$1.number(time)){return}
target.innerText=controls.formatTime(time,inverted)},updateVolume:function updateVolume(){if(!this.supported.ui){return}
if(is$1.element(this.elements.inputs.volume)){controls.setRange.call(this,this.elements.inputs.volume,this.muted?0:this.volume)}
if(is$1.element(this.elements.buttons.mute)){this.elements.buttons.mute.pressed=this.muted||this.volume===0}},setRange:function setRange(target){var value=arguments.length>1&&arguments[1]!==undefined?arguments[1]:0;if(!is$1.element(target)){return}
target.value=value;controls.updateRangeFill.call(this,target)},updateProgress:function updateProgress(event){var _this3=this;if(!this.supported.ui||!is$1.event(event)){return}
var value=0;var setProgress=function setProgress(target,input){var value=is$1.number(input)?input:0;var progress=is$1.element(target)?target:_this3.elements.display.buffer;if(is$1.element(progress)){progress.value=value;var label=progress.getElementsByTagName('span')[0];if(is$1.element(label)){label.childNodes[0].nodeValue=value}}};if(event){switch(event.type){case 'timeupdate':case 'seeking':case 'seeked':value=getPercentage(this.currentTime,this.duration);if(event.type==='timeupdate'){controls.setRange.call(this,this.elements.inputs.seek,value)}
break;case 'playing':case 'progress':setProgress(this.elements.display.buffer,this.buffered*100);break;default:break}}},updateRangeFill:function updateRangeFill(target){var range=is$1.event(target)?target.target:target;if(!is$1.element(range)||range.getAttribute('type')!=='range'){return}
if(matches$1(range,this.config.selectors.inputs.seek)){range.setAttribute('aria-valuenow',this.currentTime);var currentTime=controls.formatTime(this.currentTime);var duration=controls.formatTime(this.duration);var format=i18n.get('seekLabel',this.config);range.setAttribute('aria-valuetext',format.replace('{currentTime}',currentTime).replace('{duration}',duration))}else if(matches$1(range,this.config.selectors.inputs.volume)){var percent=range.value*100;range.setAttribute('aria-valuenow',percent);range.setAttribute('aria-valuetext',"".concat(percent.toFixed(1),"%"))}else{range.setAttribute('aria-valuenow',range.value)}
if(!browser.isWebkit){return}
range.style.setProperty('--value',"".concat(range.value/range.max*100,"%"))},updateSeekTooltip:function updateSeekTooltip(event){var _this4=this;if(!this.config.tooltips.seek||!is$1.element(this.elements.inputs.seek)||!is$1.element(this.elements.display.seekTooltip)||this.duration===0){return}
var percent=0;var clientRect=this.elements.progress.getBoundingClientRect();var visible="".concat(this.config.classNames.tooltip,"--visible");var toggle=function toggle(_toggle){toggleClass(_this4.elements.display.seekTooltip,visible,_toggle)};if(this.touch){toggle(!1);return}
if(is$1.event(event)){percent=100/clientRect.width*(event.pageX-clientRect.left)}else if(hasClass(this.elements.display.seekTooltip,visible)){percent=parseFloat(this.elements.display.seekTooltip.style.left,10)}else{return}
if(percent<0){percent=0}else if(percent>100){percent=100}
controls.updateTimeDisplay.call(this,this.elements.display.seekTooltip,this.duration/100*percent);this.elements.display.seekTooltip.style.left="".concat(percent,"%");if(is$1.event(event)&&['mouseenter','mouseleave'].includes(event.type)){toggle(event.type==='mouseenter')}},timeUpdate:function timeUpdate(event){var invert=!is$1.element(this.elements.display.duration)&&this.config.invertTime;controls.updateTimeDisplay.call(this,this.elements.display.currentTime,invert?this.duration-this.currentTime:this.currentTime,invert);if(event&&event.type==='timeupdate'&&this.media.seeking){return}
controls.updateProgress.call(this,event)},durationUpdate:function durationUpdate(){if(!this.supported.ui||!this.config.invertTime&&this.currentTime){return}
if(this.duration>=Math.pow(2,32)){toggleHidden(this.elements.display.currentTime,!0);toggleHidden(this.elements.progress,!0);return}
if(is$1.element(this.elements.inputs.seek)){this.elements.inputs.seek.setAttribute('aria-valuemax',this.duration)}
var hasDuration=is$1.element(this.elements.display.duration);if(!hasDuration&&this.config.displayDuration&&this.paused){controls.updateTimeDisplay.call(this,this.elements.display.currentTime,this.duration)}
if(hasDuration){controls.updateTimeDisplay.call(this,this.elements.display.duration,this.duration)}
controls.updateSeekTooltip.call(this)},toggleMenuButton:function toggleMenuButton(setting,toggle){toggleHidden(this.elements.settings.buttons[setting],!toggle)},updateSetting:function updateSetting(setting,container,input){var pane=this.elements.settings.panels[setting];var value=null;var list=container;if(setting==='captions'){value=this.currentTrack}else{value=!is$1.empty(input)?input:this[setting];if(is$1.empty(value)){value=this.config[setting].default}
if(!is$1.empty(this.options[setting])&&!this.options[setting].includes(value)){this.debug.warn("Unsupported value of '".concat(value,"' for ").concat(setting));return}
if(!this.config[setting].options.includes(value)){this.debug.warn("Disabled value of '".concat(value,"' for ").concat(setting));return}}
if(!is$1.element(list)){list=pane&&pane.querySelector('[role="menu"]')}
if(!is$1.element(list)){return}
var label=this.elements.settings.buttons[setting].querySelector(".".concat(this.config.classNames.menu.value));label.innerHTML=controls.getLabel.call(this,setting,value);var target=list&&list.querySelector("[value=\"".concat(value,"\"]"));if(is$1.element(target)){target.checked=!0}},getLabel:function getLabel(setting,value){switch(setting){case 'speed':return value===1?i18n.get('normal',this.config):"".concat(value,"&times;");case 'quality':if(is$1.number(value)){var label=i18n.get("qualityLabel.".concat(value),this.config);if(!label.length){return"".concat(value,"p")}
return label}
return toTitleCase(value);case 'captions':return captions.getLabel.call(this);default:return null}},setQualityMenu:function setQualityMenu(options){var _this5=this;if(!is$1.element(this.elements.settings.panels.quality)){return}
var type='quality';var list=this.elements.settings.panels.quality.querySelector('[role="menu"]');if(is$1.array(options)){this.options.quality=dedupe(options).filter(function(quality){return _this5.config.quality.options.includes(quality)})}
var toggle=!is$1.empty(this.options.quality)&&this.options.quality.length>1;controls.toggleMenuButton.call(this,type,toggle);emptyElement(list);controls.checkMenu.call(this);if(!toggle){return}
var getBadge=function getBadge(quality){var label=i18n.get("qualityBadge.".concat(quality),_this5.config);if(!label.length){return null}
return controls.createBadge.call(_this5,label)};this.options.quality.sort(function(a,b){var sorting=_this5.config.quality.options;return sorting.indexOf(a)>sorting.indexOf(b)?1:-1}).forEach(function(quality){controls.createMenuItem.call(_this5,{value:quality,list:list,type:type,title:controls.getLabel.call(_this5,'quality',quality),badge:getBadge(quality)})});controls.updateSetting.call(this,type,list)},setCaptionsMenu:function setCaptionsMenu(){var _this6=this;if(!is$1.element(this.elements.settings.panels.captions)){return}
var type='captions';var list=this.elements.settings.panels.captions.querySelector('[role="menu"]');var tracks=captions.getTracks.call(this);var toggle=Boolean(tracks.length);controls.toggleMenuButton.call(this,type,toggle);emptyElement(list);controls.checkMenu.call(this);if(!toggle){return}
var options=tracks.map(function(track,value){return{value:value,checked:_this6.captions.toggled&&_this6.currentTrack===value,title:captions.getLabel.call(_this6,track),badge:track.language&&controls.createBadge.call(_this6,track.language.toUpperCase()),list:list,type:'language'}});options.unshift({value:-1,checked:!this.captions.toggled,title:i18n.get('disabled',this.config),list:list,type:'language'});options.forEach(controls.createMenuItem.bind(this));controls.updateSetting.call(this,type,list)},setSpeedMenu:function setSpeedMenu(options){var _this7=this;if(!is$1.element(this.elements.settings.panels.speed)){return}
var type='speed';var list=this.elements.settings.panels.speed.querySelector('[role="menu"]');if(is$1.array(options)){this.options.speed=options}else if(this.isHTML5||this.isVimeo){this.options.speed=[0.5,0.75,1,1.25,1.5,1.75,2]}
this.options.speed=this.options.speed.filter(function(speed){return _this7.config.speed.options.includes(speed)});var toggle=!is$1.empty(this.options.speed)&&this.options.speed.length>1;controls.toggleMenuButton.call(this,type,toggle);emptyElement(list);controls.checkMenu.call(this);if(!toggle){return}
this.options.speed.forEach(function(speed){controls.createMenuItem.call(_this7,{value:speed,list:list,type:type,title:controls.getLabel.call(_this7,'speed',speed)})});controls.updateSetting.call(this,type,list)},checkMenu:function checkMenu(){var buttons=this.elements.settings.buttons;var visible=!is$1.empty(buttons)&&Object.values(buttons).some(function(button){return!button.hidden});toggleHidden(this.elements.settings.menu,!visible)},focusFirstMenuItem:function focusFirstMenuItem(pane){var tabFocus=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;if(this.elements.settings.popup.hidden){return}
var target=pane;if(!is$1.element(target)){target=Object.values(this.elements.settings.panels).find(function(pane){return!pane.hidden})}
var firstItem=target.querySelector('[role^="menuitem"]');setFocus.call(this,firstItem,tabFocus)},toggleMenu:function toggleMenu(input){var popup=this.elements.settings.popup;var button=this.elements.buttons.settings;if(!is$1.element(popup)||!is$1.element(button)){return}
var hidden=popup.hidden;var show=hidden;if(is$1.boolean(input)){show=input}else if(is$1.keyboardEvent(input)&&input.which===27){show=!1}else if(is$1.event(input)){var isMenuItem=popup.contains(input.target);if(isMenuItem||!isMenuItem&&input.target!==button&&show){return}}
button.setAttribute('aria-expanded',show);toggleHidden(popup,!show);toggleClass(this.elements.container,this.config.classNames.menu.open,show);if(show&&is$1.keyboardEvent(input)){controls.focusFirstMenuItem.call(this,null,!0)}else if(!show&&!hidden){setFocus.call(this,button,is$1.keyboardEvent(input))}},getMenuSize:function getMenuSize(tab){var clone=tab.cloneNode(!0);clone.style.position='absolute';clone.style.opacity=0;clone.removeAttribute('hidden');tab.parentNode.appendChild(clone);var width=clone.scrollWidth;var height=clone.scrollHeight;removeElement(clone);return{width:width,height:height}},showMenuPanel:function showMenuPanel(){var _this8=this;var type=arguments.length>0&&arguments[0]!==undefined?arguments[0]:'';var tabFocus=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var target=document.getElementById("plyr-settings-".concat(this.id,"-").concat(type));if(!is$1.element(target)){return}
var container=target.parentNode;var current=Array.from(container.children).find(function(node){return!node.hidden});if(support.transitions&&!support.reducedMotion){container.style.width="".concat(current.scrollWidth,"px");container.style.height="".concat(current.scrollHeight,"px");var size=controls.getMenuSize.call(this,target);var restore=function restore(event){if(event.target!==container||!['width','height'].includes(event.propertyName)){return}
container.style.width='';container.style.height='';off.call(_this8,container,transitionEndEvent,restore)};on.call(this,container,transitionEndEvent,restore);container.style.width="".concat(size.width,"px");container.style.height="".concat(size.height,"px")}
toggleHidden(current,!0);toggleHidden(target,!1);controls.focusFirstMenuItem.call(this,target,tabFocus)},create:function create(data){var _this9=this;var container=createElement('div',getAttributesFromSelector(this.config.selectors.controls.wrapper));if(this.config.controls.includes('restart')){container.appendChild(controls.createButton.call(this,'restart'))}
if(this.config.controls.includes('rewind')){container.appendChild(controls.createButton.call(this,'rewind'))}
if(this.config.controls.includes('play')){container.appendChild(controls.createButton.call(this,'play'))}
if(this.config.controls.includes('fast-forward')){container.appendChild(controls.createButton.call(this,'fast-forward'))}
if(this.config.controls.includes('progress')){var progress=createElement('div',getAttributesFromSelector(this.config.selectors.progress));progress.appendChild(controls.createRange.call(this,'seek',{id:"plyr-seek-".concat(data.id)}));progress.appendChild(controls.createProgress.call(this,'buffer'));if(this.config.tooltips.seek){var tooltip=createElement('span',{class:this.config.classNames.tooltip},'00:00');progress.appendChild(tooltip);this.elements.display.seekTooltip=tooltip}
this.elements.progress=progress;container.appendChild(this.elements.progress)}
if(this.config.controls.includes('current-time')){container.appendChild(controls.createTime.call(this,'currentTime'))}
if(this.config.controls.includes('duration')){container.appendChild(controls.createTime.call(this,'duration'))}
if(this.config.controls.includes('mute')||this.config.controls.includes('volume')){var volume=createElement('div',{class:'plyr__volume'});if(this.config.controls.includes('mute')){volume.appendChild(controls.createButton.call(this,'mute'))}
if(this.config.controls.includes('volume')){var attributes={max:1,step:0.05,value:this.config.volume};volume.appendChild(controls.createRange.call(this,'volume',extend(attributes,{id:"plyr-volume-".concat(data.id)})));this.elements.volume=volume}
container.appendChild(volume)}
if(this.config.controls.includes('captions')){container.appendChild(controls.createButton.call(this,'captions'))}
if(this.config.controls.includes('settings')&&!is$1.empty(this.config.settings)){var control=createElement('div',{class:'plyr__menu',hidden:''});control.appendChild(controls.createButton.call(this,'settings',{'aria-haspopup':!0,'aria-controls':"plyr-settings-".concat(data.id),'aria-expanded':!1}));var popup=createElement('div',{class:'plyr__menu__container',id:"plyr-settings-".concat(data.id),hidden:''});var inner=createElement('div');var home=createElement('div',{id:"plyr-settings-".concat(data.id,"-home")});var menu=createElement('div',{role:'menu'});home.appendChild(menu);inner.appendChild(home);this.elements.settings.panels.home=home;this.config.settings.forEach(function(type){var menuItem=createElement('button',extend(getAttributesFromSelector(_this9.config.selectors.buttons.settings),{type:'button',class:"".concat(_this9.config.classNames.control," ").concat(_this9.config.classNames.control,"--forward"),role:'menuitem','aria-haspopup':!0,hidden:''}));controls.bindMenuItemShortcuts.call(_this9,menuItem,type);on(menuItem,'click',function(){controls.showMenuPanel.call(_this9,type,!1)});var flex=createElement('span',null,i18n.get(type,_this9.config));var value=createElement('span',{class:_this9.config.classNames.menu.value});value.innerHTML=data[type];flex.appendChild(value);menuItem.appendChild(flex);menu.appendChild(menuItem);var pane=createElement('div',{id:"plyr-settings-".concat(data.id,"-").concat(type),hidden:''});var backButton=createElement('button',{type:'button',class:"".concat(_this9.config.classNames.control," ").concat(_this9.config.classNames.control,"--back")});backButton.appendChild(createElement('span',{'aria-hidden':!0},i18n.get(type,_this9.config)));backButton.appendChild(createElement('span',{class:_this9.config.classNames.hidden},i18n.get('menuBack',_this9.config)));on(pane,'keydown',function(event){if(event.which!==37){return}
event.preventDefault();event.stopPropagation();controls.showMenuPanel.call(_this9,'home',!0)},!1);on(backButton,'click',function(){controls.showMenuPanel.call(_this9,'home',!1)});pane.appendChild(backButton);pane.appendChild(createElement('div',{role:'menu'}));inner.appendChild(pane);_this9.elements.settings.buttons[type]=menuItem;_this9.elements.settings.panels[type]=pane});popup.appendChild(inner);control.appendChild(popup);container.appendChild(control);this.elements.settings.popup=popup;this.elements.settings.menu=control}
if(this.config.controls.includes('fullscreen')){container.appendChild(controls.createButton.call(this,'fullscreen'))}
if(this.config.controls.includes('play-large')){this.elements.container.appendChild(controls.createButton.call(this,'play-large'))}
this.elements.controls=container;if(this.isHTML5){controls.setQualityMenu.call(this,html5.getQualityOptions.call(this))}
controls.setSpeedMenu.call(this);return container},inject:function inject(){var _this10=this;if(this.config.loadSprite){var icon=controls.getIconUrl.call(this);if(icon.cors){loadSprite(icon.url,'sprite-plyr')}}
this.id=Math.floor(Math.random()*10000);var container=null;this.elements.controls=null;var props={id:this.id,seektime:this.config.seekTime,title:this.config.title};var update=!0;if(is$1.function(this.config.controls)){this.config.controls=this.config.controls.call(this,props)}
if(!this.config.controls){this.config.controls=[]}
if(is$1.element(this.config.controls)||is$1.string(this.config.controls)){container=this.config.controls}else{container=controls.create.call(this,{id:this.id,seektime:this.config.seekTime,speed:this.speed,quality:this.quality,captions:captions.getLabel.call(this)});update=!1}
var replace=function replace(input){var result=input;Object.entries(props).forEach(function(_ref2){var _ref3=_slicedToArray(_ref2,2),key=_ref3[0],value=_ref3[1];result=replaceAll(result,"{".concat(key,"}"),value)});return result};if(update){if(is$1.string(this.config.controls)){container=replace(container)}else if(is$1.element(container)){container.innerHTML=replace(container.innerHTML)}}
var target;if(is$1.string(this.config.selectors.controls.container)){target=document.querySelector(this.config.selectors.controls.container)}
if(!is$1.element(target)){target=this.elements.container}
var insertMethod=is$1.element(container)?'insertAdjacentElement':'insertAdjacentHTML';target[insertMethod]('afterbegin',container);if(!is$1.element(this.elements.controls)){controls.findElements.call(this)}
if(!is$1.empty(this.elements.buttons)){var addProperty=function addProperty(button){var className=_this10.config.classNames.controlPressed;Object.defineProperty(button,'pressed',{enumerable:!0,get:function get(){return hasClass(button,className)},set:function set(){var pressed=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;toggleClass(button,className,pressed)}})};Object.values(this.elements.buttons).filter(Boolean).forEach(function(button){if(is$1.array(button)||is$1.nodeList(button)){Array.from(button).filter(Boolean).forEach(addProperty)}else{addProperty(button)}})}
if(browser.isEdge){repaint(target)}
if(this.config.tooltips.controls){var _this$config=this.config,classNames=_this$config.classNames,selectors=_this$config.selectors;var selector="".concat(selectors.controls.wrapper," ").concat(selectors.labels," .").concat(classNames.hidden);var labels=getElements.call(this,selector);Array.from(labels).forEach(function(label){toggleClass(label,_this10.config.classNames.hidden,!1);toggleClass(label,_this10.config.classNames.tooltip,!0)})}}};function parseUrl$2(input){var safe=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;var url=input;if(safe){var parser=document.createElement('a');parser.href=url;url=parser.href}
try{return new URL(url)}catch(e){return null}}
function buildUrlParams(input){var params=new URLSearchParams();if(is$1.object(input)){Object.entries(input).forEach(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];params.set(key,value)})}
return params}
var captions={setup:function setup(){if(!this.supported.ui){return}
if(!this.isVideo||this.isYouTube||this.isHTML5&&!support.textTracks){if(is$1.array(this.config.controls)&&this.config.controls.includes('settings')&&this.config.settings.includes('captions')){controls.setCaptionsMenu.call(this)}
return}
if(!is$1.element(this.elements.captions)){this.elements.captions=createElement('div',getAttributesFromSelector(this.config.selectors.captions));insertAfter(this.elements.captions,this.elements.wrapper)}
if(browser.isIE&&window.URL){var elements=this.media.querySelectorAll('track');Array.from(elements).forEach(function(track){var src=track.getAttribute('src');var url=parseUrl$2(src);if(url!==null&&url.hostname!==window.location.href.hostname&&['http:','https:'].includes(url.protocol)){fetch(src,'blob').then(function(blob){track.setAttribute('src',window.URL.createObjectURL(blob))}).catch(function(){removeElement(track)})}})}
var browserLanguages=navigator.languages||[navigator.language||navigator.userLanguage||'en'];var languages=dedupe(browserLanguages.map(function(language){return language.split('-')[0]}));var language=(this.storage.get('language')||this.config.captions.language||'auto').toLowerCase();if(language==='auto'){var _languages=_slicedToArray(languages,1);language=_languages[0]}
var active=this.storage.get('captions');if(!is$1.boolean(active)){active=this.config.captions.active}
Object.assign(this.captions,{toggled:!1,active:active,language:language,languages:languages});if(this.isHTML5){var trackEvents=this.config.captions.update?'addtrack removetrack':'removetrack';on.call(this,this.media.textTracks,trackEvents,captions.update.bind(this))}
setTimeout(captions.update.bind(this),0)},update:function update(){var _this=this;var tracks=captions.getTracks.call(this,!0);var _this$captions=this.captions,active=_this$captions.active,language=_this$captions.language,meta=_this$captions.meta,currentTrackNode=_this$captions.currentTrackNode;var languageExists=Boolean(tracks.find(function(track){return track.language===language}));if(this.isHTML5&&this.isVideo){tracks.filter(function(track){return!meta.get(track)}).forEach(function(track){meta.set(track,{default:track.mode==='showing'});track.mode='hidden';on.call(_this,track,'cuechange',function(){return captions.updateCues.call(_this)})})}
if(languageExists&&this.language!==language||!tracks.includes(currentTrackNode)){captions.setLanguage.call(this,language);captions.toggle.call(this,active&&languageExists)}
toggleClass(this.elements.container,this.config.classNames.captions.enabled,!is$1.empty(tracks));if((this.config.controls||[]).includes('settings')&&this.config.settings.includes('captions')){controls.setCaptionsMenu.call(this)}},toggle:function toggle(input){var passive=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;if(!this.supported.ui){return}
var toggled=this.captions.toggled;var activeClass=this.config.classNames.captions.active;var active=is$1.nullOrUndefined(input)?!toggled:input;if(active!==toggled){if(!passive){this.captions.active=active;this.storage.set({captions:active})}
if(!this.language&&active&&!passive){var tracks=captions.getTracks.call(this);var track=captions.findTrack.call(this,[this.captions.language].concat(_toConsumableArray(this.captions.languages)),!0);this.captions.language=track.language;captions.set.call(this,tracks.indexOf(track));return}
if(this.elements.buttons.captions){this.elements.buttons.captions.pressed=active}
toggleClass(this.elements.container,activeClass,active);this.captions.toggled=active;controls.updateSetting.call(this,'captions');triggerEvent.call(this,this.media,active?'captionsenabled':'captionsdisabled')}},set:function set(index){var passive=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;var tracks=captions.getTracks.call(this);if(index===-1){captions.toggle.call(this,!1,passive);return}
if(!is$1.number(index)){this.debug.warn('Invalid caption argument',index);return}
if(!(index in tracks)){this.debug.warn('Track not found',index);return}
if(this.captions.currentTrack!==index){this.captions.currentTrack=index;var track=tracks[index];var _ref=track||{},language=_ref.language;this.captions.currentTrackNode=track;controls.updateSetting.call(this,'captions');if(!passive){this.captions.language=language;this.storage.set({language:language})}
if(this.isVimeo){this.embed.enableTextTrack(language)}
triggerEvent.call(this,this.media,'languagechange')}
captions.toggle.call(this,!0,passive);if(this.isHTML5&&this.isVideo){captions.updateCues.call(this)}},setLanguage:function setLanguage(input){var passive=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;if(!is$1.string(input)){this.debug.warn('Invalid language argument',input);return}
var language=input.toLowerCase();this.captions.language=language;var tracks=captions.getTracks.call(this);var track=captions.findTrack.call(this,[language]);captions.set.call(this,tracks.indexOf(track),passive)},getTracks:function getTracks(){var _this2=this;var update=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;var tracks=Array.from((this.media||{}).textTracks||[]);return tracks.filter(function(track){return!_this2.isHTML5||update||_this2.captions.meta.has(track)}).filter(function(track){return['captions','subtitles'].includes(track.kind)})},findTrack:function findTrack(languages){var _this3=this;var force=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;var tracks=captions.getTracks.call(this);var sortIsDefault=function sortIsDefault(track){return Number((_this3.captions.meta.get(track)||{}).default)};var sorted=Array.from(tracks).sort(function(a,b){return sortIsDefault(b)-sortIsDefault(a)});var track;languages.every(function(language){track=sorted.find(function(track){return track.language===language});return!track});return track||(force?sorted[0]:undefined)},getCurrentTrack:function getCurrentTrack(){return captions.getTracks.call(this)[this.currentTrack]},getLabel:function getLabel(track){var currentTrack=track;if(!is$1.track(currentTrack)&&support.textTracks&&this.captions.toggled){currentTrack=captions.getCurrentTrack.call(this)}
if(is$1.track(currentTrack)){if(!is$1.empty(currentTrack.label)){return currentTrack.label}
if(!is$1.empty(currentTrack.language)){return track.language.toUpperCase()}
return i18n.get('enabled',this.config)}
return i18n.get('disabled',this.config)},updateCues:function updateCues(input){if(!this.supported.ui){return}
if(!is$1.element(this.elements.captions)){this.debug.warn('No captions element to render to');return}
if(!is$1.nullOrUndefined(input)&&!Array.isArray(input)){this.debug.warn('updateCues: Invalid input',input);return}
var cues=input;if(!cues){var track=captions.getCurrentTrack.call(this);cues=Array.from((track||{}).activeCues||[]).map(function(cue){return cue.getCueAsHTML()}).map(getHTML)}
var content=cues.map(function(cueText){return cueText.trim()}).join('\n');var changed=content!==this.elements.captions.innerHTML;if(changed){emptyElement(this.elements.captions);var caption=createElement('span',getAttributesFromSelector(this.config.selectors.caption));caption.innerHTML=content;this.elements.captions.appendChild(caption);triggerEvent.call(this,this.media,'cuechange')}}};var defaults$1={enabled:!0,title:'',debug:!1,autoplay:!1,autopause:!0,playsinline:!0,seekTime:10,volume:1,muted:!1,duration:null,displayDuration:!0,invertTime:!0,toggleInvert:!0,ratio:'16:9',clickToPlay:!0,hideControls:!0,resetOnEnd:!1,disableContextMenu:!0,loadSprite:!0,iconPrefix:'plyr',iconUrl:'https://cdn.plyr.io/3.5.2/plyr.svg',blankVideo:'https://cdn.plyr.io/static/blank.mp4',quality:{default:576,options:[4320,2880,2160,1440,1080,720,576,480,360,240]},loop:{active:!1},speed:{selected:1,options:[0.5,0.75,1,1.25,1.5,1.75,2]},keyboard:{focused:!0,global:!1},tooltips:{controls:!1,seek:!0},captions:{active:!1,language:'auto',update:!1},fullscreen:{enabled:!0,fallback:!0,iosNative:!1},storage:{enabled:!0,key:'plyr'},controls:['play-large','play','progress','current-time','mute','volume','captions','settings','fullscreen'],settings:['captions','quality','speed'],i18n:{restart:'Restart',rewind:'Rewind {seektime}s',play:'Play',pause:'Pause',fastForward:'Forward {seektime}s',seek:'Seek',seekLabel:'{currentTime} of {duration}',played:'Played',buffered:'Buffered',currentTime:'Current time',duration:'Duration',volume:'Volume',mute:'Táº¯t Ã¢m thanh',unmute:'Báº­t Ã¢m thanh',enableCaptions:"Báº­t phá»¥ Ä‘á»",disableCaptions:"Táº¯t phá»¥ Ä‘á»",enterFullscreen:"ToÃ n mÃ n hÃ¬nh",exitFullscreen:"ThoÃ¡t",frameTitle:'Player for {title}',captions:"Phá»¥ Ä‘á»",settings:"CÃ i Ä‘áº·t",speed:"Tá»‘c Ä‘á»™",quality:"Cháº¥t lÆ°á»£ng",menuBack:'Go back to previous menu',normal:'BÃ¬nh thÆ°á»ng',loop:'Loop',start:'Start',end:'End',all:'All',reset:'Reset',disabled:'Disabled',enabled:'Enabled',advertisement:'Quáº£ng cÃ¡o',qualityBadge:{2160:'4K',1440:'HD',1080:'HD',720:'HD',576:'SD',480:'SD'}},urls:{vimeo:{sdk:'https://player.vimeo.com/api/player.js',iframe:'https://player.vimeo.com/video/{0}?{1}',api:'https://vimeo.com/api/v2/video/{0}.json'},youtube:{sdk:'https://www.youtube.com/iframe_api',api:'https://www.googleapis.com/youtube/v3/videos?id={0}&key={1}&fields=items(snippet(title))&part=snippet'},googleIMA:{sdk:'https://imasdk.googleapis.com/js/sdkloader/ima3.js'}},listeners:{seek:null,play:null,pause:null,restart:null,rewind:null,fastForward:null,mute:null,volume:null,captions:null,fullscreen:null,speed:null,quality:null,loop:null,language:null},events:['ended','progress','stalled','playing','waiting','canplay','canplaythrough','loadstart','loadeddata','loadedmetadata','timeupdate','volumechange','play','pause','error','seeking','seeked','emptied','ratechange','cuechange','enterfullscreen','exitfullscreen','captionsenabled','captionsdisabled','languagechange','controlshidden','controlsshown','ready','statechange','qualitychange','adsloaded','adscontentpause','adscontentresume','adstarted','adsmidpoint','adscomplete','adsallcomplete','adsimpression','adsclick'],selectors:{editable:'input, textarea, select, [contenteditable]',container:'.plyr',controls:{container:null,wrapper:'.plyr__controls'},labels:'[data-plyr]',buttons:{play:'[data-plyr="play"]',pause:'[data-plyr="pause"]',restart:'[data-plyr="restart"]',rewind:'[data-plyr="rewind"]',fastForward:'[data-plyr="fast-forward"]',mute:'[data-plyr="mute"]',captions:'[data-plyr="captions"]',fullscreen:'[data-plyr="fullscreen"]',settings:'[data-plyr="settings"]',loop:'[data-plyr="loop"]'},inputs:{seek:'[data-plyr="seek"]',volume:'[data-plyr="volume"]',speed:'[data-plyr="speed"]',language:'[data-plyr="language"]',quality:'[data-plyr="quality"]'},display:{currentTime:'.plyr__time--current',duration:'.plyr__time--duration',buffer:'.plyr__progress__buffer',loop:'.plyr__progress__loop',volume:'.plyr__volume--display'},progress:'.plyr__progress',captions:'.plyr__captions',caption:'.plyr__caption',menu:{quality:'.js-plyr__menu__list--quality'}},classNames:{type:'plyr--{0}',provider:'plyr--{0}',video:'plyr__video-wrapper',embed:'plyr__video-embed',embedContainer:'plyr__video-embed__container',poster:'plyr__poster',posterEnabled:'plyr__poster-enabled',ads:'plyr__ads',control:'plyr__control',controlPressed:'plyr__control--pressed',playing:'plyr--playing',paused:'plyr--paused',stopped:'plyr--stopped',loading:'plyr--loading',hover:'plyr--hover',tooltip:'plyr__tooltip',cues:'plyr__cues',hidden:'plyr__sr-only',hideControls:'plyr--hide-controls',isIos:'plyr--is-ios',isTouch:'plyr--is-touch',uiSupported:'plyr--full-ui',noTransition:'plyr--no-transition',display:{time:'plyr__time'},menu:{value:'plyr__menu__value',badge:'plyr__badge',open:'plyr--menu-open'},captions:{enabled:'plyr--captions-enabled',active:'plyr--captions-active'},fullscreen:{enabled:'plyr--fullscreen-enabled',fallback:'plyr--fullscreen-fallback'},tabFocus:'plyr__tab-focus',},attributes:{embed:{provider:'data-plyr-provider',id:'data-plyr-embed-id'}},keys:{google:null},ads:{enabled:!1,publisherId:'',tagUrl:''},vimeo:{byline:!1,portrait:!1,title:!1,speed:!0,transparent:!1},youtube:{noCookie:!1,rel:0,showinfo:0,iv_load_policy:3,modestbranding:1}};var providers={html5:'html5',youtube:'youtube',vimeo:'vimeo'};var types={audio:'audio',video:'video'};function getProviderByUrl(url){if(/^(https?:\/\/)?(www\.)?(youtube\.com|youtube-nocookie\.com|youtu\.?be)\/.+$/.test(url)){return providers.youtube}
if(/^https?:\/\/player.vimeo.com\/video\/\d{0,9}(?=\b|\/)/.test(url)){return providers.vimeo}
return null}
var noop=function noop(){};var Console=function(){function Console(){var enabled=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;_classCallCheck(this,Console);this.enabled=window.console&&enabled}
_createClass(Console,[{key:"log",get:function get(){return this.enabled?Function.prototype.bind.call(console.log,console):noop}},{key:"warn",get:function get(){return this.enabled?Function.prototype.bind.call(console.warn,console):noop}},{key:"error",get:function get(){return this.enabled?Function.prototype.bind.call(console.error,console):noop}}]);return Console}();function onChange(){if(!this.enabled){return}
var button=this.player.elements.buttons.fullscreen;if(is$1.element(button)){button.pressed=this.active}
triggerEvent.call(this.player,this.target,this.active?'enterfullscreen':'exitfullscreen',!0);if(!browser.isIos){trapFocus.call(this.player,this.target,this.active)}}
function toggleFallback(){var _this=this;var toggle=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(toggle){this.scrollPosition={x:window.scrollX||0,y:window.scrollY||0}}else{window.scrollTo(this.scrollPosition.x,this.scrollPosition.y)}
document.body.style.overflow=toggle?'hidden':'';toggleClass(this.target,this.player.config.classNames.fullscreen.fallback,toggle);if(browser.isIos){var viewport=document.head.querySelector('meta[name="viewport"]');var property='viewport-fit=cover';if(!viewport){viewport=document.createElement('meta');viewport.setAttribute('name','viewport')}
var hasProperty=is$1.string(viewport.content)&&viewport.content.includes(property);if(toggle){this.cleanupViewport=!hasProperty;if(!hasProperty){viewport.content+=",".concat(property)}}else if(this.cleanupViewport){viewport.content=viewport.content.split(',').filter(function(part){return part.trim()!==property}).join(',')}
setTimeout(function(){return repaint(_this.target)},100)}
onChange.call(this)}
var Fullscreen=function(){function Fullscreen(player){var _this2=this;_classCallCheck(this,Fullscreen);this.player=player;this.prefix=Fullscreen.prefix;this.property=Fullscreen.property;this.scrollPosition={x:0,y:0};this.forceFallback=player.config.fullscreen.fallback==='force';on.call(this.player,document,this.prefix==='ms'?'MSFullscreenChange':"".concat(this.prefix,"fullscreenchange"),function(){onChange.call(_this2)});on.call(this.player,this.player.elements.container,'dblclick',function(event){if(is$1.element(_this2.player.elements.controls)&&_this2.player.elements.controls.contains(event.target)){return}
_this2.toggle()});this.update()}
_createClass(Fullscreen,[{key:"update",value:function update(){if(this.enabled){var mode;if(this.forceFallback){mode='Fallback (forced)'}else if(Fullscreen.native){mode='Native'}else{mode='Fallback'}}
toggleClass(this.player.elements.container,this.player.config.classNames.fullscreen.enabled,this.enabled)}},{key:"enter",value:function enter(){if(!this.enabled){return}
if(browser.isIos&&this.player.config.fullscreen.iosNative){this.target.webkitEnterFullscreen()}else if(!Fullscreen.native||this.forceFallback){toggleFallback.call(this,!0)}else if(!this.prefix){this.target.requestFullscreen()}else if(!is$1.empty(this.prefix)){this.target["".concat(this.prefix,"Request").concat(this.property)]()}}},{key:"exit",value:function exit(){if(!this.enabled){return}
if(browser.isIos&&this.player.config.fullscreen.iosNative){this.target.webkitExitFullscreen();this.player.play()}else if(!Fullscreen.native||this.forceFallback){toggleFallback.call(this,!1)}else if(!this.prefix){(document.cancelFullScreen||document.exitFullscreen).call(document)}else if(!is$1.empty(this.prefix)){var action=this.prefix==='moz'?'Cancel':'Exit';document["".concat(this.prefix).concat(action).concat(this.property)]()}}},{key:"toggle",value:function toggle(){if(!this.active){this.enter()}else{this.exit()}}},{key:"usingNative",get:function get(){return Fullscreen.native&&!this.forceFallback}},{key:"enabled",get:function get(){return(Fullscreen.native||this.player.config.fullscreen.fallback)&&this.player.config.fullscreen.enabled&&this.player.supported.ui&&this.player.isVideo}},{key:"active",get:function get(){if(!this.enabled){return!1}
if(!Fullscreen.native||this.forceFallback){return hasClass(this.target,this.player.config.classNames.fullscreen.fallback)}
var element=!this.prefix?document.fullscreenElement:document["".concat(this.prefix).concat(this.property,"Element")];return element===this.target}},{key:"target",get:function get(){return browser.isIos&&this.player.config.fullscreen.iosNative?this.player.media:this.player.elements.container}}],[{key:"native",get:function get(){return!!(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)}},{key:"prefix",get:function get(){if(is$1.function(document.exitFullscreen)){return''}
var value='';var prefixes=['webkit','moz','ms'];prefixes.some(function(pre){if(is$1.function(document["".concat(pre,"ExitFullscreen")])||is$1.function(document["".concat(pre,"CancelFullScreen")])){value=pre;return!0}
return!1});return value}},{key:"property",get:function get(){return this.prefix==='moz'?'FullScreen':'Fullscreen'}}]);return Fullscreen}();function loadImage(src){var minWidth=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1;return new Promise(function(resolve,reject){var image=new Image();var handler=function handler(){delete image.onload;delete image.onerror;(image.naturalWidth>=minWidth?resolve:reject)(image)};Object.assign(image,{onload:handler,onerror:handler,src:src})})}
var ui={addStyleHook:function addStyleHook(){toggleClass(this.elements.container,this.config.selectors.container.replace('.',''),!0);toggleClass(this.elements.container,this.config.classNames.uiSupported,this.supported.ui)},toggleNativeControls:function toggleNativeControls(){var toggle=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(toggle&&this.isHTML5){this.media.setAttribute('controls','')}else{this.media.removeAttribute('controls')}},build:function build(){var _this=this;this.listeners.media();if(!this.supported.ui){this.debug.warn("Basic support only for ".concat(this.provider," ").concat(this.type));ui.toggleNativeControls.call(this,!0);return}
if(!is$1.element(this.elements.controls)){controls.inject.call(this);this.listeners.controls()}
ui.toggleNativeControls.call(this);if(this.isHTML5){captions.setup.call(this)}
this.volume=null;this.muted=null;this.speed=null;this.loop=null;this.quality=null;controls.updateVolume.call(this);controls.timeUpdate.call(this);ui.checkPlaying.call(this);toggleClass(this.elements.container,this.config.classNames.isIos,browser.isIos);toggleClass(this.elements.container,this.config.classNames.isTouch,this.touch);this.ready=!0;setTimeout(function(){triggerEvent.call(_this,_this.media,'ready')},0);ui.setTitle.call(this);if(this.poster){ui.setPoster.call(this,this.poster,!1).catch(function(){})}
if(this.config.duration){controls.durationUpdate.call(this)}},setTitle:function setTitle(){var label=i18n.get('play',this.config);if(is$1.string(this.config.title)&&!is$1.empty(this.config.title)){label+=", ".concat(this.config.title)}
Array.from(this.elements.buttons.play||[]).forEach(function(button){button.setAttribute('aria-label',label)});if(this.isEmbed){var iframe=getElement.call(this,'iframe');if(!is$1.element(iframe)){return}
var title=!is$1.empty(this.config.title)?this.config.title:'video';var format=i18n.get('frameTitle',this.config);iframe.setAttribute('title',format.replace('{title}',title))}},togglePoster:function togglePoster(enable){toggleClass(this.elements.container,this.config.classNames.posterEnabled,enable)},setPoster:function setPoster(poster){var _this2=this;var passive=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!0;if(passive&&this.poster){return Promise.reject(new Error('Poster already set'))}
this.media.setAttribute('poster',poster);return ready.call(this).then(function(){return loadImage(poster)}).catch(function(err){if(poster===_this2.poster){ui.togglePoster.call(_this2,!1)}
throw err}).then(function(){if(poster!==_this2.poster){throw new Error('setPoster cancelled by later call to setPoster')}}).then(function(){Object.assign(_this2.elements.poster.style,{backgroundImage:"url('".concat(poster,"')"),backgroundSize:''});ui.togglePoster.call(_this2,!0);return poster})},checkPlaying:function checkPlaying(event){var _this3=this;toggleClass(this.elements.container,this.config.classNames.playing,this.playing);toggleClass(this.elements.container,this.config.classNames.paused,this.paused);toggleClass(this.elements.container,this.config.classNames.stopped,this.stopped);Array.from(this.elements.buttons.play||[]).forEach(function(target){target.pressed=_this3.playing});if(is$1.event(event)&&event.type==='timeupdate'){return}
ui.toggleControls.call(this)},checkLoading:function checkLoading(event){var _this4=this;this.loading=['stalled','waiting'].includes(event.type);clearTimeout(this.timers.loading);this.timers.loading=setTimeout(function(){toggleClass(_this4.elements.container,_this4.config.classNames.loading,_this4.loading);ui.toggleControls.call(_this4)},this.loading?250:0)},toggleControls:function toggleControls(force){var controls=this.elements.controls;if(controls&&this.config.hideControls){var recentTouchSeek=this.touch&&this.lastSeekTime+2000>Date.now();this.toggleControls(Boolean(force||this.loading||this.paused||controls.pressed||controls.hover||recentTouchSeek))}}};function setAspectRatio(input){var ratio=input;if(!is$1.string(ratio)&&!is$1.nullOrUndefined(this.embed)){ratio=this.embed.ratio}
if(!is$1.string(ratio)){ratio=this.config.ratio}
var _ratio$split$map=ratio.split(':').map(Number),_ratio$split$map2=_slicedToArray(_ratio$split$map,2),x=_ratio$split$map2[0],y=_ratio$split$map2[1];var padding=100/x*y;this.elements.wrapper.style.paddingBottom="".concat(padding,"%");if(this.isVimeo&&this.supported.ui){var height=240;var offset=(height-padding)/(height/50);this.media.style.transform="translateY(-".concat(offset,"%)")}
return{padding:padding,ratio:ratio}}
var Listeners=function(){function Listeners(player){_classCallCheck(this,Listeners);this.player=player;this.lastKey=null;this.focusTimer=null;this.lastKeyDown=null;this.handleKey=this.handleKey.bind(this);this.toggleMenu=this.toggleMenu.bind(this);this.setTabFocus=this.setTabFocus.bind(this);this.firstTouch=this.firstTouch.bind(this)}
_createClass(Listeners,[{key:"handleKey",value:function handleKey(event){var player=this.player;var elements=player.elements;var code=event.keyCode?event.keyCode:event.which;var pressed=event.type==='keydown';var repeat=pressed&&code===this.lastKey;if(event.altKey||event.ctrlKey||event.metaKey||event.shiftKey){return}
if(!is$1.number(code)){return}
var seekByKey=function seekByKey(){player.currentTime=player.duration/10*(code-48)};if(pressed){var focused=document.activeElement;if(is$1.element(focused)){var editable=player.config.selectors.editable;var seek=elements.inputs.seek;if(focused!==seek&&matches$1(focused,editable)){return}
if(event.which===32&&matches$1(focused,'button, [role^="menuitem"]')){return}}
var preventDefault=[32,37,38,39,40,48,49,50,51,52,53,54,56,57,67,70,73,75,76,77,79];if(preventDefault.includes(code)){event.preventDefault();event.stopPropagation()}
switch(code){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:if(!repeat){seekByKey()}
break;case 32:case 75:if(!repeat){player.togglePlay()}
break;case 38:player.increaseVolume(0.1);break;case 40:player.decreaseVolume(0.1);break;case 77:if(!repeat){player.muted=!player.muted}
break;case 39:player.forward();break;case 37:player.rewind();break;case 70:player.fullscreen.toggle();break;case 67:if(!repeat){player.toggleCaptions()}
break;case 76:player.loop=!player.loop;break;default:break}
if(code===27&&!player.fullscreen.usingNative&&player.fullscreen.active){player.fullscreen.toggle()}
this.lastKey=code}else{this.lastKey=null}}},{key:"toggleMenu",value:function toggleMenu(event){controls.toggleMenu.call(this.player,event)}},{key:"firstTouch",value:function firstTouch(){var player=this.player;var elements=player.elements;player.touch=!0;toggleClass(elements.container,player.config.classNames.isTouch,!0)}},{key:"setTabFocus",value:function setTabFocus(event){var player=this.player;var elements=player.elements;clearTimeout(this.focusTimer);if(event.type==='keydown'&&event.which!==9){return}
if(event.type==='keydown'){this.lastKeyDown=event.timeStamp}
var removeCurrent=function removeCurrent(){var className=player.config.classNames.tabFocus;var current=getElements.call(player,".".concat(className));toggleClass(current,className,!1)};var wasKeyDown=event.timeStamp-this.lastKeyDown<=20;if(event.type==='focus'&&!wasKeyDown){return}
removeCurrent();this.focusTimer=setTimeout(function(){var focused=document.activeElement;if(!elements.container.contains(focused)){return}
toggleClass(document.activeElement,player.config.classNames.tabFocus,!0)},10)}},{key:"global",value:function global(){var toggle=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!0;var player=this.player;if(player.config.keyboard.global){toggleListener.call(player,window,'keydown keyup',this.handleKey,toggle,!1)}
toggleListener.call(player,document.body,'click',this.toggleMenu,toggle);once.call(player,document.body,'touchstart',this.firstTouch);toggleListener.call(player,document.body,'keydown focus blur',this.setTabFocus,toggle,!1,!0)}},{key:"container",value:function container(){var player=this.player;var config=player.config,elements=player.elements,timers=player.timers;if(!config.keyboard.global&&config.keyboard.focused){on.call(player,elements.container,'keydown keyup',this.handleKey,!1)}
on.call(player,elements.container,'mousemove mouseleave touchstart touchmove enterfullscreen exitfullscreen',function(event){var controls=elements.controls;if(controls&&event.type==='enterfullscreen'){controls.pressed=!1;controls.hover=!1}
var show=['touchstart','touchmove','mousemove'].includes(event.type);var delay=0;if(show){ui.toggleControls.call(player,!0);delay=player.touch?3000:2000}
clearTimeout(timers.controls);timers.controls=setTimeout(function(){return ui.toggleControls.call(player,!1)},delay)});var setGutter=function setGutter(ratio,padding,toggle){if(!player.isVimeo){return}
var target=player.elements.wrapper.firstChild;var _ratio$split$map=ratio.split(':').map(Number),_ratio$split$map2=_slicedToArray(_ratio$split$map,2),height=_ratio$split$map2[1];var _player$embed$ratio$s=player.embed.ratio.split(':').map(Number),_player$embed$ratio$s2=_slicedToArray(_player$embed$ratio$s,2),videoWidth=_player$embed$ratio$s2[0],videoHeight=_player$embed$ratio$s2[1];target.style.maxWidth=toggle?"".concat(height/videoHeight*videoWidth,"px"):null;target.style.margin=toggle?'0 auto':null};var setPlayerSize=function setPlayerSize(measure){if(!measure){return setAspectRatio.call(player)}
var rect=elements.container.getBoundingClientRect();var width=rect.width,height=rect.height;return setAspectRatio.call(player,"".concat(width,":").concat(height))};var resized=function resized(){window.clearTimeout(timers.resized);timers.resized=window.setTimeout(setPlayerSize,50)};on.call(player,elements.container,'enterfullscreen exitfullscreen',function(event){var _player$fullscreen=player.fullscreen,target=_player$fullscreen.target,usingNative=_player$fullscreen.usingNative;if(!player.isEmbed||target!==elements.container){return}
var isEnter=event.type==='enterfullscreen';var _setPlayerSize=setPlayerSize(isEnter),padding=_setPlayerSize.padding,ratio=_setPlayerSize.ratio;setGutter(ratio,padding,isEnter);if(!usingNative){if(isEnter){on.call(player,window,'resize',resized)}else{off.call(player,window,'resize',resized)}}})}},{key:"media",value:function media(){var _this=this;var player=this.player;var elements=player.elements;on.call(player,player.media,'timeupdate seeking seeked',function(event){return controls.timeUpdate.call(player,event)});on.call(player,player.media,'durationchange loadeddata loadedmetadata',function(event){return controls.durationUpdate.call(player,event)});on.call(player,player.media,'canplay loadeddata',function(){toggleHidden(elements.volume,!player.hasAudio);toggleHidden(elements.buttons.mute,!player.hasAudio)});on.call(player,player.media,'ended',function(){if(player.isHTML5&&player.isVideo&&player.config.resetOnEnd){player.restart()}});on.call(player,player.media,'progress playing seeking seeked',function(event){return controls.updateProgress.call(player,event)});on.call(player,player.media,'volumechange',function(event){return controls.updateVolume.call(player,event)});on.call(player,player.media,'playing play pause ended emptied timeupdate',function(event){return ui.checkPlaying.call(player,event)});on.call(player,player.media,'waiting canplay seeked playing',function(event){return ui.checkLoading.call(player,event)});if(player.supported.ui&&player.config.clickToPlay&&!player.isAudio){var wrapper=getElement.call(player,".".concat(player.config.classNames.video));if(!is$1.element(wrapper)){return}
on.call(player,elements.container,'click',function(event){var targets=[elements.container,wrapper];if(!targets.includes(event.target)&&!wrapper.contains(event.target)){return}
if(player.touch&&player.config.hideControls){return}
if(player.ended){_this.proxy(event,player.restart,'restart');_this.proxy(event,player.play,'play')}else{_this.proxy(event,player.togglePlay,'play')}})}
if(player.supported.ui&&player.config.disableContextMenu){on.call(player,elements.wrapper,'contextmenu',function(event){event.preventDefault()},!1)}
on.call(player,player.media,'volumechange',function(){player.storage.set({volume:player.volume,muted:player.muted})});on.call(player,player.media,'ratechange',function(){controls.updateSetting.call(player,'speed');player.storage.set({speed:player.speed})});on.call(player,player.media,'qualitychange',function(event){controls.updateSetting.call(player,'quality',null,event.detail.quality)});var proxyEvents=player.config.events.concat(['keyup','keydown']).join(' ');on.call(player,player.media,proxyEvents,function(event){var _event$detail=event.detail,detail=_event$detail===void 0?{}:_event$detail;if(event.type==='error'){detail=player.media.error}
triggerEvent.call(player,elements.container,event.type,!0,detail)})}},{key:"proxy",value:function proxy(event,defaultHandler,customHandlerKey){var player=this.player;var customHandler=player.config.listeners[customHandlerKey];var hasCustomHandler=is$1.function(customHandler);var returned=!0;if(hasCustomHandler){returned=customHandler.call(player,event)}
if(returned&&is$1.function(defaultHandler)){defaultHandler.call(player,event)}}},{key:"bind",value:function bind(element,type,defaultHandler,customHandlerKey){var _this2=this;var passive=arguments.length>4&&arguments[4]!==undefined?arguments[4]:!0;var player=this.player;var customHandler=player.config.listeners[customHandlerKey];var hasCustomHandler=is$1.function(customHandler);on.call(player,element,type,function(event){return _this2.proxy(event,defaultHandler,customHandlerKey)},passive&&!hasCustomHandler)}},{key:"controls",value:function controls$1(){var _this3=this;var player=this.player;var elements=player.elements;var inputEvent=browser.isIE?'change':'input';if(elements.buttons.play){Array.from(elements.buttons.play).forEach(function(button){_this3.bind(button,'click',player.togglePlay,'play')})}
this.bind(elements.buttons.restart,'click',player.restart,'restart');this.bind(elements.buttons.rewind,'click',player.rewind,'rewind');this.bind(elements.buttons.fastForward,'click',player.forward,'fastForward');this.bind(elements.buttons.mute,'click',function(){player.muted=!player.muted},'mute');this.bind(elements.buttons.captions,'click',function(){return player.toggleCaptions()});this.bind(elements.buttons.fullscreen,'click',function(){player.fullscreen.toggle()},'fullscreen');this.bind(elements.buttons.settings,'click',function(event){event.stopPropagation();controls.toggleMenu.call(player,event)});this.bind(elements.buttons.settings,'keyup',function(event){var code=event.which;if(![13,32].includes(code)){return}
if(code===13){controls.focusFirstMenuItem.call(player,null,!0);return}
event.preventDefault();event.stopPropagation();controls.toggleMenu.call(player,event)},null,!1);this.bind(elements.settings.menu,'keydown',function(event){if(event.which===27){controls.toggleMenu.call(player,event)}});this.bind(elements.inputs.seek,'mousedown mousemove',function(event){var rect=elements.progress.getBoundingClientRect();var percent=100/rect.width*(event.pageX-rect.left);event.currentTarget.setAttribute('seek-value',percent)});this.bind(elements.inputs.seek,'mousedown mouseup keydown keyup touchstart touchend',function(event){var seek=event.currentTarget;var code=event.keyCode?event.keyCode:event.which;var attribute='play-on-seeked';if(is$1.keyboardEvent(event)&&code!==39&&code!==37){return}
player.lastSeekTime=Date.now();var play=seek.hasAttribute(attribute);var done=['mouseup','touchend','keyup'].includes(event.type);if(play&&done){seek.removeAttribute(attribute);player.play()}else if(!done&&player.playing){seek.setAttribute(attribute,'');player.pause()}});if(browser.isIos){var inputs=getElements.call(player,'input[type="range"]');Array.from(inputs).forEach(function(input){return _this3.bind(input,inputEvent,function(event){return repaint(event.target)})})}
this.bind(elements.inputs.seek,inputEvent,function(event){var seek=event.currentTarget;var seekTo=seek.getAttribute('seek-value');if(is$1.empty(seekTo)){seekTo=seek.value}
seek.removeAttribute('seek-value');player.currentTime=seekTo/seek.max*player.duration},'seek');this.bind(elements.progress,'mouseenter mouseleave mousemove',function(event){return controls.updateSeekTooltip.call(player,event)});if(browser.isWebkit){Array.from(getElements.call(player,'input[type="range"]')).forEach(function(element){_this3.bind(element,'input',function(event){return controls.updateRangeFill.call(player,event.target)})})}
if(player.config.toggleInvert&&!is$1.element(elements.display.duration)){this.bind(elements.display.currentTime,'click',function(){if(player.currentTime===0){return}
player.config.invertTime=!player.config.invertTime;controls.timeUpdate.call(player)})}
this.bind(elements.inputs.volume,inputEvent,function(event){player.volume=event.target.value},'volume');this.bind(elements.controls,'mouseenter mouseleave',function(event){elements.controls.hover=!player.touch&&event.type==='mouseenter'});this.bind(elements.controls,'mousedown mouseup touchstart touchend touchcancel',function(event){elements.controls.pressed=['mousedown','touchstart'].includes(event.type)});this.bind(elements.controls,'focusin',function(){var config=player.config,elements=player.elements,timers=player.timers;toggleClass(elements.controls,config.classNames.noTransition,!0);ui.toggleControls.call(player,!0);setTimeout(function(){toggleClass(elements.controls,config.classNames.noTransition,!1)},0);var delay=_this3.touch?3000:4000;clearTimeout(timers.controls);timers.controls=setTimeout(function(){return ui.toggleControls.call(player,!1)},delay)});this.bind(elements.inputs.volume,'wheel',function(event){var inverted=event.webkitDirectionInvertedFromDevice;var _map=[event.deltaX,-event.deltaY].map(function(value){return inverted?-value:value}),_map2=_slicedToArray(_map,2),x=_map2[0],y=_map2[1];var direction=Math.sign(Math.abs(x)>Math.abs(y)?x:y);player.increaseVolume(direction/50);var volume=player.media.volume;if(direction===1&&volume<1||direction===-1&&volume>0){event.preventDefault()}},'volume',!1)}}]);return Listeners}();var loadjs_umd=createCommonjsModule(function(module,exports){(function(root,factory){{module.exports=factory()}})(commonjsGlobal,function(){var devnull=function devnull(){},bundleIdCache={},bundleResultCache={},bundleCallbackQueue={};function subscribe(bundleIds,callbackFn){bundleIds=bundleIds.push?bundleIds:[bundleIds];var depsNotFound=[],i=bundleIds.length,numWaiting=i,fn,bundleId,r,q;fn=function fn(bundleId,pathsNotFound){if(pathsNotFound.length)depsNotFound.push(bundleId);numWaiting--;if(!numWaiting)callbackFn(depsNotFound)};while(i--){bundleId=bundleIds[i];r=bundleResultCache[bundleId];if(r){fn(bundleId,r);continue}
q=bundleCallbackQueue[bundleId]=bundleCallbackQueue[bundleId]||[];q.push(fn)}}
function publish(bundleId,pathsNotFound){if(!bundleId)return;var q=bundleCallbackQueue[bundleId];bundleResultCache[bundleId]=pathsNotFound;if(!q)return;while(q.length){q[0](bundleId,pathsNotFound);q.splice(0,1)}}
function executeCallbacks(args,depsNotFound){if(args.call)args={success:args};if(depsNotFound.length)(args.error||devnull)(depsNotFound);else(args.success||devnull)(args)}
function loadFile(path,callbackFn,args,numTries){var doc=document,async=args.async,maxTries=(args.numRetries||0)+1,beforeCallbackFn=args.before||devnull,pathStripped=path.replace(/^(css|img)!/,''),isLegacyIECss,e;numTries=numTries||0;if(/(^css!|\.css$)/.test(path)){e=doc.createElement('link');e.rel='stylesheet';e.href=pathStripped;isLegacyIECss='hideFocus' in e;if(isLegacyIECss&&e.relList){isLegacyIECss=0;e.rel='preload';e.as='style'}}else if(/(^img!|\.(png|gif|jpg|svg)$)/.test(path)){e=doc.createElement('img');e.src=pathStripped}else{e=doc.createElement('script');e.src=path;e.async=async===undefined?!0:async}
e.onload=e.onerror=e.onbeforeload=function(ev){var result=ev.type[0];if(isLegacyIECss){try{if(!e.sheet.cssText.length)result='e'}catch(x){if(x.code!=18)result='e'}}
if(result=='e'){numTries+=1;if(numTries<maxTries){return loadFile(path,callbackFn,args,numTries)}}else if(e.rel=='preload'&&e.as=='style'){return e.rel='stylesheet'}
callbackFn(path,result,ev.defaultPrevented)};if(beforeCallbackFn(path,e)!==!1)doc.head.appendChild(e)}
function loadFiles(paths,callbackFn,args){paths=paths.push?paths:[paths];var numWaiting=paths.length,x=numWaiting,pathsNotFound=[],fn,i;fn=function fn(path,result,defaultPrevented){if(result=='e')pathsNotFound.push(path);if(result=='b'){if(defaultPrevented)pathsNotFound.push(path);else return}
numWaiting--;if(!numWaiting)callbackFn(pathsNotFound)};for(i=0;i<x;i++){loadFile(paths[i],fn,args)}}
function loadjs(paths,arg1,arg2){var bundleId,args;if(arg1&&arg1.trim)bundleId=arg1;args=(bundleId?arg2:arg1)||{};if(bundleId){if(bundleId in bundleIdCache){throw "LoadJS"}else{bundleIdCache[bundleId]=!0}}
function loadFn(resolve,reject){loadFiles(paths,function(pathsNotFound){executeCallbacks(args,pathsNotFound);if(resolve){executeCallbacks({success:resolve,error:reject},pathsNotFound)}
publish(bundleId,pathsNotFound)},args)}
if(args.returnPromise)return new Promise(loadFn);else loadFn()}
loadjs.ready=function ready(deps,args){subscribe(deps,function(depsNotFound){executeCallbacks(args,depsNotFound)});return loadjs};loadjs.done=function done(bundleId){publish(bundleId,[])};loadjs.reset=function reset(){bundleIdCache={};bundleResultCache={};bundleCallbackQueue={}};loadjs.isDefined=function isDefined(bundleId){return bundleId in bundleIdCache};return loadjs})});function loadScript(url){return new Promise(function(resolve,reject){loadjs_umd(url,{success:resolve,error:reject})})}
function parseId(url){if(is$1.empty(url)){return null}
if(is$1.number(Number(url))){return url}
var regex=/^.*(vimeo.com\/|video\/)(\d+).*/;return url.match(regex)?RegExp.$2:url}
function assurePlaybackState(play){if(play&&!this.embed.hasPlayed){this.embed.hasPlayed=!0}
if(this.media.paused===play){this.media.paused=!play;triggerEvent.call(this,this.media,play?'play':'pause')}}
var vimeo={setup:function setup(){var _this=this;toggleClass(this.elements.wrapper,this.config.classNames.embed,!0);setAspectRatio.call(this);if(!is$1.object(window.Vimeo)){loadScript(this.config.urls.vimeo.sdk).then(function(){vimeo.ready.call(_this)}).catch(function(error){_this.debug.warn('Vimeo API failed to load',error)})}else{vimeo.ready.call(this)}},ready:function ready(){var _this2=this;var player=this;var config=player.config.vimeo;var params=buildUrlParams(extend({},{loop:player.config.loop.active,autoplay:player.autoplay,muted:player.muted,gesture:'media',playsinline:!this.config.fullscreen.iosNative},config));var source=player.media.getAttribute('src');if(is$1.empty(source)){source=player.media.getAttribute(player.config.attributes.embed.id)}
var id=parseId(source);var iframe=createElement('iframe');var src=format(player.config.urls.vimeo.iframe,id,params);iframe.setAttribute('src',src);iframe.setAttribute('allowfullscreen','');iframe.setAttribute('allowtransparency','');iframe.setAttribute('allow','autoplay');var poster=player.poster;var wrapper=createElement('div',{poster:poster,class:player.config.classNames.embedContainer});wrapper.appendChild(iframe);player.media=replaceElement(wrapper,player.media);fetch(format(player.config.urls.vimeo.api,id),'json').then(function(response){if(is$1.empty(response)){return}
var url=new URL(response[0].thumbnail_large);url.pathname="".concat(url.pathname.split('_')[0],".jpg");ui.setPoster.call(player,url.href).catch(function(){})});player.embed=new window.Vimeo.Player(iframe,{autopause:player.config.autopause,muted:player.muted});player.media.paused=!0;player.media.currentTime=0;if(player.supported.ui){player.embed.disableTextTrack()}
player.media.play=function(){assurePlaybackState.call(player,!0);return player.embed.play()};player.media.pause=function(){assurePlaybackState.call(player,!1);return player.embed.pause()};player.media.stop=function(){player.pause();player.currentTime=0};var currentTime=player.media.currentTime;Object.defineProperty(player.media,'currentTime',{get:function get(){return currentTime},set:function set(time){var embed=player.embed,media=player.media,paused=player.paused,volume=player.volume;var restorePause=paused&&!embed.hasPlayed;media.seeking=!0;triggerEvent.call(player,media,'seeking');Promise.resolve(restorePause&&embed.setVolume(0)).then(function(){return embed.setCurrentTime(time)}).then(function(){return restorePause&&embed.pause()}).then(function(){return restorePause&&embed.setVolume(volume)}).catch(function(){})}});var speed=player.config.speed.selected;Object.defineProperty(player.media,'playbackRate',{get:function get(){return speed},set:function set(input){player.embed.setPlaybackRate(input).then(function(){speed=input;triggerEvent.call(player,player.media,'ratechange')}).catch(function(error){if(error.name==='Error'){controls.setSpeedMenu.call(player,[])}})}});var volume=player.config.volume;Object.defineProperty(player.media,'volume',{get:function get(){return volume},set:function set(input){player.embed.setVolume(input).then(function(){volume=input;triggerEvent.call(player,player.media,'volumechange')})}});var muted=player.config.muted;Object.defineProperty(player.media,'muted',{get:function get(){return muted},set:function set(input){var toggle=is$1.boolean(input)?input:!1;player.embed.setVolume(toggle?0:player.config.volume).then(function(){muted=toggle;triggerEvent.call(player,player.media,'volumechange')})}});var loop=player.config.loop;Object.defineProperty(player.media,'loop',{get:function get(){return loop},set:function set(input){var toggle=is$1.boolean(input)?input:player.config.loop.active;player.embed.setLoop(toggle).then(function(){loop=toggle})}});var currentSrc;player.embed.getVideoUrl().catch(function(error){_this2.debug.warn(error)});Object.defineProperty(player.media,'currentSrc',{get:function get(){return currentSrc}});Object.defineProperty(player.media,'ended',{get:function get(){return player.currentTime===player.duration}});Promise.all([player.embed.getVideoWidth(),player.embed.getVideoHeight()]).then(function(dimensions){var _dimensions=_slicedToArray(dimensions,2),width=_dimensions[0],height=_dimensions[1];player.embed.ratio="".concat(width,":").concat(height);setAspectRatio.call(_this2,player.embed.ratio)});player.embed.setAutopause(player.config.autopause).then(function(state){player.config.autopause=state});player.embed.getVideoTitle().then(function(title){player.config.title=title;ui.setTitle.call(_this2)});player.embed.getCurrentTime().then(function(value){currentTime=value;triggerEvent.call(player,player.media,'timeupdate')});player.embed.getDuration().then(function(value){player.media.duration=value;triggerEvent.call(player,player.media,'durationchange')});player.embed.getTextTracks().then(function(tracks){player.media.textTracks=tracks;captions.setup.call(player)});player.embed.on('cuechange',function(_ref){var _ref$cues=_ref.cues,cues=_ref$cues===void 0?[]:_ref$cues;var strippedCues=cues.map(function(cue){return stripHTML(cue.text)});captions.updateCues.call(player,strippedCues)});player.embed.on('loaded',function(){player.embed.getPaused().then(function(paused){assurePlaybackState.call(player,!paused);if(!paused){triggerEvent.call(player,player.media,'playing')}});if(is$1.element(player.embed.element)&&player.supported.ui){var frame=player.embed.element;frame.setAttribute('tabindex',-1)}});player.embed.on('play',function(){assurePlaybackState.call(player,!0);triggerEvent.call(player,player.media,'playing')});player.embed.on('pause',function(){assurePlaybackState.call(player,!1)});player.embed.on('timeupdate',function(data){player.media.seeking=!1;currentTime=data.seconds;triggerEvent.call(player,player.media,'timeupdate')});player.embed.on('progress',function(data){player.media.buffered=data.percent;triggerEvent.call(player,player.media,'progress');if(parseInt(data.percent,10)===1){triggerEvent.call(player,player.media,'canplaythrough')}
player.embed.getDuration().then(function(value){if(value!==player.media.duration){player.media.duration=value;triggerEvent.call(player,player.media,'durationchange')}})});player.embed.on('seeked',function(){player.media.seeking=!1;triggerEvent.call(player,player.media,'seeked')});player.embed.on('ended',function(){player.media.paused=!0;triggerEvent.call(player,player.media,'ended')});player.embed.on('error',function(detail){player.media.error=detail;triggerEvent.call(player,player.media,'error')});setTimeout(function(){return ui.build.call(player)},0)}};function parseId$1(url){if(is$1.empty(url)){return null}
var regex=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;return url.match(regex)?RegExp.$2:url}
function assurePlaybackState$1(play){if(play&&!this.embed.hasPlayed){this.embed.hasPlayed=!0}
if(this.media.paused===play){this.media.paused=!play;triggerEvent.call(this,this.media,play?'play':'pause')}}
var youtube={setup:function setup(){var _this=this;toggleClass(this.elements.wrapper,this.config.classNames.embed,!0);setAspectRatio.call(this);if(is$1.object(window.YT)&&is$1.function(window.YT.Player)){youtube.ready.call(this)}else{loadScript(this.config.urls.youtube.sdk).catch(function(error){_this.debug.warn('YouTube API failed to load',error)});window.onYouTubeReadyCallbacks=window.onYouTubeReadyCallbacks||[];window.onYouTubeReadyCallbacks.push(function(){youtube.ready.call(_this)});window.onYouTubeIframeAPIReady=function(){window.onYouTubeReadyCallbacks.forEach(function(callback){callback()})}}},getTitle:function getTitle(videoId){var _this2=this;if(is$1.function(this.embed.getVideoData)){var _this$embed$getVideoD=this.embed.getVideoData(),title=_this$embed$getVideoD.title;if(is$1.empty(title)){this.config.title=title;ui.setTitle.call(this);return}}
var key=this.config.keys.google;if(is$1.string(key)&&!is$1.empty(key)){var url=format(this.config.urls.youtube.api,videoId,key);fetch(url).then(function(result){if(is$1.object(result)){_this2.config.title=result.items[0].snippet.title;ui.setTitle.call(_this2)}}).catch(function(){})}},ready:function ready(){var player=this;var currentId=player.media.getAttribute('id');if(!is$1.empty(currentId)&&currentId.startsWith('youtube-')){return}
var source=player.media.getAttribute('src');if(is$1.empty(source)){source=player.media.getAttribute(this.config.attributes.embed.id)}
var videoId=parseId$1(source);var id=generateId(player.provider);var poster=player.poster;var container=createElement('div',{id:id,poster:poster});player.media=replaceElement(container,player.media);var posterSrc=function posterSrc(format){return"https://img.youtube.com/vi/".concat(videoId,"/").concat(format,"default.jpg")};loadImage(posterSrc('maxres'),121).catch(function(){return loadImage(posterSrc('sd'),121)}).catch(function(){return loadImage(posterSrc('hq'))}).then(function(image){return ui.setPoster.call(player,image.src)}).then(function(posterSrc){if(!posterSrc.includes('maxres')){player.elements.poster.style.backgroundSize='cover'}}).catch(function(){});var config=player.config.youtube;player.embed=new window.YT.Player(id,{videoId:videoId,host:config.noCookie?'https://www.youtube-nocookie.com':undefined,playerVars:extend({},{autoplay:player.config.autoplay?1:0,hl:player.config.hl,controls:player.supported.ui?0:1,disablekb:1,playsinline:!player.config.fullscreen.iosNative?1:0,cc_load_policy:player.captions.active?1:0,cc_lang_pref:player.config.captions.language,widget_referrer:window?window.location.href:null},config),events:{onError:function onError(event){if(!player.media.error){var code=event.data;var message={2:'The request contains an invalid parameter value. For example, this error occurs if you specify a video ID that does not have 11 characters, or if the video ID contains invalid characters, such as exclamation points or asterisks.',5:'The requested content cannot be played in an HTML5 player or another error related to the HTML5 player has occurred.',100:'The video requested was not found. This error occurs when a video has been removed (for any reason) or has been marked as private.',101:'The owner of the requested video does not allow it to be played in embedded players.',150:'The owner of the requested video does not allow it to be played in embedded players.'}[code]||'An unknown error occured';player.media.error={code:code,message:message};triggerEvent.call(player,player.media,'error')}},onPlaybackRateChange:function onPlaybackRateChange(event){var instance=event.target;player.media.playbackRate=instance.getPlaybackRate();triggerEvent.call(player,player.media,'ratechange')},onReady:function onReady(event){if(is$1.function(player.media.play)){return}
var instance=event.target;youtube.getTitle.call(player,videoId);player.media.play=function(){assurePlaybackState$1.call(player,!0);instance.playVideo()};player.media.pause=function(){assurePlaybackState$1.call(player,!1);instance.pauseVideo()};player.media.stop=function(){instance.stopVideo()};player.media.duration=instance.getDuration();player.media.paused=!0;player.media.currentTime=0;Object.defineProperty(player.media,'currentTime',{get:function get(){return Number(instance.getCurrentTime())},set:function set(time){if(player.paused&&!player.embed.hasPlayed){player.embed.mute()}
player.media.seeking=!0;triggerEvent.call(player,player.media,'seeking');instance.seekTo(time)}});Object.defineProperty(player.media,'playbackRate',{get:function get(){return instance.getPlaybackRate()},set:function set(input){instance.setPlaybackRate(input)}});var volume=player.config.volume;Object.defineProperty(player.media,'volume',{get:function get(){return volume},set:function set(input){volume=input;instance.setVolume(volume*100);triggerEvent.call(player,player.media,'volumechange')}});var muted=player.config.muted;Object.defineProperty(player.media,'muted',{get:function get(){return muted},set:function set(input){var toggle=is$1.boolean(input)?input:muted;muted=toggle;instance[toggle?'mute':'unMute']();triggerEvent.call(player,player.media,'volumechange')}});Object.defineProperty(player.media,'currentSrc',{get:function get(){return instance.getVideoUrl()}});Object.defineProperty(player.media,'ended',{get:function get(){return player.currentTime===player.duration}});player.options.speed=instance.getAvailablePlaybackRates();if(player.supported.ui){player.media.setAttribute('tabindex',-1)}
triggerEvent.call(player,player.media,'timeupdate');triggerEvent.call(player,player.media,'durationchange');clearInterval(player.timers.buffering);player.timers.buffering=setInterval(function(){player.media.buffered=instance.getVideoLoadedFraction();if(player.media.lastBuffered===null||player.media.lastBuffered<player.media.buffered){triggerEvent.call(player,player.media,'progress')}
player.media.lastBuffered=player.media.buffered;if(player.media.buffered===1){clearInterval(player.timers.buffering);triggerEvent.call(player,player.media,'canplaythrough')}},200);setTimeout(function(){return ui.build.call(player)},50)},onStateChange:function onStateChange(event){var instance=event.target;clearInterval(player.timers.playing);var seeked=player.media.seeking&&[1,2].includes(event.data);if(seeked){player.media.seeking=!1;triggerEvent.call(player,player.media,'seeked')}
switch(event.data){case-1:triggerEvent.call(player,player.media,'timeupdate');player.media.buffered=instance.getVideoLoadedFraction();triggerEvent.call(player,player.media,'progress');break;case 0:assurePlaybackState$1.call(player,!1);if(player.media.loop){instance.stopVideo();instance.playVideo()}else{triggerEvent.call(player,player.media,'ended')}
break;case 1:if(player.media.paused&&!player.embed.hasPlayed){player.media.pause()}else{assurePlaybackState$1.call(player,!0);triggerEvent.call(player,player.media,'playing');player.timers.playing=setInterval(function(){triggerEvent.call(player,player.media,'timeupdate')},50);if(player.media.duration!==instance.getDuration()){player.media.duration=instance.getDuration();triggerEvent.call(player,player.media,'durationchange')}}
break;case 2:if(!player.muted){player.embed.unMute()}
assurePlaybackState$1.call(player,!1);break;default:break}
triggerEvent.call(player,player.elements.container,'statechange',!1,{code:event.data})}}})}};var media={setup:function setup(){if(!this.media){this.debug.warn('No media element found!');return}
toggleClass(this.elements.container,this.config.classNames.type.replace('{0}',this.type),!0);toggleClass(this.elements.container,this.config.classNames.provider.replace('{0}',this.provider),!0);if(this.isEmbed){toggleClass(this.elements.container,this.config.classNames.type.replace('{0}','video'),!0)}
if(this.isVideo){this.elements.wrapper=createElement('div',{class:this.config.classNames.video});wrap(this.media,this.elements.wrapper);this.elements.poster=createElement('div',{class:this.config.classNames.poster});this.elements.wrapper.appendChild(this.elements.poster)}
if(this.isHTML5){html5.extend.call(this)}else if(this.isYouTube){youtube.setup.call(this)}else if(this.isVimeo){vimeo.setup.call(this)}}};var Ads=function(){function Ads(player){var _this=this;_classCallCheck(this,Ads);this.player=player;this.config=player.config.ads;this.playing=!1;this.initialized=!1;this.elements={container:null,displayContainer:null};this.manager=null;this.loader=null;this.cuePoints=null;this.events={};this.safetyTimer=null;this.countdownTimer=null;this.managerPromise=new Promise(function(resolve,reject){_this.on('loaded',resolve);_this.on('error',reject)});this.load()}
_createClass(Ads,[{key:"load",value:function load(){var _this2=this;if(this.enabled){if(!is$1.object(window.google)||!is$1.object(window.google.ima)){loadScript(this.player.config.urls.googleIMA.sdk).then(function(){_this2.ready()}).catch(function(){_this2.trigger('error',new Error('Google IMA SDK failed to load'))})}else{this.ready()}}}},{key:"ready",value:function ready(){var _this3=this;this.startSafetyTimer(12000,'ready()');this.managerPromise.then(function(){_this3.clearSafetyTimer('onAdsManagerLoaded()')});this.listeners();this.setupIMA()}},{key:"setupIMA",value:function setupIMA(){this.elements.container=createElement('div',{class:this.player.config.classNames.ads});this.player.elements.container.appendChild(this.elements.container);google.ima.settings.setVpaidMode(google.ima.ImaSdkSettings.VpaidMode.ENABLED);google.ima.settings.setLocale(this.player.config.ads.language);google.ima.settings.setDisableCustomPlaybackForIOS10Plus(this.player.config.playsinline);this.elements.displayContainer=new google.ima.AdDisplayContainer(this.elements.container,this.player.media);this.requestAds()}},{key:"requestAds",value:function requestAds(){var _this4=this;var container=this.player.elements.container;try{this.loader=new google.ima.AdsLoader(this.elements.displayContainer);this.loader.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,function(event){return _this4.onAdsManagerLoaded(event)},!1);this.loader.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(error){return _this4.onAdError(error)},!1);var request=new google.ima.AdsRequest();request.adTagUrl=this.tagUrl;request.linearAdSlotWidth=container.offsetWidth;request.linearAdSlotHeight=container.offsetHeight;request.nonLinearAdSlotWidth=container.offsetWidth;request.nonLinearAdSlotHeight=container.offsetHeight;request.forceNonLinearFullSlot=!1;request.setAdWillPlayMuted(!this.player.muted);this.loader.requestAds(request)}catch(e){this.onAdError(e)}}},{key:"pollCountdown",value:function pollCountdown(){var _this5=this;var start=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1;if(!start){clearInterval(this.countdownTimer);this.elements.container.removeAttribute('data-badge-text');return}
var update=function update(){var time=formatTime(Math.max(_this5.manager.getRemainingTime(),0));var label="".concat(i18n.get('advertisement',_this5.player.config)," - ").concat(time);_this5.elements.container.setAttribute('data-badge-text',label)};this.countdownTimer=setInterval(update,100)}},{key:"onAdsManagerLoaded",value:function onAdsManagerLoaded(event){var _this6=this;if(!this.enabled){return}
var settings=new google.ima.AdsRenderingSettings();settings.restoreCustomPlaybackStateOnAdBreakComplete=!0;settings.enablePreloading=!0;this.manager=event.getAdsManager(this.player,settings);this.cuePoints=this.manager.getCuePoints();this.manager.setVolume(this.player.volume);this.manager.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,function(error){return _this6.onAdError(error)});Object.keys(google.ima.AdEvent.Type).forEach(function(type){_this6.manager.addEventListener(google.ima.AdEvent.Type[type],function(event){return _this6.onAdEvent(event)})});this.trigger('loaded')}},{key:"addCuePoints",value:function addCuePoints(){var _this7=this;if(!is$1.empty(this.cuePoints)){this.cuePoints.forEach(function(cuePoint){if(cuePoint!==0&&cuePoint!==-1&&cuePoint<_this7.player.duration){var seekElement=_this7.player.elements.progress;if(is$1.element(seekElement)){var cuePercentage=100/_this7.player.duration*cuePoint;var cue=createElement('span',{class:_this7.player.config.classNames.cues});cue.style.left="".concat(cuePercentage.toString(),"%");seekElement.appendChild(cue)}}})}}},{key:"onAdEvent",value:function onAdEvent(event){var _this8=this;var container=this.player.elements.container;var ad=event.getAd();var adData=event.getAdData();var dispatchEvent=function dispatchEvent(type){var event="ads".concat(type.replace(/_/g,'').toLowerCase());triggerEvent.call(_this8.player,_this8.player.media,event)};switch(event.type){case google.ima.AdEvent.Type.LOADED:this.trigger('loaded');dispatchEvent(event.type);this.pollCountdown(!0);if(!ad.isLinear()){ad.width=container.offsetWidth;ad.height=container.offsetHeight}
break;case google.ima.AdEvent.Type.ALL_ADS_COMPLETED:dispatchEvent(event.type);this.loadAds();break;case google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED:dispatchEvent(event.type);this.pauseContent();break;case google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED:dispatchEvent(event.type);this.pollCountdown();this.resumeContent();break;case google.ima.AdEvent.Type.STARTED:case google.ima.AdEvent.Type.MIDPOINT:case google.ima.AdEvent.Type.COMPLETE:case google.ima.AdEvent.Type.IMPRESSION:case google.ima.AdEvent.Type.CLICK:dispatchEvent(event.type);break;case google.ima.AdEvent.Type.LOG:if(adData.adError){this.player.debug.warn("Non-fatal ad error: ".concat(adData.adError.getMessage()))}
break;default:break}}},{key:"onAdError",value:function onAdError(event){this.cancel();this.player.debug.warn('Ads error',event)}},{key:"listeners",value:function listeners(){var _this9=this;var container=this.player.elements.container;var time;this.player.on('canplay',function(){_this9.addCuePoints()});this.player.on('ended',function(){_this9.loader.contentComplete()});this.player.on('timeupdate',function(){time=_this9.player.currentTime});this.player.on('seeked',function(){var seekedTime=_this9.player.currentTime;if(is$1.empty(_this9.cuePoints)){return}
_this9.cuePoints.forEach(function(cuePoint,index){if(time<cuePoint&&cuePoint<seekedTime){_this9.manager.discardAdBreak();_this9.cuePoints.splice(index,1)}})});window.addEventListener('resize',function(){if(_this9.manager){_this9.manager.resize(container.offsetWidth,container.offsetHeight,google.ima.ViewMode.NORMAL)}})}},{key:"play",value:function play(){var _this10=this;var container=this.player.elements.container;if(!this.managerPromise){this.resumeContent()}
this.managerPromise.then(function(){_this10.elements.displayContainer.initialize();try{if(!_this10.initialized){_this10.manager.init(container.offsetWidth,container.offsetHeight,google.ima.ViewMode.NORMAL);_this10.manager.start()}
_this10.initialized=!0}catch(adError){_this10.onAdError(adError)}}).catch(function(){})}},{key:"resumeContent",value:function resumeContent(){this.elements.container.style.zIndex='';this.playing=!1;this.player.media.play()}},{key:"pauseContent",value:function pauseContent(){this.elements.container.style.zIndex=3;this.playing=!0;this.player.media.pause()}},{key:"cancel",value:function cancel(){if(this.initialized){this.resumeContent()}
this.trigger('error');this.loadAds()}},{key:"loadAds",value:function loadAds(){var _this11=this;this.managerPromise.then(function(){if(_this11.manager){_this11.manager.destroy()}
_this11.managerPromise=new Promise(function(resolve){_this11.on('loaded',resolve);_this11.player.debug.log(_this11.manager)});_this11.requestAds()}).catch(function(){})}},{key:"trigger",value:function trigger(event){var _this12=this;for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++){args[_key-1]=arguments[_key]}
var handlers=this.events[event];if(is$1.array(handlers)){handlers.forEach(function(handler){if(is$1.function(handler)){handler.apply(_this12,args)}})}}},{key:"on",value:function on(event,callback){if(!is$1.array(this.events[event])){this.events[event]=[]}
this.events[event].push(callback);return this}},{key:"startSafetyTimer",value:function startSafetyTimer(time,from){var _this13=this;this.player.debug.log("Safety timer invoked from: ".concat(from));this.safetyTimer=setTimeout(function(){_this13.cancel();_this13.clearSafetyTimer('startSafetyTimer()')},time)}},{key:"clearSafetyTimer",value:function clearSafetyTimer(from){if(!is$1.nullOrUndefined(this.safetyTimer)){this.player.debug.log("Safety timer cleared from: ".concat(from));clearTimeout(this.safetyTimer);this.safetyTimer=null}}},{key:"enabled",get:function get(){var config=this.config;return this.player.isHTML5&&this.player.isVideo&&config.enabled&&(!is$1.empty(config.publisherId)||is$1.url(config.tagUrl))}},{key:"tagUrl",get:function get(){var config=this.config;if(is$1.url(config.tagUrl)){return config.tagUrl}
var params={AV_PUBLISHERID:'58c25bb0073ef448b1087ad6',AV_CHANNELID:'5a0458dc28a06145e4519d21',AV_URL:window.location.hostname,cb:Date.now(),AV_WIDTH:640,AV_HEIGHT:480,AV_CDIM2:this.publisherId};var base='https://go.aniview.com/api/adserver6/vast/';return"".concat(base,"?").concat(buildUrlParams(params))}}]);return Ads}();var parseVtt=function parseVtt(vttDataString){var processedList=[];var frames=vttDataString.split(/\r\n\r\n|\n\n|\r\r/);frames.forEach(function(frame){var result={};var lines=frame.split(/\r\n|\n|\r/);lines.forEach(function(line){if(!is$1.number(result.startTime)){var matchTimes=line.match(/([0-9]{2}):([0-9]{2}):([0-9]{2}).([0-9]{2,3})( ?--> ?)([0-9]{2}):([0-9]{2}):([0-9]{2}).([0-9]{2,3})/);if(matchTimes){result.startTime=Number(matchTimes[1])*60*60+Number(matchTimes[2])*60+Number(matchTimes[3])+Number("0.".concat(matchTimes[4]));result.endTime=Number(matchTimes[6])*60*60+Number(matchTimes[7])*60+Number(matchTimes[8])+Number("0.".concat(matchTimes[9]))}}else if(!is$1.empty(line.trim())&&is$1.empty(result.text)){var lineSplit=line.trim().split('#xywh=');var _lineSplit=_slicedToArray(lineSplit,1);result.text=_lineSplit[0];if(lineSplit[1]){var _lineSplit$1$split=lineSplit[1].split(',');var _lineSplit$1$split2=_slicedToArray(_lineSplit$1$split,4);result.x=_lineSplit$1$split2[0];result.y=_lineSplit$1$split2[1];result.w=_lineSplit$1$split2[2];result.h=_lineSplit$1$split2[3]}}});if(result.text){processedList.push(result)}});return processedList};var source={insertElements:function insertElements(type,attributes){var _this=this;if(is$1.string(attributes)){insertElement(type,this.media,{src:attributes})}else if(is$1.array(attributes)){attributes.forEach(function(attribute){insertElement(type,_this.media,attribute)})}},change:function change(input){var _this2=this;if(!getDeep(input,'sources.length')){this.debug.warn('Invalid source format');return}
html5.cancelRequests.call(this);this.destroy.call(this,function(){_this2.options.quality=[];removeElement(_this2.media);_this2.media=null;if(is$1.element(_this2.elements.container)){_this2.elements.container.removeAttribute('class')}
var sources=input.sources,type=input.type;var _sources=_slicedToArray(sources,1),_sources$=_sources[0],_sources$$provider=_sources$.provider,provider=_sources$$provider===void 0?providers.html5:_sources$$provider,src=_sources$.src;var tagName=provider==='html5'?type:'div';var attributes=provider==='html5'?{}:{src:src};Object.assign(_this2,{provider:provider,type:type,supported:support.check(type,provider,_this2.config.playsinline),media:createElement(tagName,attributes)});_this2.elements.container.appendChild(_this2.media);if(is$1.boolean(input.autoplay)){_this2.config.autoplay=input.autoplay}
if(_this2.isHTML5){if(_this2.config.crossorigin){_this2.media.setAttribute('crossorigin','')}
if(_this2.config.autoplay){_this2.media.setAttribute('autoplay','')}
if(!is$1.empty(input.poster)){_this2.poster=input.poster}
if(_this2.config.loop.active){_this2.media.setAttribute('loop','')}
if(_this2.config.muted){_this2.media.setAttribute('muted','')}
if(_this2.config.playsinline){_this2.media.setAttribute('playsinline','')}}
ui.addStyleHook.call(_this2);if(_this2.isHTML5){source.insertElements.call(_this2,'source',sources)}
_this2.config.title=input.title;media.setup.call(_this2);if(_this2.isHTML5){if(Object.keys(input).includes('tracks')){source.insertElements.call(_this2,'track',input.tracks)}}
if(_this2.isHTML5||_this2.isEmbed&&!_this2.supported.ui){ui.build.call(_this2)}
if(_this2.isHTML5){_this2.media.load()}
_this2.fullscreen.update()},!0)}};var Plyr=function(){function Plyr(target,options){var _this=this;_classCallCheck(this,Plyr);this.timers={};this.ready=!1;this.loading=!1;this.failed=!1;this.touch=support.touch;this.media=target;if(is$1.string(this.media)){this.media=document.querySelectorAll(this.media)}
if(window.jQuery&&this.media instanceof jQuery||is$1.nodeList(this.media)||is$1.array(this.media)){this.media=this.media[0]}
this.config=extend({},defaults$1,Plyr.defaults,options||{},function(){try{return JSON.parse(_this.media.getAttribute('data-plyr-config'))}catch(e){return{}}}());this.elements={container:null,captions:null,buttons:{},display:{},progress:{},inputs:{},settings:{popup:null,menu:null,panels:{},buttons:{}}};this.captions={active:null,currentTrack:-1,meta:new WeakMap()};this.fullscreen={active:!1};this.options={speed:[],quality:[]};this.debug=new Console(this.config.debug);var clone=this.media.cloneNode(!0);clone.autoplay=!1;this.elements.original=clone;var type=this.media.tagName.toLowerCase();var iframe=null;var url=null;switch(type){case 'div':iframe=this.media.querySelector('iframe');if(is$1.element(iframe)){url=parseUrl$2(iframe.getAttribute('src'));this.provider=getProviderByUrl(url.toString());this.elements.container=this.media;this.media=iframe;this.elements.container.className='';if(url.search.length){var truthy=['1','true'];if(truthy.includes(url.searchParams.get('autoplay'))){this.config.autoplay=!0}
if(truthy.includes(url.searchParams.get('loop'))){this.config.loop.active=!0}
if(this.isYouTube){this.config.playsinline=truthy.includes(url.searchParams.get('playsinline'));this.config.youtube.hl=url.searchParams.get('hl')}else{this.config.playsinline=!0}}}else{this.provider=this.media.getAttribute(this.config.attributes.embed.provider);this.media.removeAttribute(this.config.attributes.embed.provider)}
if(is$1.empty(this.provider)||!Object.keys(providers).includes(this.provider)){this.debug.error('Setup failed: Invalid provider');return}
this.type=types.video;break;case 'video':case 'audio':this.type=type;this.provider=providers.html5;if(this.media.hasAttribute('crossorigin')){this.config.crossorigin=!0}
if(this.media.hasAttribute('autoplay')){this.config.autoplay=!0}
if(this.media.hasAttribute('playsinline')||this.media.hasAttribute('webkit-playsinline')){this.config.playsinline=!0}
if(this.media.hasAttribute('muted')){this.config.muted=!0}
if(this.media.hasAttribute('loop')){this.config.loop.active=!0}
break;default:this.debug.error('Setup failed: unsupported type');return}
this.supported=support.check(this.type,this.provider,this.config.playsinline);if(!this.supported.api){this.debug.error('Setup failed: no support');return}
this.eventListeners=[];this.listeners=new Listeners(this);this.storage=new Storage(this);this.media.plyr=this;if(!is$1.element(this.elements.container)){this.elements.container=createElement('div',{tabindex:0});wrap(this.media,this.elements.container)}
ui.addStyleHook.call(this);media.setup.call(this);if(this.isHTML5||this.isEmbed&&!this.supported.ui){ui.build.call(this)}
this.listeners.container();this.listeners.global();this.fullscreen=new Fullscreen(this);if(this.config.ads.enabled){this.ads=new Ads(this)}
if(this.config.autoplay){this.play()}
this.lastSeekTime=0}
_createClass(Plyr,[{key:"play",value:function play(){var _this2=this;if(!is$1.function(this.media.play)){return null}
if(this.ads&&this.ads.enabled){this.ads.managerPromise.then(function(){return _this2.ads.play()}).catch(function(){return _this2.media.play()})}
return this.media.play()}},{key:"pause",value:function pause(){if(!this.playing||!is$1.function(this.media.pause)){return}
this.media.pause()}},{key:"togglePlay",value:function togglePlay(input){var toggle=is$1.boolean(input)?input:!this.playing;if(toggle){this.play()}else{this.pause()}}},{key:"stop",value:function stop(){if(this.isHTML5){this.pause();this.restart()}else if(is$1.function(this.media.stop)){this.media.stop()}}},{key:"restart",value:function restart(){this.currentTime=0}},{key:"rewind",value:function rewind(seekTime){this.currentTime=this.currentTime-(is$1.number(seekTime)?seekTime:this.config.seekTime)}},{key:"forward",value:function forward(seekTime){this.currentTime=this.currentTime+(is$1.number(seekTime)?seekTime:this.config.seekTime)}},{key:"increaseVolume",value:function increaseVolume(step){var volume=this.media.muted?0:this.volume;this.volume=volume+(is$1.number(step)?step:0)}},{key:"decreaseVolume",value:function decreaseVolume(step){this.increaseVolume(-step)}},{key:"toggleCaptions",value:function toggleCaptions(input){captions.toggle.call(this,input,!1)}},{key:"toggleControls",value:function toggleControls(toggle){if(this.supported.ui&&!this.isAudio){var isHidden=hasClass(this.elements.container,this.config.classNames.hideControls);var force=typeof toggle==='undefined'?undefined:!toggle;var hiding=toggleClass(this.elements.container,this.config.classNames.hideControls,force);if(hiding&&this.config.controls.includes('settings')&&!is$1.empty(this.config.settings)){controls.toggleMenu.call(this,!1)}
if(hiding!==isHidden){var eventName=hiding?'controlshidden':'controlsshown';triggerEvent.call(this,this.media,eventName)}
return!hiding}
return!1}},{key:"on",value:function on$1(event,callback){on.call(this,this.elements.container,event,callback)}},{key:"once",value:function once$1(event,callback){once.call(this,this.elements.container,event,callback)}},{key:"off",value:function off$1(event,callback){off(this.elements.container,event,callback)}},{key:"destroy",value:function destroy(callback){var _this3=this;var soft=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;if(!this.ready){return}
var done=function done(){document.body.style.overflow='';_this3.embed=null;if(soft){if(Object.keys(_this3.elements).length){removeElement(_this3.elements.buttons.play);removeElement(_this3.elements.captions);removeElement(_this3.elements.controls);removeElement(_this3.elements.wrapper);_this3.elements.buttons.play=null;_this3.elements.captions=null;_this3.elements.controls=null;_this3.elements.wrapper=null}
if(is$1.function(callback)){callback()}}else{unbindListeners.call(_this3);replaceElement(_this3.elements.original,_this3.elements.container);triggerEvent.call(_this3,_this3.elements.original,'destroyed',!0);if(is$1.function(callback)){callback.call(_this3.elements.original)}
_this3.ready=!1;setTimeout(function(){_this3.elements=null;_this3.media=null},200)}};this.stop();if(this.isHTML5){clearTimeout(this.timers.loading);ui.toggleNativeControls.call(this,!0);done()}else if(this.isYouTube){clearInterval(this.timers.buffering);clearInterval(this.timers.playing);if(this.embed!==null&&is$1.function(this.embed.destroy)){this.embed.destroy()}
done()}else if(this.isVimeo){if(this.embed!==null){this.embed.unload().then(done)}
setTimeout(done,200)}}},{key:"supports",value:function supports(type){return support.mime.call(this,type)}},{key:"isHTML5",get:function get(){return Boolean(this.provider===providers.html5)}},{key:"isEmbed",get:function get(){return Boolean(this.isYouTube||this.isVimeo)}},{key:"isYouTube",get:function get(){return Boolean(this.provider===providers.youtube)}},{key:"isVimeo",get:function get(){return Boolean(this.provider===providers.vimeo)}},{key:"isVideo",get:function get(){return Boolean(this.type===types.video)}},{key:"isAudio",get:function get(){return Boolean(this.type===types.audio)}},{key:"playing",get:function get(){return Boolean(this.ready&&!this.paused&&!this.ended)}},{key:"paused",get:function get(){return Boolean(this.media.paused)}},{key:"stopped",get:function get(){return Boolean(this.paused&&this.currentTime===0)}},{key:"ended",get:function get(){return Boolean(this.media.ended)}},{key:"currentTime",set:function set(input){if(!this.duration){return}
var inputIsValid=is$1.number(input)&&input>0;this.media.currentTime=inputIsValid?Math.min(input,this.duration):0},get:function get(){return Number(this.media.currentTime)}},{key:"buffered",get:function get(){var buffered=this.media.buffered;if(is$1.number(buffered)){return buffered}
if(buffered&&buffered.length&&this.duration>0){return buffered.end(0)/this.duration}
return 0}},{key:"seeking",get:function get(){return Boolean(this.media.seeking)}},{key:"duration",get:function get(){var fauxDuration=parseFloat(this.config.duration);var realDuration=(this.media||{}).duration;var duration=!is$1.number(realDuration)||realDuration===Infinity?0:realDuration;return fauxDuration||duration}},{key:"volume",set:function set(value){var volume=value;var max=1;var min=0;if(is$1.string(volume)){volume=Number(volume)}
if(!is$1.number(volume)){volume=this.storage.get('volume')}
if(!is$1.number(volume)){volume=this.config.volume}
if(volume>max){volume=max}
if(volume<min){volume=min}
this.config.volume=volume;this.media.volume=volume;if(!is$1.empty(value)&&this.muted&&volume>0){this.muted=!1}},get:function get(){return Number(this.media.volume)}},{key:"muted",set:function set(mute){var toggle=mute;if(!is$1.boolean(toggle)){toggle=this.storage.get('muted')}
if(!is$1.boolean(toggle)){toggle=this.config.muted}
this.config.muted=toggle;this.media.muted=toggle},get:function get(){return Boolean(this.media.muted)}},{key:"hasAudio",get:function get(){if(!this.isHTML5){return!0}
if(this.isAudio){return!0}
return Boolean(this.media.mozHasAudio)||Boolean(this.media.webkitAudioDecodedByteCount)||Boolean(this.media.audioTracks&&this.media.audioTracks.length)}},{key:"speed",set:function set(input){var speed=null;if(is$1.number(input)){speed=input}
if(!is$1.number(speed)){speed=this.storage.get('speed')}
if(!is$1.number(speed)){speed=this.config.speed.selected}
if(speed<0.1){speed=0.1}
if(speed>2.0){speed=2.0}
if(!this.config.speed.options.includes(speed)){this.debug.warn("Unsupported speed (".concat(speed,")"));return}
this.config.speed.selected=speed;this.media.playbackRate=speed},get:function get(){return Number(this.media.playbackRate)}},{key:"quality",set:function set(input){var config=this.config.quality;var options=this.options.quality;if(!options.length){return}
var quality=[!is$1.empty(input)&&Number(input),this.storage.get('quality'),config.selected,config.default].find(is$1.number);var updateStorage=!0;if(!options.includes(quality)){var value=closest(options,quality);this.debug.warn("Unsupported quality option: ".concat(quality,", using ").concat(value," instead"));quality=value;updateStorage=!1}
config.selected=quality;this.media.quality=quality;if(updateStorage){this.storage.set({quality:quality})}},get:function get(){return this.media.quality}},{key:"loop",set:function set(input){var toggle=is$1.boolean(input)?input:this.config.loop.active;this.config.loop.active=toggle;this.media.loop=toggle},get:function get(){return Boolean(this.media.loop)}},{key:"source",set:function set(input){source.change.call(this,input)},get:function get(){return this.media.currentSrc}},{key:"poster",set:function set(input){if(!this.isVideo){this.debug.warn('Poster can only be set for video');return}
ui.setPoster.call(this,input,!1).catch(function(){})},get:function get(){if(!this.isVideo){return null}
return this.media.getAttribute('poster')}},{key:"autoplay",set:function set(input){var toggle=is$1.boolean(input)?input:this.config.autoplay;this.config.autoplay=toggle},get:function get(){return Boolean(this.config.autoplay)}},{key:"currentTrack",set:function set(input){captions.set.call(this,input,!1)},get:function get(){var _this$captions=this.captions,toggled=_this$captions.toggled,currentTrack=_this$captions.currentTrack;return toggled?currentTrack:-1}},{key:"language",set:function set(input){captions.setLanguage.call(this,input,!1)},get:function get(){return(captions.getCurrentTrack.call(this)||{}).language}}],[{key:"supported",value:function supported(type,provider,inline){return support.check(type,provider,inline)}},{key:"loadSprite",value:function loadSprite$1(url,id){return loadSprite(url,id)}},{key:"setup",value:function setup(selector){var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};var targets=null;if(is$1.string(selector)){targets=Array.from(document.querySelectorAll(selector))}else if(is$1.nodeList(selector)){targets=Array.from(selector)}else if(is$1.array(selector)){targets=selector.filter(is$1.element)}
if(is$1.empty(targets)){return null}
return targets.map(function(t){return new Plyr(t,options)})}}]);return Plyr}();Plyr.defaults=cloneDeep(defaults$1);(function(){var host=window.location.host;var env={prod:host==='xxzxczxc.net',dev:host==='dev.anihay.net'};document.addEventListener('DOMContentLoaded',function(){singleton.context(function(){var selector='#player';var container=document.getElementById('container');if(window.Shr){window.Shr.setup('.js-shr-button',{count:{classname:'button__count'}})}
document.addEventListener('keydown',function(event){if(event.keyCode!==9){return}});var player=new Plyr(selector,{debug:!0,title:'',iconUrl:'https://anihay.net/temp/img/demo.svg',keyboard:{global:!0},tooltips:{controls:!0},captions:{active:!0},keys:{google:'AIzaSyDrNwtN3nLH_8rjCmu5Wq3ZCm4MNAVdc0c'},ads:{enabled:env.prod||env.dev,publisherId:'918848828995742'},});window.player=player;var buttons=document.querySelectorAll('[data-source]');var types={video:'video',audio:'audio',youtube:'youtube',vimeo:'vimeo'};var currentType=window.location.hash.replace('#','');var historySupport=window.history&&window.history.pushState})})})()}())
